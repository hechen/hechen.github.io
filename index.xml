<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>I make stuff</title>
    <link>https://hechen.xyz/</link>
    <description>Recent content on I make stuff</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Sun, 20 Aug 2017 21:38:52 +0800</lastBuildDate>
    
        <atom:link href="https://hechen.xyz/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>About</title>
      <link>https://hechen.xyz/about/</link>
      <pubDate>Sun, 20 Aug 2017 21:38:52 +0800</pubDate>
      
      <guid>https://hechen.xyz/about/</guid>
      
        <description>&lt;p&gt;Hugo is a static site engine written in Go.&lt;/p&gt;

&lt;p&gt;It makes use of a variety of open source projects including:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/spf13/cobra&#34;&gt;Cobra&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/spf13/viper&#34;&gt;Viper&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/spf13/jWalterWeatherman&#34;&gt;J Walter Weatherman&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/spf13/cast&#34;&gt;Cast&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Learn more and contribute on &lt;a href=&#34;https://github.com/gohugoio&#34;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>å…³äºä¸€æ¬¡ SS æµé‡ä¸¢å¤±çš„è¿‡ç¨‹è®°å½•</title>
      <link>https://hechen.xyz/post/%E5%85%B3%E4%BA%8E%E4%B8%80%E6%AC%A1-ss-%E6%B5%81%E9%87%8F%E4%B8%A2%E5%A4%B1%E7%9A%84%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/</link>
      <pubDate>Mon, 28 Jan 2019 17:51:35 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/%E5%85%B3%E4%BA%8E%E4%B8%80%E6%AC%A1-ss-%E6%B5%81%E9%87%8F%E4%B8%A2%E5%A4%B1%E7%9A%84%E8%BF%87%E7%A8%8B%E8%AE%B0%E5%BD%95/</guid>
      
        <description>

&lt;h3 id=&#34;2019-01-29-æ›´æ–°&#34;&gt;2019-01-29 æ›´æ–°&lt;/h3&gt;

&lt;p&gt;æ—©ä¸Šä¸€åˆ°åŠå…¬å®¤è¿æ¥ä¸Šå…¬å¸ç½‘ç»œï¼Œç½‘é€Ÿç›´æ¥å°±é£šåˆ°äº† 600KB/sï¼Œç”šè‡³ä¸€åº¦æœ‰è¿‡ M çš„è¶‹åŠ¿ï¼Œæœä¸å…¶ç„¶ï¼Œè¿˜æ˜¯ com.apple.Safari.SafeBrowsing.Service è¿™ä¸ªæœåŠ¡è¿›ç¨‹ã€‚è¿™å°±å°´å°¬äº†ï¼Œçœ‹æ¥å¹¶ä¸æ˜¯è¯´ä½ ä¸ç”¨ Safari å°±ä¸ä¼šè§¦å‘ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/yifgIEZ.png&#34; alt=&#34;Surge Dashboard&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç›´æ¥æŠŠ Surge è§„åˆ™ä¸­çš„ Rule ç”± Direct æ”¹æˆäº† Rejectã€‚&lt;/p&gt;

&lt;h1 id=&#34;é—®é¢˜è¿½è¸ª&#34;&gt;é—®é¢˜è¿½è¸ª&lt;/h1&gt;

&lt;p&gt;åœ¨ 2018 å¹´ 12 æœˆåº•çš„æ—¶å€™ï¼Œä¸€å¤§æ—©æ‰“å¼€ç”µè„‘æŸ¥è¯¢åˆšä¹°çš„ SS æœåŠ¡ã€‚&lt;/p&gt;

&lt;p&gt;åˆšåˆšåœ¨å‰å‡ å¤©è´­ä¹°çš„ SS æµé‡ï¼Œæ¯ä¸ªæœˆ 150GB çš„é™é¢åœ¨çŸ­çŸ­çš„ 4 å¤©ä¹‹å†…å°±è€—äº†å°†è¿‘ 95GBï¼Œå°±åœ¨ 1 æœˆ 1 æ—¥å…ƒæ—¦å½“å¤©å°±è€—äº†æ¥è¿‘ 75GBï¼Œè¦çŸ¥é“ï¼Œæˆ‘å¹¶ä¸åªæœ‰ AgentNEO ä¸€å®¶çš„æµé‡æœåŠ¡ï¼Œç›¸å¯¹æ¥è¯´åœ¨ ping test ä¸Šå…¶è¿˜ä¸å¦‚ Shadowsocks å®¶çš„å¥½ï¼Œæ‰€ä»¥ç†è®ºä¸Šè§„åˆ™å‘½ä¸­ä¹Ÿåº”è¯¥æ˜¯åè€…çš„ï¼Œè€Œä¸”å°±ç®—æˆ‘ç”¨ A æœåŠ¡çœ‹å°ç”µå½±ä¹Ÿä¸è‡³äºè¿™ä¹ˆå¤šæµé‡æ¶ˆè€—ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/9tRs9vh.png&#34; alt=&#34;AgentNEO æµé‡é¢æ¿&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æœ€åˆçœ‹åˆ°è¿™ä¸ªç»Ÿè®¡æ•°æ®ä¹‹åï¼Œæˆ‘ä¸€åº¦æ€€ç–‘æ˜¯ä»–ä»¬ç½‘ç«™çš„æµé‡ç»Ÿè®¡æœ‰é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;åç»­å‡ å¤©ï¼Œæˆ‘å®é™…ä¸Šå¯¹æµé‡è€—æŸæ¯”è¾ƒå…³æ³¨ï¼Œæœ‰ä¸€å¤©æ³¨æ„åˆ°ï¼ŒSurge çš„æµé‡ç›‘æ§é€Ÿç‡ä¸€ç›´æŒç»­ä¸æ–­çš„æ˜¾ç¤ºè¾¾äº”å…­ç™¾ KB/s çš„ä¸‹è½½æµé‡ï¼Œä½†æ˜¯æˆ‘çŸ¥é“è‡ªå·±å½“æ—¶å¹¶æ²¡æœ‰ä¸‹è½½ä»»ä½•ä¸œè¥¿ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/nWz8JAt.png&#34; alt=&#34;Surge Menu Bar&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰“å¼€ Surge Dashboardï¼Œçœ‹åˆ°å¦‚ä¸‹çš„æƒ…å½¢ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/9kVX27V.png&#34; alt=&#34;Surge Dashboard&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°å½“æ—¶åœ¨æŒç»­ä¸æ–­çš„è¿›è¡Œä¸‹è½½åŠ¨ä½œçš„è¿›ç¨‹åç§°æ˜¯ &lt;code&gt;com.apple.Safari.SafeBrowsing.Service&lt;/code&gt;ï¼Œçœ‹è¯·æ±‚åœ°å€æ˜¯ safebrowsing.googleapis.comã€‚&lt;/p&gt;

&lt;p&gt;ä»è¿›ç¨‹åå­—æ¥çœ‹åº”è¯¥æ˜¯ Safari å’Œå®‰å…¨æµé‡ç›¸å…³çš„æœåŠ¡ï¼Œé€šè¿‡ Snitch çš„æ•°æ®åº“æŸ¥åˆ°å¯¹å…¶çš„è¯´æ˜ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Safari has built-in support for Googleâ€™s Safe Browsing service to identify fraudulent and unsafe websites. Right before Safari navigates to a certain website, the website gets checked for possible security concerns using Googleâ€™s Safe Browsing online database. Accessing the online database requires connections to Google servers.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¯´çš„å¤§æ¦‚æ˜¯è¯¥æœåŠ¡æ˜¯é’ˆå¯¹ Safari æµè§ˆå™¨å¯ç”¨çš„ï¼Œåœ¨ Safari è¦å¸®ä½ å¯¼èˆªåˆ°ä¸‹ä¸€çº§é¡µé¢çš„æ—¶å€™ï¼Œä¼šè¯†åˆ«è¯¥é¡µé¢æ˜¯å¦æ˜¯æ¬ºè¯ˆğŸ¶æˆ–è€…ä¸å®‰å…¨âš ï¸çš„ç½‘ç«™ï¼Œæˆ‘ä»¬åœ¨ Safari çš„ Security èœå•ä¸­å¯ä»¥æ‰¾åˆ°å¯ç”¨å…³äºæ¬ºè¯ˆç½‘ç«™çš„æ£€æµ‹åŠŸèƒ½çš„å¼€å…³ã€‚ä»¥æˆ‘æœ¬æœºä¸Šçœ‹åˆ°çš„å†…å®¹å¦‚ä¸‹&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Safari uses Tencent Safe Browsing and Google Safe Browsing to identify fraudulent websites.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å¤§æ¦‚æ„æ€å°±æ˜¯ Safari ä½¿ç”¨è…¾è®¯çš„å®‰å…¨æµè§ˆæœåŠ¡å’Œ Google çš„å®‰å…¨æµè§ˆæœåŠ¡æ¥é‰´åˆ«æ¬ºè¯ˆç½‘ç«™ï¼Œè…¾è®¯åº”è¯¥æ˜¯æœ¬åœ°åŒ–çš„äº§ç‰©ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/wEhv8iu.png&#34; alt=&#34;Little Snitch Network Monitor&#34; /&gt;&lt;/p&gt;

&lt;p&gt;é€šè¿‡é’ˆå¯¹è¯¥è¿›ç¨‹çš„å‡ºå£è¯·æ±‚ host ä¹Ÿå¯ä»¥éªŒè¯è¿™ä¸€ç‚¹ï¼Œè¯¥è¿›ç¨‹å‘èµ·çš„ç½‘ç»œè¯·æ±‚ä¼šæœ‰å¦‚ä¸‹ä¸¤ä¸ª host å‡ºå£ï¼š
1. safebrowsing.googleapis.com
2. safebrowsing.urlsec.qq.com&lt;/p&gt;

&lt;p&gt;å…¶å®åœ¨ iOS è®¾å¤‡ä¸Šä¹Ÿæœ‰åŒæ ·çš„è¿›ç¨‹æ¥åšè¿™ä»¶äº‹æƒ…ï¼ŒæŠ“åŒ…æœ‰æ—¶å€™ä¹Ÿèƒ½æ•æ‰åˆ°è¿™ä¸¤ä¸ªè¯·æ±‚ï¼ˆå›½è¡Œï¼‰ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/g9JCPdU.jpg&#34; alt=&#34;iPhone ä¸Šçš„ Safebrowsing&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è€Œè¿™æ¬¡å‡ºé—®é¢˜çš„å°±æ˜¯ google æä¾›çš„æ¬ºè¯ˆç½‘ç«™ç‰¹å¾åº“ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/BtfvMIV.png&#34; alt=&#34;Little Snitch Network Monitor&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å°è¯•å…³é—­ Surge ä½œä¸ºç³»ç»Ÿæµé‡ä»£ç†ä¹‹åï¼Œçœ‹åˆ° Activity Monitor ä¸­è¿›ç¨‹åˆå¼€å§‹äº†ä¸‹è½½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåªæ˜¯è¿æ¥è¯·æ±‚ä¸»ä½“ä»åŸæ¥ Surge åˆ‡æ¢åˆ°äº†ç‹¬ç«‹è¿›ç¨‹è€Œå·²ï¼ˆSurge ä¼šæ¥ç®¡ç½‘ç»œæµé‡ï¼Œå› æ­¤ä¹‹å‰è¯¥ä»»åŠ¡çš„ä¸‹è½½ä¼šç®—åˆ° Surge çš„å¤´ä¸Šï¼‰ï¼Œä½†æ˜¯é’ˆå¯¹è¯¥ host çš„ä¸‹è½½ä»»åŠ¡ä¸€è‡´æŒç»­ä¸æ–­ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;è¯´èµ·æ¥ï¼ŒLittle Snitch Network Monitor è¿™æ¬¾è½¯ä»¶ä¹Ÿæ˜¯å½“æ—¶ä¸ºäº†æŸ¥æµé‡ä¸¢å¤±é—®é¢˜ï¼Œæ‰ä¹°çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/SUT5qQC.png&#34; alt=&#34;Little Snitch Network Monitor&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è€Œåœ¨æˆ‘å…³é—­ Surge ä½œä¸ºä»£ç†ä¹‹å‰ï¼Œå¯ä»¥çœ‹åˆ°è¯¥è¿›ç¨‹å¤§æ¦‚åœ¨ 7 ä¸ªå°æ—¶ä¹‹å†…è€—äº† 12.4 GB çš„æµé‡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Gnxc4bB.png&#34; alt=&#34;Little Snitch Network Monitor&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è€Œåœ¨ç½‘ç»œä¸Šç›®å‰æœªçœ‹åˆ°é’ˆå¯¹ safebrowsing è¿›ç¨‹çš„å¤§é‡è®¨è®ºï¼Œå›½å†…è®ºå› &lt;a href=&#34;https://www.v2ex.com/t/404025&#34;&gt;V2EX&lt;/a&gt; é‡Œä¹Ÿçœ‹åˆ°æœ‰äººé‡åˆ°è¯¥é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;ç›®å‰æš‚æ—¶ä¸æ¸…æ¥šæ˜¯å®˜æ–¹ Bug è¿˜æ˜¯æˆ‘ç”µè„‘å®‰è£…äº†ä»€ä¹ˆæ’ä»¶æˆ–è€…è½¯ä»¶å¯¼è‡´ã€‚æš‚æ—¶å…ˆåœæ‰ä½¿ç”¨ Safari äº†ï¼Œç”¨ Chrome ç”¨ä¸Šä¸€æ®µæ—¶é—´ä¹‹åå†ç”¨ Snitch çœ‹ä¸‹æƒ…å†µå§ã€‚&lt;/p&gt;

&lt;p&gt;å¦ä¸€æ–¹é¢ï¼Œå› ä¸ºä¸æ”¾å¿ƒï¼Œåœ¨ Surge çš„è‡ªå®šä¹‰è§„åˆ™ä¸­åŠ äº†ä¸€æ¡ï¼š
    NAME,com.apple.Safari.SafeBrowsing.Service,DIRECT&lt;/p&gt;

&lt;p&gt;é’ˆå¯¹è¯¥è¿›ç¨‹çš„æ‰€æœ‰æµé‡éƒ½ç›´è¿ï¼Œä¸ç”¨ä»£ç†äº†ã€‚ åç»­æœ‰ä»»ä½•è¿›å±•ä¼šæ›´æ–°åˆ° Blog ä¸­ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>åœ¨ Swift Framework ä¸­ä½¿ç”¨ C æ–‡ä»¶çš„è¿‡ç¨‹æ¢ç´¢</title>
      <link>https://hechen.xyz/post/swift-and-modules/</link>
      <pubDate>Thu, 03 Jan 2019 21:19:24 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/swift-and-modules/</guid>
      
        <description>

&lt;h2 id=&#34;é—®é¢˜æè¿°&#34;&gt;é—®é¢˜æè¿°&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬åœ¨å¼€å‘çº¿ä¸Šè¯Šæ–­å·¥å…·éœ€æ±‚çš„æ—¶å€™ï¼Œæ˜¯ä»¥å•ä¸ª Pod çš„å½¢å¼æä¾›æ”¯æŒï¼Œå¹¶ä¸”ä»£ç æ–‡ä»¶ä¸­åªæœ‰çº¯ Swift æ–‡ä»¶ï¼Œä½†æ˜¯å…¶ä¸­éœ€è¦ç”¨åˆ°ç³»ç»Ÿçš„ C åº“çš„ä¸€äº›åŠŸèƒ½ï¼Œæœ¬æ¬¡å°±æ˜¯ä½¿ç”¨äº†ç³»ç»Ÿ C åº“ä¸­ &lt;code&gt;resolv.h&lt;/code&gt; è¿™ä¸ªæ–‡ä»¶æ¥è¿›è¡Œ DNS è§£ææ‰€ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;å½“åæœŸ Pod åŠŸèƒ½å®Œå–„ä¹‹åï¼Œåœ¨ Example å·¥ç¨‹ä¸­ä¹Ÿå·²ç»ç¼–è¯‘é€šè¿‡ä¹‹åï¼Œæ¥å…¥ä¸»é¡¹ç›®ä¸­ä¹‹åé‡åˆ°äº†ä¸‹é¢è¿™ä¸ªç¼–è¯‘é”™è¯¯ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ADh0sy6.png&#34; alt=&#34;Error When Compile&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å…·ä½“æ–‡å­—é”™è¯¯ä¿¡æ¯å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-txt&#34;&gt;/Users/chen/Repos/Work/ZHDiagnosisTool/ZHDiagnosisTool/Classes/Core/Network/ZHDiagnosisTool-Network-Header.h:8:10: 
    Include of non-modular header inside framework module &#39;Diagnosis.ZHDiagnosisTool_Network_Header&#39;: &#39;/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS12.1.sdk/usr/include/resolv.h&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¤§æ¦‚çš„æ„æ€å°±æ˜¯åœ¨ Umbrella Header ä¸­åŠ å…¥çš„ Bridging header æŒ‡å®šäº† include ä¸€ä¸ª C æ–‡ä»¶ï¼Œè€Œè¯¥ C æ–‡ä»¶æœ¬èº«å¹¶ä¸æ˜¯  Modular Headerï¼Œ å› æ­¤ç¼–è¯‘æ— æ³•é€šè¿‡ã€‚è¿™å°±æ¶‰åŠäº†ç›®å‰ iOS ç”Ÿæ€ä¸­æ™®éä½¿ç”¨çš„ Modules æ¦‚å¿µã€‚&lt;/p&gt;

&lt;h2 id=&#34;å‡ ä¸ªæ¦‚å¿µ&#34;&gt;å‡ ä¸ªæ¦‚å¿µ&lt;/h2&gt;

&lt;h3 id=&#34;modules&#34;&gt;Modules&lt;/h3&gt;

&lt;p&gt;Modules çš„æ¦‚å¿µæ˜¯ XCode 5 å¸¦åˆ° iOS å¼€å‘è€…é¢å‰çš„ï¼Œä»é‚£æ—¶èµ· LLVM ç¼–è¯‘å™¨å°±å·²ç»å†…åœ¨æ”¯æŒäº†ï¼Œå…·ä½“å…³äºå…¶å†å²åœ¨ &lt;a href=&#34;https://onevcat.com/2013/06/new-in-xcode5-and-objc/&#34;&gt;WWDC 2013 Sessionç¬”è®° - Xcode5å’ŒObjCæ–°ç‰¹æ€§&lt;/a&gt; è¿™ç¯‡æ–‡ç« ä¸­å·²ç»è®²è§£çš„éå¸¸è¯¦ç»†äº†ï¼Œä¸å†èµ˜è¿°ï¼Œæ€»ç»“ä¸€å¥è¯å°±æ˜¯ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Modules æ˜¯è¢«å¼•å…¥ LLVM å±‚é¢çš„ï¼Œç”¨ä»¥è§£å†³ä¹‹å‰ C/C++ ç³»ä¸­ #include å’Œ #import å¸¦æ¥çš„å¼•ç”¨æ³›æ»¥ä»¥åŠç¼–è¯‘æ—¶é—´è¿‡é•¿çš„é—®é¢˜çš„ä¸€ç§æ‰‹æ®µã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å°¤å…¶æ˜¯åœ¨ Swift å¼•å…¥ä¹‹åï¼ŒModule çš„æ¦‚å¿µåº”è¯¥å·²ç»æ·±å…¥äººå¿ƒã€‚å¤§å®¶å¯èƒ½å·²ç»ä¹ æƒ¯ç›´æ¥ä½¿ç”¨ @import æ¥å¼•ç”¨æŸä¸ª Moduleï¼Œæˆ–è€…å…¶ä¸­æŸä¸ªåŠŸèƒ½å•å…ƒã€‚å°¤å…¶æ˜¯ä½¿ç”¨ CocoaPods é›†æˆå¼€å‘çš„æ—¶å€™ï¼Œå…¶å†…éƒ¨å®é™…ä¸Šä¹Ÿæ˜¯åšäº†ä¸€äº› module çš„å·¥ä½œï¼Œåœ¨ Pods ç›®å½•ä¸­å……æ–¥ç€ &lt;code&gt;.modulemap&lt;/code&gt; çš„èº«å½±ï¼Œæƒ³å¿…å¤§å®¶ç»å¸¸çœ‹åˆ°ã€‚&lt;/p&gt;

&lt;p&gt;è€Œ ä¸€ä¸ª module çš„å±æ€§æ˜¯ç”±å®šä¹‰å®ƒçš„ &lt;code&gt;.modulemap&lt;/code&gt; æ–‡ä»¶æ¥å†³å®šçš„ï¼Œå…¶ç®€å•è¯­æ³•å¤§æ¦‚å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Shell&#34;&gt;module module_name [system] {
    header &amp;quot;header.h&amp;quot;
    link &amp;quot;linked_library&amp;quot;
    export *
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœå¯¹å…¶ä¸­ &lt;a href=&#34;https://clang.llvm.org/docs/Modules.html#module-map-language&#34;&gt;Modules çš„è¯­æ³•&lt;/a&gt;æ„Ÿå…´è¶£ï¼Œå¯ä»¥åˆ° Clang çš„å®˜æ–¹æ–‡æ¡£ä¸‹é€šè¯»ä¸‹ï¼Œä½ è‚¯å®šä¼šå¯¹ Modules è¿™ä¸€å¥—æœ‰æ›´æ¸…æ¥šçš„è®¤è¯†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;umbrella-header&#34;&gt;Umbrella Header&lt;/h3&gt;

&lt;p&gt;è¯´èµ·æ¥ï¼ŒUmbrella Header æ˜¯åœ¨ Framework çš„æ¦‚å¿µè¢«å¼•å…¥çš„ï¼Œä½ å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ¨¡å—å‡å­˜åœ¨ä¸€ä¸ª Umbrella Header ç”¨æ¥å°†é‚£äº›ä½ æƒ³æš´éœ²ç»™æ¨¡å—å¤–ç•Œè°ƒç”¨çš„å¤´æ–‡ä»¶åŒ…è£¹åœ¨ä¸€èµ·ã€‚é¿å…ä½¿ç”¨è€…åœ¨ä½¿ç”¨è¯¥æ¨¡å—çš„æ—¶å€™éœ€è¦æ‰‹åŠ¨è¾“å…¥å¤šä¸ª Header çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚ å…¶å® Mac ç«¯å¾ˆæ—©å°±æœ‰è¿™ä¸ªæ¦‚å¿µï¼ŒiOS ä¸­ç‰¹æŒ‡ iOS 8 å¼€å§‹å®˜æ–¹åŠ å…¥ Dynamic Framework ä»¥åçš„æ¦‚å¿µã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹æ‰€ç¤ºï¼Œæ²¡æœ‰ Umbrella Header çš„æƒ…å†µä¸‹ä½ éœ€è¦å°†æ‰€æœ‰éœ€è¦å¼•å…¥çš„å¤´æ–‡ä»¶ä¾æ¬¡å†™å‡ºã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-objc&#34;&gt;#import &amp;lt;XYZModule/XYZCustomCell.h&amp;gt;
#import &amp;lt;XYZModule/XYZCustomView.h&amp;gt;
#import &amp;lt;XYZModule/XYZCustomViewController.h&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨ä½¿ç”¨äº† Umbrella Header ä¹‹åï¼Œä½ åªéœ€è¦ä¸‹é¢ä¸€è¡Œå³å¯ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-objc&#34;&gt;#import &amp;lt;XYZModule/XYZModule.h&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“ç„¶ï¼Œè¿˜å­˜åœ¨ umbrella frameworkï¼Œæ„Ÿå…´è¶£å¤§å®¶å¯ä»¥åˆ°&lt;a href=&#34;https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Concepts/FrameworkAnatomy.html#//apple_ref/doc/uid/20002253-97623-BAJJHAJC&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ä¸‹è§‚çœ‹ã€‚&lt;/p&gt;

&lt;h3 id=&#34;bridging-header&#34;&gt;Bridging-Header&lt;/h3&gt;

&lt;p&gt;æ¡¥æ¥æ–‡ä»¶æ˜¯åœ¨ Swift æ¨å‡ºä¹‹åï¼ŒApple å¼•å…¥iOS ç”Ÿæ€çš„ç”¨ä»¥æ¡¥æ¥ Swift å’Œ Objective-C ç›¸äº’è°ƒç”¨çš„ä¸€ç§æ–¹å¼ ï¼ˆMix and Matchï¼‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œå¦‚æœåœ¨ Swift ä¸­æƒ³ä½¿ç”¨ Objective-C ç±»å®šä¹‰çš„å†…å®¹ï¼Œå°±éœ€è¦å»ºç«‹ Bridging Headerï¼Œç„¶ååœ¨å…¶ä¸­å®šä¹‰ä½ æƒ³è¦æš´éœ²çš„ OC å¤´æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/YwqHEKJ.png&#34; alt=&#34;Bridging Header&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å…·ä½“çš„æ“ä½œåœ¨&lt;a href=&#34;https://developer.apple.com/documentation/swift/imported_c_and_objective-c_apis/importing_objective-c_into_swift&#34;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;æœ‰é’ˆå¯¹åœ¨åŒä¸€ä¸ª App Target å’Œåœ¨åŒä¸€ä¸ª Framework å†…ä¸¤ç§æƒ…å†µå‡æœ‰è¯´æ˜ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;åœ¨æ¢³ç†è¿™äº›æ¦‚å¿µçš„è¿‡ç¨‹ä¸­ï¼Œå‘ç°è‡ªå·±ä¹‹å‰å¯¹æ¡¥æ¥æ–‡ä»¶æœ‰ä¸ªè¯¯åŒºï¼Œå¦‚æœä½ åœ¨ App çš„ä¸» Target ä¸­éœ€è¦è¿›è¡Œ OC å’Œ Swift çš„æ··ç¼–ï¼Œä½¿ç”¨ Bridging Header æ˜¯å¿…é€‰ï¼Œå¦‚æœä½ æ˜¯åœ¨åŒä¸€ä¸ª Framework ä¸­è¿›è¡Œçš„æ··ç¼–ï¼ŒBridging-Header æ˜¯å¹¶ä¸éœ€è¦çš„ï¼Œä½ éœ€è¦åšçš„åªæ˜¯åœ¨ Umbrella Header é‡ŒåŠ å…¥ä½ æƒ³æš´éœ²ç»™ Swift æ–‡ä»¶ä½¿ç”¨çš„ OC å¤´æ–‡ä»¶å³å¯ï¼Œä¹‹å‰è‡ªå·±ä¸€ç›´æ˜¯æ˜¾å¼çš„å»ºç«‹ä¸€ä¸ª Bridging-Headerï¼Œç„¶ååœ¨ Umbrella Header ä¸­å¼•å…¥è¯¥å¤´æ–‡ä»¶ï¼Œæƒ³æ¥è¿™ç§æ–¹å¼åªæ˜¯å°†ä½ æƒ³æš´éœ²åœ¨å¤–çš„å¤´æ–‡ä»¶è¿›è¡Œäº†äºŒæ¬¡åŒ…è£¹è€Œå·²ï¼Œå› ä¸º Cocoapods æ˜¯å°†æ‰€æœ‰ public header å‡åŠ å…¥åˆ° umbrella header é‡Œäº†ï¼Œå› æ­¤å•ä¸ª framework å†…éƒ¨å¼€å‘ï¼Œå³ä½¿æ²¡æœ‰ bridge header ä¹Ÿæ˜¯èƒ½å¤Ÿå°†ç¬¦å·æš´éœ²ç»™ Swift çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&#34;cocoapods&#34;&gt;Cocoapods&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬æ¯æ¬¡æ‰§è¡Œ &lt;code&gt;pod install&lt;/code&gt; çš„æ—¶å€™ï¼Œå¦‚æœä½ ä½¿ç”¨ &lt;code&gt;â€”verbose&lt;/code&gt; æ¥çœ‹è¯¦ç»†å®‰è£…è¿‡ç¨‹å°±èƒ½çœ‹åˆ°ï¼Œé’ˆå¯¹æ¯ä¸€ä¸ªå°†è¦è¢«å®‰è£…çš„ Pod å‡ä¼šæ‰§è¡Œç”Ÿæˆ module map å’Œ umbrella header è¿™ä¸¤ä¸ªé˜¶æ®µï¼Œå¦‚ä¸‹æ‰€ç¤ºéƒ¨åˆ† Install æŒ‡ä»¤çš„ä»£ç ï¼Œä»£ç ä½äº &lt;code&gt;lib/cocoapods/installer/xcode/pods_project_generator/aggregate_target_installer.rb&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;def install!
       UI.message &amp;quot;- Installing target `#{target.name}` #{target.platform}&amp;quot; do
       native_target = add_target
       create_support_files_dir
       create_support_files_group
       create_xcconfig_file(native_target)
       if target.host_requires_frameworks?
          create_info_plist_file(target.info_plist_path, native_target, target.version, target.platform)
    	    create_module_map(native_target)
          create_umbrella_header(native_target)
       elsif target.uses_swift?
          create_module_map(native_target)
    			create_umbrella_header(native_target)
       end
      
     # Some Code
     # Some Code
     # Some Code      
    end
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¾ˆæ˜ç¡®ï¼ŒCocoapods åœ¨ install æŸä¸ª Pod çš„æ—¶å€™ä¼šæ‰§è¡Œåˆ›å»º module map æ–‡ä»¶ä»¥åŠ umbrella header æ–‡ä»¶çš„å·¥ä½œã€‚è¯¦ç»†çš„ä»£ç å¤§å®¶å¯ä»¥ç›´æ¥åˆ° Cocoapods æºç ä¸‹  &lt;code&gt;lib/cocoapods/generator&lt;/code&gt; ç›®å½•ä¸‹çœ‹ï¼Œåˆ†åˆ«æ˜¯ &lt;code&gt;module_map.rb&lt;/code&gt; å’Œ &lt;code&gt;umbrella_header.rb&lt;/code&gt; æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;å…¶ä¸­åœ¨å„è‡ªæ–‡ä»¶çš„æ³¨é‡Šéƒ¨åˆ†ä¹Ÿæœ‰é’ˆå¯¹ç”Ÿæˆæ–‡ä»¶çš„è¯´æ˜ï¼Œæ¯”å¦‚ &lt;code&gt;module_map.rb&lt;/code&gt; ä¸­è¯´æ˜äº† module map çš„ä½œç”¨ï¼Œ&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Generates LLVM module map files. A module map file is generated for each Pod and for each Pod target definition that is built as a framework. It specifies a different umbrella header than usual to avoid name conflicts with existing headers of the podspec.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;åœ¨ &lt;code&gt;umbrella_header.rb&lt;/code&gt; ä¸­è¯´æ˜äº† umbrella header çš„ä½œç”¨ï¼Œ&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Generates an umbrella header file for clang modules, which are used by dynamic frameworks on iOS 8 and OSX 10.10 under the hood. If the target is a +PodTarget+, then the umbrella header is required to make all public headers in a convenient manner available without the need to write out header declarations for every library header.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&#34;é—®é¢˜åŸå› &#34;&gt;é—®é¢˜åŸå› &lt;/h2&gt;

&lt;p&gt;é¦–å…ˆè§£ç­”ï¼šä¸ºä»€ä¹ˆ Example å·¥ç¨‹èƒ½å¤Ÿç¼–è¯‘é€šè¿‡ è€Œç”¨äº†ä¸»å·¥ç¨‹æ˜¯æ— æ³•ç¼–è¯‘é€šè¿‡ï¼Ÿ&lt;/p&gt;

&lt;p&gt;å› ä¸ºç›®å‰ä¸»å·¥ç¨‹éƒ½è¦æ±‚æˆ‘ä»¬è‡ªè¡Œå¼€å‘çš„ pod ä»¥åŠ¨æ€ framework çš„å½¢å¼å‚ä¸ï¼Œä½†æ˜¯åœ¨ Example å·¥ç¨‹å¼€å‘çš„æ—¶å€™æˆ‘ä»¬çš„ &lt;code&gt;podfile&lt;/code&gt; å¹¶æœªæŒ‡å®š &lt;code&gt;use_frameworks!&lt;/code&gt; ç”¨ä»¥äº§å‡ºåŠ¨æ€ frameworkï¼Œå› æ­¤æœªæš´éœ²å‡ºè¯¥é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰ä»¥ framework çš„å½¢å¼çš„ module æ‰ä¼šæœ‰è¯¥é—®é¢˜ï¼Œå‡†ç¡®çš„è¯´ï¼Œåº”è¯¥æ˜¯ &lt;code&gt;Dynamic Framework&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;äº†è§£äº†ä»¥ä¸Šæ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬å†æ¥çœ‹æˆ‘ä»¬çš„é—®é¢˜ï¼Œé¦–å…ˆæˆ‘ä»¬çš„é—®é¢˜æ˜¯åœ¨ framework å†…éƒ¨è°ƒç”¨ç³»ç»Ÿ C åº“ä»£ç å‡ºç°çš„é—®é¢˜ï¼Œä» Xcode çš„æŠ¥é”™ï¼Œæˆ‘ä»¬çŸ¥é“æˆ‘ä»¬é€šè¿‡ bridging header å¼•å…¥çš„ C æ–‡ä»¶å¹¶ä¸ä»¥ module çš„å½¢å¼å­˜åœ¨ï¼Œå› æ­¤ç¼–è¯‘å™¨æŠ¥é”™ã€‚&lt;/p&gt;

&lt;h2 id=&#34;è§£å†³è¿‡ç¨‹&#34;&gt;è§£å†³è¿‡ç¨‹&lt;/h2&gt;

&lt;p&gt;å…¶å®å§ï¼Œå¤§å®¶éƒ½èƒ½æƒ³åˆ°ï¼Œä½¿ç”¨ Objective-C åšä¸ªå°è£…ï¼Œæˆ–è€…å¹²è„†ç›´æ¥è°ƒç”¨ C æ–‡ä»¶çš„ç±»ç”¨ OC é‡å†™ä¸å°±å®Œäº†ä¹ˆï¼Œå¯æ˜¯å¦‚æœä¸‹æ¬¡ä½ å†é‡åˆ°äº†å‘¢ï¼Ÿ æˆ–è€…è¦æ”¹é€ äº†ä¸€ä¸ªçº¯ Swift åº“å‘¢ï¼ŸçŸ¥å…¶æ‰€ä»¥ç„¶ï¼Œæ‰èƒ½é¿å…å†æ¬¡è½å‘å§ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;å› ä¸º Objective-C è‡ªèº«ç¼–è¯‘å™¨æ˜¯å¸®ä½ åšäº† modular åŒ–çš„ï¼Œå½“ç„¶ï¼Œå¦‚æœä½ é€‰æ‹©äº†å‰è€…ï¼Œè¿˜æœ‰ä¸ªé™åˆ¶ï¼Œä½ å¹¶ä¸èƒ½æŠŠä¸Šé¢ C çš„å¤´æ–‡ä»¶æ”¾åˆ°ä½ çš„ Objective-C çš„å¤´æ–‡ä»¶ä¸­ï¼Œå› ä¸ºæœ¬è´¨ä¸Šï¼Œæœ€åè¿™ä¸ªå¤´æ–‡ä»¶è¿˜æ˜¯è¦æš´éœ²ç»™ Umbrella Header çš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;é¦–å…ˆï¼Œèƒ½å¦å…è®¸ç¼–è¯‘å™¨æ”¯æŒåœ¨ module ä¸­å¼•å…¥é modular çš„å¤´æ–‡ä»¶å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;Xcode åœ¨ build setting ä¸­æä¾›äº†  &lt;code&gt;Allow Non-modular Includes In Framework Modules&lt;/code&gt; æ¥æ§åˆ¶æ˜¯å¦å…è®¸åœ¨å½“å‰ framework ä¸­æ”¯æŒé modular å¤´æ–‡ä»¶å¼•å…¥ï¼Œå…¶å¹¶ä¸é€‚ç”¨äºçº¯ Swift é¡¹ç›®ï¼Œè€Œä¸”å³ä½¿é€‚ç”¨ï¼Œå…¶ä¼šå¯¼è‡´æ‰€æœ‰ç”¨åˆ°è¯¥ framework çš„å¤§çš„ç¼–è¯‘å•å…ƒéƒ½ä¸èƒ½å†ä½¿ç”¨ module å½¢å¼å¼•å…¥å¤´æ–‡ä»¶äº†ï¼Œä¹Ÿå°±æ˜¯å¿…é¡»é€‚ç”¨å¹³å¦å¼çš„ &lt;code&gt;#include &amp;quot;&amp;quot;&lt;/code&gt; å½¢å¼ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/S4i2chx.png&#34; alt=&#34;Build Setting&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æœ€åï¼Œé€šè¿‡åªèƒ½ä»æ ¹æºä¸Šæ¥è§£å†³è¯¥é—®é¢˜äº†ï¼Œæ—¢ç„¶éœ€è¦å¼•å…¥çš„æ–‡ä»¶æ˜¯ modular headerï¼Œæˆ‘ä»¬å°±è¦æƒ³åŠæ³•æ¥å°†å…¶åŒ…è£¹ä¸º moduleã€‚ åœ¨æŸ¥æ‰¾è§£å†³æ–¹æ¡ˆçš„è¿‡ç¨‹ä¸­å‘ç°ï¼Œå°±åœ¨ Swift åˆšæ¨å‡ºçš„æ—¶å€™ï¼Œå¤§å®¶å·²ç»é‡åˆ°è¿™ä¸ªé—®é¢˜äº†ï¼Œé‡åˆ°æœ€å¤šçš„å°±æ˜¯&lt;code&gt;CommonCrypto&lt;/code&gt; ç»å¸¸è¢«ä½¿ç”¨åˆ°çš„ C åº“ï¼Œå¸¸è§çš„ MD5 è®¡ç®—å°±æ˜¯å…¶æä¾›çš„ APIï¼Œä½†æ˜¯åœ¨å‰å‡ å¹´å®˜æ–¹å¹¶æœªå°†è¯¥åŠ¨æ€åº“ module åŒ–ï¼Œå› æ­¤å¯¼è‡´ä½ æ— æ³•åœ¨ Swift æ–‡ä»¶ä¸­ç›´æ¥ä½¿ç”¨ç±»ä¼¼ &lt;code&gt;#import &amp;lt;CommonCrypto/CommonCrypto.h&amp;gt;&lt;/code&gt; è¿™ç§å†™æ³•ã€‚è‡ªç„¶è€Œè¨€å¤šäº†å¾ˆå¤šè§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹å‡ºè‡ª StackOverflow ä¸Š &lt;a href=&#34;https://stackoverflow.com/questions/25248598/importing-commoncrypto-in-a-swift-framework/37125785#37125785&#34;&gt;Importing CommonCrypto in a Swift framework&lt;/a&gt; çš„å¸–å­ä¸‹é¢å°±æä¾›äº†å¤šç§è§£å†³æ–¹æ¡ˆï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;è¿˜æ˜¯é‚£å¥è¯ï¼Œä½ æ˜¯å¯ä»¥é€šè¿‡ Objective-C åšæ¡¥æ¥æ¥è¾¾åˆ°åŒæ ·æ•ˆæœçš„ã€‚æ¯•ç«Ÿ Swift æœ¬èº«å°±æ˜¯ä¸€é—¨å¿ƒæ€æƒ³æŠ›å¼€ C çš„å†å²åŒ…è¢±ï¼Œå› æ­¤æƒ³æ‹¥æœ‰ä¸€ä¸ªçº¯çº¯çš„ Swift ä»£ç ä¸æ²¾æŸ“ä¸€ç‚¹ C æ–‡ä»¶æ°”æ¯ï¼Œä½ å°±è¦åšä¸€äº›å·¥ä½œã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å…¶ä¸­æ ¹æœ¬é—®é¢˜å°±æ˜¯ä¸º &lt;code&gt;CommonCrypto&lt;/code&gt; è¿™ä¸ª C ç¼–è¯‘å•å…ƒå®šä¹‰ moduleï¼Œä¸Šé¢ä¹Ÿæåˆ°äº† LLVM æ˜¯é€šè¿‡ &lt;code&gt;modulemap&lt;/code&gt; æ–‡ä»¶æ¥è¯†åˆ«çš„ï¼Œæ‰€ä»¥åªè¦é€šè¿‡ &lt;code&gt;.modulemap&lt;/code&gt; æ¥å®šä¹‰å³å¯ï¼Œ&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    module CommonCrypto [system] {
        header &amp;quot;/usr/include/CommonCrypto/CommonCrypto.h&amp;quot;
        export *
    }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å®šä¹‰çš„ modulemap è‡ªç„¶å¯ä»¥æ”¾åˆ°ä»»æ„ç›®å½•ï¼Œåªè¦è®©ç¼–è¯‘å•å…ƒåœ¨ç¼–è¯‘çš„æ—¶å€™èƒ½å¤Ÿæœç´¢çš„åˆ°å³å¯ï¼ŒXcode é€‰é¡¹çš„ Build Settings ä¸‹çš„ Swift Compiler - Search Paths ã€‚æ·»åŠ  .modulemap æ–‡ä»¶æ‰€åœ¨è·¯å¾„å³å¯ã€‚åœ¨ç¼–è¯‘çš„æ—¶å€™ LLVM è‡ªç„¶ä¼šæŸ¥æ‰¾åˆ° .modulemap æ–‡ä»¶è‡ªåŠ¨ç”Ÿæˆ Module ä¿¡æ¯ã€‚ä½ æ­¤æ—¶å°±å¯ä»¥åœ¨ä½¿ç”¨  CommonCrypto çš„åœ°æ–¹ä½¿ç”¨ modular header äº†ã€‚&lt;/p&gt;

&lt;p&gt;è¿‡äº†å‡ å¹´ä¹‹åï¼Œå®˜æ–¹æ‰å°†è¯¥åº“å®šä¹‰ä¸º moduleï¼Œåœ¨ Xcode è‡ªå¸¦çš„ iOS SDK ä¸­ &lt;code&gt;/usr/include/CommonCrypto&lt;/code&gt; ä¸‹å¯ä»¥çœ‹åˆ° &lt;code&gt;module.modulemap&lt;/code&gt; æ–‡ä»¶ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;module CommonCrypto [system] [extern_c] {
      umbrella header &amp;quot;CommonCrypto.h&amp;quot;
      export *
      module * { export * }
      
      module Error {
          header &amp;quot;CommonCryptoError.h&amp;quot;
          export *
      }
      
      module Random {
          header &amp;quot;CommonRandom.h&amp;quot;
          export *
      }
    }

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¤§å®¶ä¹Ÿæ³¨æ„åˆ°äº†åœ¨ CommonCrypto çš„åŒçº§ç›®å½•ä¸­å®é™…ä¸Šè¿˜æœ‰å¾ˆå¤šçš„ç³»ç»Ÿ C åº“ä»£ç ï¼Œå¹¶ä¸”ä¹Ÿæœ‰ä¸€ä¸ª module.modulemap æ–‡ä»¶ï¼Œæˆ‘è£å‰ªä¸€æ®µä»£ç å¤§å®¶çœ‹ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;module Compression [system] [extern_c] {
    header &amp;quot;compression.h&amp;quot;
    export *
    link &amp;quot;compression&amp;quot;
}
    
module Darwin [system] [extern_c] [no_undeclared_includes] {
    // Headers that are repeatedly included, and therefore should not be
    	// assigned to any given module.
    	exclude header &amp;quot;_structs.h&amp;quot;
    	exclude header &amp;quot;sys/_structs.h&amp;quot;
    
    	// C standard library
    	module C {
    		textual header &amp;quot;assert.h&amp;quot;
    
    	  module setjmp {
    			header &amp;quot;setjmp.h&amp;quot;
    			export *
    		}
    
    		module signal {
    			header &amp;quot;signal.h&amp;quot;
    			export *
    		}
    
    		module stdio {
    			header &amp;quot;stdio.h&amp;quot;
    			export *
    		}
    }
    
    module zlib [system] [extern_c] {
    	header &amp;quot;zlib.h&amp;quot;
    	export *
    	link &amp;quot;z&amp;quot;
    }
    
    module SQLite3 [system] [extern_c] {
    	header &amp;quot;sqlite3.h&amp;quot;
    	link &amp;quot;sqlite3&amp;quot;
    	explicit module Ext {
    		header &amp;quot;sqlite3ext.h&amp;quot;
    		export *
    	}
    	export *
    }

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨ Swift ä»£ç é‡Œå¯ä»¥ç›´æ¥ä½¿ç”¨ç±»ä¼¼ &lt;code&gt;import Darwin.C.stdio&lt;/code&gt; å†™æ³•çš„åŸå› ã€‚ä½†æ˜¯è¿˜æ˜¯å­˜åœ¨ä¸€äº› C åº“å¹¶æ²¡æœ‰è¢«å®šä¹‰ä¸º moduleï¼Œè€Œæœ¬æ¬¡ç”¨æ¥åš DNS è§£æçš„ &lt;code&gt;resolv.h&lt;/code&gt; å°±æ˜¯å…¶ä¸­ä¸€å‘˜ã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“åˆ°æˆ‘ä»¬è§£å†³æ€è·¯é‡Œæ¥çœ‹å°±æ˜¯è¦è§£å†³ modulemap å¦‚ä½•å®šä¹‰ï¼Œå¦‚ä½•å’Œæˆ‘ä»¬ç›®å‰ä½¿ç”¨çš„ cocoapods æ•´åˆçš„é—®é¢˜äº†ã€‚æ—¢ç„¶æ˜¯åœ¨ä½œä¸º pod è¿›è¡Œå¼€å‘ï¼Œè‡ªç„¶æ˜¯éœ€è¦å°† module map æ–‡ä»¶åŠ å…¥åˆ° pod çš„ä»£ç ç®¡ç†ä¸­å»ã€‚æ¯”å¦‚å°†å…¶æ”¾ç½®äºå•ä¸ª pod æ ¹ç›®å½•ä¸‹ï¼Œç„¶ååœ¨ podspec ä¸­é…ç½®å¥½è·¯å¾„ä»¥ä¾¿ç¼–è¯‘çš„æ—¶å€™ Swift Search Paths ä¸­æœ‰å®ƒã€‚è‡ªç„¶ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ resolv.modulemap å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;module Resolv [system] {
    header &amp;quot;/usr/include/resolv.h&amp;quot;
    export *
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶ååœ¨å¯¹åº”çš„ podspec æ–‡ä»¶ä¸­é…ç½® build setting ä¸­çš„å‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤º&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;s.subspec &#39;Core&#39; do |core|
    core.source_files   = [&#39;ZHDiagnosisTool/Classes/Core/**/*&#39;] 
    core.preserve_paths = &#39;ZHDiagnosisTool/Classes/Core/ModuleMap&#39;
    core.pod_target_xcconfig = {
        &#39;SWIFT_INCLUDE_PATHS[sdk=macosx*]&#39;           =&amp;gt; &#39;$(PODS_ROOT)/ZHDiagnosisTool/Classes/Core/ModuleMap&#39;,
        &#39;SWIFT_INCLUDE_PATHS[sdk=iphoneos*]&#39;         =&amp;gt; &#39;$(PODS_ROOT)/ZHDiagnosisTool/Classes/Core/ModuleMap&#39;,
        &#39;SWIFT_INCLUDE_PATHS[sdk=iphonesimulator*]&#39;  =&amp;gt; &#39;$(PODS_ROOT)/ZHDiagnosisTool/Classes/Core/ModuleMap&#39;,
      }
end

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯æ˜¯ï¼Œé—®é¢˜å‡ºåœ¨ PODS_ROOTS è¿™ä¸ªè·¯å¾„ä¸Šï¼Œå¦‚æœæˆ‘ä»¬è¿›è¡Œæœ¬åœ°å¼€å‘ï¼Œè¯¥è·¯å¾„å°±æ˜¯ Cocoapods æ‰§è¡Œå®Œæ¯•ä¹‹åç”Ÿæˆçš„ä¸´æ—¶ Pods ç›®å½•ï¼Œå¹¶ä¸æ˜¯åŸå§‹ podspec æ–‡ä»¶æ‰€åœ¨çš„åœ°æ–¹ï¼Œè€Œå®˜æ–¹ä¹Ÿè¡¨æ˜äº†ï¼Œä¸ä¼šå¯¹è¿™ç§ Local Pods ç‰¹å®šæä¾›ä¸€ä¸ªç¯å¢ƒå˜é‡æ¥è·å–ï¼Œ å¦‚ä¸‹é“¾æ¥å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/CocoaPods/CocoaPods/issues/809&#34;&gt;local pod development on a project that includes libraries Â· Issue #809 Â· CocoaPods/CocoaPods&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å¦‚å›¾ä¸­ï¼ŒæŒ‡å®š $(PODS_ROOT) è·¯å¾„å®é™…ä¸Šåœ¨å¼€å‘ Local Pod çš„æ—¶å€™å°±ä¼šæ‰¾ä¸åˆ°ï¼Œæ‰€ä»¥å°±éœ€è¦æŒ‰ç…§ä¸Šé¢é“¾æ¥ä¸­çš„æ–¹å¼è‡ªè¡Œæ‰‹åŠ¨æ‹¼æ¥è·¯å¾„ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°½å¯èƒ½ä¸ç”¨ PODS_ROOT è¿™ä¸ªè·¯å¾„ï¼Œéœ€è¦å¦å¤–æ‰¾ä¸€ä¸ªä¸ä¼šå› ä¸º Pod ä½ç½®è€Œå˜åŒ–çš„è·¯å¾„ã€‚&lt;/p&gt;

&lt;p&gt;æœ€ç»ˆå‚è€ƒäº†ä»¥ä¸‹ repo ä¸­å·¥ç¨‹çš„è§£å†³æ–¹æ¡ˆï¼Œ&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/onmyway133/Arcane&#34;&gt;onmyway133/Arcane&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­ä½œè€…ä½¿ç”¨ Pod çš„ script phase æ¥å®Œæˆ .modulemap çš„æ“ä½œï¼Œè¿™æ ·ä¼šæ›´åŠ çµæ´»ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ ·ï¼Œé’ˆå¯¹æˆ‘ä»¬è‡ªå·±æœ¬æ¬¡çš„éœ€æ±‚æ¥çœ‹ï¼Œ.podspec ä¸­çš„ script å¦‚ä¸‹æ‰€å†™å³å¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;# Create
FRAMEWORK_DIR=&amp;quot;${BUILT_PRODUCTS_DIR}/RESOLV.framework&amp;quot;
          
if [ -d &amp;quot;${FRAMEWORK_DIR}&amp;quot; ]; then
    echo &amp;quot;${FRAMEWORK_DIR} already exists, so skipping the rest of the script.&amp;quot;
    exit 0
fi
          
mkdir -p &amp;quot;${FRAMEWORK_DIR}/Modules&amp;quot;
          
echo &amp;quot;module RESOLV [system] {
    header \&amp;quot;${SDKROOT}/usr/include/resolv.h\&amp;quot;
    export *
}&amp;quot; &amp;gt; &amp;quot;${FRAMEWORK_DIR}/Modules/module.modulemap&amp;quot;
               
    
# Generate fake header...
[ -d &amp;quot;${FRAMEWORK_DIR}/Headers&amp;quot; ] || mkdir &amp;quot;${FRAMEWORK_DIR}/Headers&amp;quot;
touch &amp;quot;${FRAMEWORK_DIR}/Headers/resolv.h&amp;quot;
    
# Soft link C header to local framework Headers
ln -sf &amp;quot;${SDKROOT}/usr/include/resolv.h&amp;quot; &amp;quot;${FRAMEWORK_DIR}/Headers/resolv.h&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ¯æ¬¡åœ¨ç¼–è¯‘è¿è¡Œå‰ï¼Œæˆ‘ä»¬ä¼šè‡ªè¡Œåˆ›å»ºä¸€ä¸ª &lt;code&gt;Resolv.framework&lt;/code&gt;ï¼Œå…¶ä¸­ Header ç›®å½•ä¸­æˆ‘ä»¬æ”¾ä¸€ä¸ªç©ºç™½æ–‡ä»¶å¹¶ä¸”è½¯é“¾æ¥åˆ°çœŸæ­£æƒ³è¦é“¾æ¥çš„å¤´æ–‡ä»¶ä¸Šï¼Œç„¶ååœ¨è¯¥ framework ä¸­åˆ›å»º modulemap æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;ä¹‹åï¼Œæˆ‘ä»¬åœ¨ .podspec ä¸­æŒ‡å®š script phase ä¸ºç¼–è¯‘å‰å³å¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œ&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-ruby&#34;&gt;s.script_phase = {
    :name =&amp;gt; &#39;Resolv&#39;,
    :script =&amp;gt; script_above,
    :execution_position =&amp;gt; :before_compile
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·ï¼Œé€šè¿‡ &lt;code&gt;Resolv.framework&lt;/code&gt; çš„æ¡¥æ¥ï¼ŒSwift ä»£ç ä¸­å°±å¯ä»¥ç›´æ¥é€šè¿‡ &lt;code&gt;import RESOLV&lt;/code&gt; æ¥ä½¿ç”¨äº†ã€‚å½“ç„¶ï¼Œé“¾æ¥è¿™ä¸€ç¯ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹ä¸¤ç§å½¢å¼è¾¾åˆ°ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;ç›´æ¥åœ¨ podspec æ–‡ä»¶ä¸­æŒ‡å®šä¾èµ–ï¼Œå¦‚ &lt;code&gt;core.library = &amp;quot;resolv&amp;quot;&lt;/code&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;åœ¨ &lt;code&gt;.modulemap&lt;/code&gt; æ–‡ä»¶ä¸­æ˜¾å¼çš„ linkï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;module Resolv [system] {
header &amp;quot;/usr/include/resolv.h&amp;quot;
link &amp;quot;resolv&amp;quot;
export *
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è€Œä¸”é€šè¿‡å°† module map æ–‡ä»¶æ”¾ç½®äº product äº§å‡ºç›®å½•è¿™é‡Œä¹Ÿè§£å†³äº†è·¯å¾„æŒ‡å®šçš„é—®é¢˜ï¼Œå› ä¸º product folder æ˜¯é»˜è®¤åœ¨ç¼–è¯‘çš„æœç´¢è·¯å¾„ä¸‹çš„ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;æ€»ç»“æ¥çœ‹ï¼Œå°±æ˜¯æƒ³è¦åœ¨çº¯ Swift çš„é¡¹ç›®ä¸­å¼•å…¥ç³»ç»Ÿ C åº“æ–‡ä»¶ï¼ˆè¿™é‡ŒæŒ‡çš„æ˜¯æœªè¢« modular åŒ–çš„æ–‡ä»¶ï¼Œå› ä¸ºæœ‰äº› C æ–‡ä»¶å·²ç»è¢«ç³»ç»Ÿé»˜è®¤å°è£…æˆäº† module äº†ï¼‰ã€‚ä»¥ä¸Šåªæ˜¯ä¸€äº›ç®€å•çš„æ¦‚å¿µè®²è§£ï¼Œæ•´ä¸ªç¼–è¯‘ç³»ç»Ÿä»¥åŠå¥—ä»¶éƒ½æ˜¯é•¿æ—¶é—´ä¸æ–­æ¼”åŒ–çš„ç»“æœï¼Œè¿™é‡Œä¹Ÿåªæ˜¯ç®€å•çš„è®²è¿°ï¼Œæœ‰ä¸€äº›æ¦‚å¿µå®é™…ä¸Šä¹Ÿåªæ˜¯ç‚¹åˆ°ä¸ºæ­¢ï¼Œå¤§å®¶å¦‚æœæ„Ÿå…´è¶£å¯ä»¥å¤šæ‰¾ä¸€äº›ç›¸å…³èµ„æ–™é˜…è¯»ä¸‹ï¼Œäº²è‡ªè¯•ä¸€è¯•ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;http://llvm.org/devmtg/2012-11/Gregor-Modules.pdf&#34;&gt;Modules&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://zh.wikipedia.org/wiki/LLVM&#34;&gt;LLVM - ç»´åŸºç™¾ç§‘ï¼Œè‡ªç”±çš„ç™¾ç§‘å…¨ä¹¦&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://clang.llvm.org/docs/Modules.html#introduction&#34;&gt;Modules - Clang 8 documentation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://onevcat.com/2013/06/new-in-xcode5-and-objc/&#34;&gt;WWDC 2013 Sessionç¬”è®° - Xcode5å’ŒObjCæ–°ç‰¹æ€§&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://stackoverflow.com/questions/25248598/importing-commoncrypto-in-a-swift-framework/37125785#37125785&#34;&gt;Importing CommonCrypto in a Swift framework&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://forums.developer.apple.com/thread/46477&#34;&gt;Adding CommonCrypto to custom Swift framework |Apple Developer Forums&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://theswiftdev.com/2018/01/15/how-to-call-c-code-from-swift/&#34;&gt;How to call C code from Swift - The.Swift.Dev.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://medium.com/swift-and-ios-writing/using-a-c-library-inside-a-swift-framework-d041d7b701d9/&#34;&gt;Using a C library inside a Swift framework - Swift and iOS Writing - Medium&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
      
    </item>
    
    <item>
      <title>UserDefaults and Keychain</title>
      <link>https://hechen.xyz/post/userdefaults-and-keychain/</link>
      <pubDate>Fri, 21 Dec 2018 14:30:50 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/userdefaults-and-keychain/</guid>
      
        <description>

&lt;p&gt;Apple æä¾›äº†å‡ ç§æŒä¹…åŒ–æ–¹æ¡ˆï¼Œå…¶ä¸­ UserDefaults å’Œ Keychain æ˜¯ App å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„æ–¹æ¡ˆï¼Œè€Œä¸”ä»ä»¥å¾€å’ŒåŒäº‹çš„æ¢è®¨è¿‡ç¨‹ä¸­å‘ç°å¯¹è¿™ä¸¤ä¸ªæ¦‚å¿µä¸­æœ‰ä¸€äº›ç»†èŠ‚è¿˜æ˜¯ç†è§£ä¸å¤ªé€å½»ï¼Œå› æ­¤æœ¬æ–‡ä¼šé’ˆå¯¹è¿™äºŒè€…å±•å¼€è®²ä¸€è®²ã€‚&lt;/p&gt;

&lt;h2 id=&#34;userdefaults&#34;&gt;UserDefaults&lt;/h2&gt;

&lt;p&gt;é¦–å…ˆï¼Œé˜…è¯»å®Œ Apple å…³äº UserDefaults ä¸€èŠ‚çš„æ–‡æ¡£æè¿°ä¹‹åï¼Œæˆ‘è§‰å¾—æœ‰ä¸¤ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;UserDefaults çš„æ„æˆ&lt;/li&gt;
&lt;li&gt;UserDefaults çš„ç›®çš„&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;userdefaults-æ„æˆ&#34;&gt;UserDefaults æ„æˆ&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹çœ‹å…·ä½“ UserDefaults å­˜å‚¨çš„åœ°æ–¹ï¼Œå¦‚ä¸‹å›¾ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­å†™å…¥ Demo æ•°æ®ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/wq9onOa.png&#34; alt=&#34;Write Key-Value to UserDefaults&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰“å° Library è·¯å¾„ï¼Œåœ¨ Finder ä¸­æ‰“å¼€è·¯å¾„:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/65ybYX6.png&#34; alt=&#34;Library&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹å±•ç¤ºå†…å®¹ï¼Œå¯ä»¥çœ‹åˆ°åœ¨ Preferences ç›®å½•ä¸­å­˜åœ¨æŸä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚è¯¥ App Library ç›®å½•ä¸‹å­˜æ”¾çš„æ–‡ä»¶ä¸º &lt;code&gt;app.chen.ios.PersistenceDemo.plist&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ChqnDJa.png&#34; alt=&#34;Cache&#34; /&gt;
&lt;img src=&#34;https://i.imgur.com/cPvlFdR.png&#34; alt=&#34;Preferences&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¯¥ plist å†…å®¹å¦‚å›¾æ‰€ç¤ºï¼Œå³ä¸ºæˆ‘ä»¬ä¹‹å‰åœ¨ App ä¸­å†™å…¥çš„ Key-Valueã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/shdXoZN.png&#34; alt=&#34;plist&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥è¿™ä¹Ÿè¯æ˜äº†ï¼Œæˆ‘ä»¬é’ˆå¯¹ UserDefaults çš„è¯»å†™å®è´¨ä¸Šæ˜¯é’ˆå¯¹ plist æ–‡ä»¶çš„è¯»å†™ã€‚&lt;/p&gt;

&lt;p&gt;iOS ç³»ç»Ÿä¼šè‡ªåŠ¨å¸®ä½ åš &lt;code&gt;plist&lt;/code&gt; æ–‡ä»¶çš„è¯»å…¥ä»¥åŠ Cacheï¼Œæ ¹æ®æƒ…å†µä¼šæŠŠä½ åœ¨å†…å­˜ä¸­æ‰€åšçš„æ“ä½œåŒæ­¥åˆ° &lt;code&gt;plist&lt;/code&gt; æ–‡ä»¶ï¼ˆUserDefaults åŒæ­¥åˆ°å†…å­˜æ˜¯åŒæ­¥çš„ï¼ŒåŒæ­¥åˆ° Database æ˜¯å¼‚æ­¥çš„ï¼Œ iOS 8 å¼€å§‹ï¼Œä¼šæœ‰ä¸€ä¸ªå¸¸é©»è¿›ç¨‹ &lt;code&gt;cfprefsd&lt;/code&gt; æ¥è´Ÿè´£åŒæ­¥ï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ä½ ä¼šçœ‹æœ‰iOS é¢è¯•é¢˜ç›®ä¼šé—®é¢˜ï¼š ç³»ç»Ÿçš„ &lt;code&gt;UserDefaults&lt;/code&gt; çš„æœ¬è´¨ä»¥åŠå’Œ plist æ–‡ä»¶çš„ç›´æ¥è¯»å†™çš„åŒºåˆ«ï¼Ÿï¼ˆè¿™é¢˜ç›®å¤ª TM åäº†ã€‚ã€‚ã€‚ï¼‰&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;UserDefaults caches the information to avoid having to open the userâ€™s defaults database each time you need a default value. When you set a default value, itâ€™s changed synchronously within your process, and asynchronously to persistent storage and other processes.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œå®è´¨ä¸Šï¼Œä½ æ˜¯å¯ä»¥ç›´æ¥é’ˆå¯¹ UserDefaults çš„æœ€ç»ˆäº§ç‰© plist æ–‡ä»¶è¿›è¡Œæ“ä½œçš„ï¼Œå½“ç„¶ï¼Œè¿™æ˜¯æœ‰é£é™©çš„ï¼Œè€Œä¸”æ— æ³•ä¿éšœæ­£å¸¸ä½¿ç”¨çš„ã€‚å®˜æ–¹åœ¨æ–‡æ¡£ä¸­ä¹Ÿæé†’äº†å¼€å‘è€…ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Donâ€™t try to access the preferences subsystem directly. Modifying preference property list files may result in loss of changes, delay of reflecting changes, and app crashes. To configure preferences, use the defaults command-line utility in macOS instead.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;é‚£æ—¢ç„¶æœ¬è´¨ä¸Š UserDefaults æ˜¯ä½¿ç”¨ plist æ–‡ä»¶è¿›è¡Œå­˜å‚¨ï¼Œé‚£ä¹Ÿè¦æ±‚äº†æˆ‘ä»¬èƒ½å­˜å‚¨çš„ Value åªèƒ½æ”¯æŒ &lt;code&gt;plist&lt;/code&gt; æ‰€æ”¯æŒçš„æ ¼å¼ï¼Œä¾‹å¦‚ &lt;code&gt;String&lt;/code&gt;ï¼Œ&lt;code&gt;Number&lt;/code&gt;ï¼Œ&lt;code&gt;Array&lt;/code&gt;ï¼Œ&lt;code&gt;Data&lt;/code&gt;ï¼Œ&lt;code&gt;Date&lt;/code&gt; ç­‰ï¼Œå½“ç„¶å¦‚æœä½ è¦å­˜å‚¨è‡ªå®šä¹‰çš„ç±»ï¼Œå…¶éœ€è¦éµå®ˆ &lt;code&gt;Codable&lt;/code&gt; åè®®ï¼ˆå®è´¨ä¹Ÿæ˜¯è¦å½’æ¡£ä¸º &lt;code&gt;Data&lt;/code&gt;ï¼‰&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/cxWHfvS.png&#34; alt=&#34;plist&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;userdefaults-ç›®çš„&#34;&gt;UserDefaults ç›®çš„&lt;/h3&gt;

&lt;blockquote&gt;
&lt;p&gt;The defaults system allows an app to customize its behavior to match a userâ€™s preferences. For example, you can allow users to specify their preferred units of measurement or media playback speed. Apps store these preferences by assigning values to a set of parameters in a userâ€™s defaults database.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¸€èˆ¬æˆ‘ä»¬åœ¨ &lt;code&gt;UserDefaults&lt;/code&gt; å­˜å‚¨çš„æ•°æ®éƒ½æ˜¯ç”¨æˆ·çš„æŸäº›é…ç½®é¡¹ï¼Œä¸å› ä¸ºç”¨æˆ·ä½¿ç”¨è¿‡ç¨‹ä¸­å‡ºç°æ„å¤–è€Œä¸¢å¤±ï¼Œæ¯”å¦‚æ˜¯å¦å¼€å¯äº†æ—¥å¤œé—´æ¨¡å¼äº†ï¼Œæ˜¯å¦å¼€å¯äº†å¤§å›¾æ¨¡å¼äº†ç­‰ç­‰ã€‚æˆ–è€…å­˜å‚¨ä¸€äº›å¯¹å®‰å…¨æ–¹é¢ä¸æ•æ„Ÿçš„æ•°æ®&lt;/p&gt;

&lt;p&gt;ä¸å»ºè®®å¾€ &lt;code&gt;UserDefaults&lt;/code&gt; é‡Œå­˜å‚¨è¾ƒå¤§çš„æ•°æ®ï¼Œä¾‹å¦‚ç›´æ¥å­˜å‚¨ä¸€å¼ å›¾ç‰‡ã€‚è€Œå¯¹äºè¿™ç§éœ€è¦å­˜å‚¨è¾ƒå¤§æ–‡ä»¶çš„éœ€æ±‚ï¼Œä½ å¯ä»¥å°†æ–‡ä»¶æœ¬èº«å­˜å‚¨åˆ°æœ¬åœ°ï¼Œè€Œ &lt;code&gt;UserDefaults&lt;/code&gt; é‡Œåªå­˜å‚¨è¯¥æ–‡ä»¶çš„è·¯å¾„ã€‚&lt;/p&gt;

&lt;p&gt;æ¯•ç«Ÿåœ¨ App å¯åŠ¨ä¹‹åï¼ŒUserDefaults ä¼šè¿›è¡Œ IO ï¼Œè¯»å–æœ¬åœ° plist æ–‡ä»¶ï¼Œå› æ­¤ä¸€å®šç¨‹åº¦ä¸Šï¼Œä¹Ÿä¼šè¾ƒå°‘ App å¯åŠ¨ä¹‹å UserDefaults API é’ˆå¯¹ &lt;code&gt;plist&lt;/code&gt; æ–‡ä»¶ IO çš„æ—¶é—´ï¼Œçº¯å±ä¸ªäººæ£æµ‹ï¼Œæ²¡æœ‰ç»è¿‡å®éªŒéªŒè¯ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å…³äº-extension-ä¸­-userdefaults-çš„åº”ç”¨&#34;&gt;å…³äº Extension ä¸­ UserDefaults çš„åº”ç”¨&lt;/h3&gt;

&lt;p&gt;iOS ä¸Š Extension å’Œ Host App ä¹‹é—´åšæ•°æ®å…±äº«ä¹Ÿæ˜¯é€šè¿‡ UserDefaultsï¼Œå¼€å¯ App Group ä¹‹åï¼Œè¿™äºŒè€…å°±å¯ä»¥ä¿®æ”¹åŒä¸€ä»½é…ç½®ã€‚å…·ä½“ Extension å’Œ Host App ä¹‹é—´çš„å†…åœ¨å…³ç³»å¯ä»¥å…ˆçœ‹ä¸‹ Apple æ–‡æ¡£ã€‚æœ¬è´¨ä¸Šå¦‚ä¸‹æ‰€ç¤ºï¼Œ&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/cZFlz6o.png&#34; alt=&#34;app_extensions_container_restrictions&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Extension å’Œ Host App ä¹‹é—´é€šè¿‡ Shared Container æ¥åšæ•°æ®å…±äº«ï¼Œè¯¥ SharedContainer ç§æœ‰ï¼Œå› æ­¤ä¸å­˜åœ¨äºå•ä¸€ App çš„æ²™ç›’å†…ã€‚åº”è¯¥æ˜¯ç³»ç»Ÿä¼šå•ç‹¬å¼€è¾Ÿä¸€å—ç©ºé—´ç”¨ä»¥åšå…±äº«æ•°æ®çš„å­˜å‚¨ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;After you enable app groups, an app extension and its containing app can both use the NSUserDefaults API to share access to user preferences. To enable this sharing, use the initWithSuiteName: method to instantiate a new NSUserDefaults object, passing in the identifier of the shared group.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å› ä¸º UserDefaults æ—¢ç„¶æ˜¯æš´éœ²åœ¨æœ¬åœ°èƒ½å¤Ÿè®¿é—®çš„æ–‡ä»¶å½“ä¸­çš„ï¼Œå› æ­¤ä¸è¦åœ¨ UserDefaults é‡Œå­˜å‚¨ä»»ä½• Security-Sensitive çš„æ•°æ®ã€‚ å¦‚æœè¦å­˜å‚¨ä¿å¯†çº§åˆ«è¾ƒé«˜çš„æ•°æ®ï¼Œå°±è¦ç”¨åˆ°å¦å¤–ä¸€ç§æŒä¹…åŒ–æ–¹æ¡ˆ â”€â”€ Keychain&lt;/p&gt;

&lt;h2 id=&#34;keychain&#34;&gt;Keychain&lt;/h2&gt;

&lt;p&gt;å…³äº Keychainï¼Œæ˜¯ Apple æä¾›ç»™å¼€å‘è€…ç”¨æ¥å­˜å‚¨ Security-Sensitive çš„æ•°æ®äº†ï¼Œæ¯”å¦‚ç™»å½•å¯†ç ï¼Œç”¨æˆ·æ ‡è¯†ï¼ŒåŠ å¯†æ•°æ®ç­‰ç­‰ã€‚ å®˜æ–¹ç¤ºæ„å›¾å¦‚ä¸‹ï¼Œå…¶å®ä¸­é—´ Keychain çš„ API è¿˜è¿›è¡Œäº† Decrypt å’Œ Encrypt çš„åŠ¨ä½œã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/tvA4lV3.png&#34; alt=&#34;Keychain services API&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Apple æä¾›çš„ Keychain API å¤§éƒ¨åˆ†éƒ½æ˜¯ C è¯­è¨€å†™æˆï¼Œä½¿ç”¨èµ·æ¥ç›¸å¯¹ä¸ä¾¿ï¼Œå› æ­¤åŸºæœ¬ä¸Šæˆ‘ä»¬éƒ½ä¼šä½¿ç”¨äºŒæ¬¡åŠ å·¥è¿‡çš„åº“ï¼Œæ¯”å¦‚çŸ¥ä¹ç”¨çš„å°±æ˜¯ SMKeychainã€‚&lt;/p&gt;

&lt;p&gt;Keychain ä¸­çš„æ•°æ®å®Œå…¨äº¤ç”±ç³»ç»Ÿä¿ç®¡å¹¶åŠ å¯†è¿‡( AES 128 in GCM (Galois/Counter Mode))çš„ï¼Œå› æ­¤èƒ½å¤Ÿä¿è¯å®‰å…¨æ€§ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœå¯¹åŠ å¯†è¿™ä¸€å—æ„Ÿå…´è¶£ï¼Œå¯ä»¥çœ‹ä¸‹&lt;a href=&#34;https://www.apple.com/business/site/docs/iOS_Security_Guide.pdf&#34;&gt;è‹¹æœçš„ç™½çš®ä¹¦&lt;/a&gt;ä¸­ Keychain data protection è¿™ä¸€èŠ‚ã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–ï¼ŒKeychain çš„æ•°æ®å¹¶ä¸å­˜æ”¾åœ¨ App çš„ Sanbox ä¸­ï¼Œå³ä½¿åˆ é™¤äº† Appï¼Œèµ„æ–™ä¾ç„¶ä¿å­˜åœ¨ keychain ä¸­ã€‚å¦‚æœé‡æ–°å®‰è£…äº†appï¼Œè¿˜å¯ä»¥ä» keychain è·å–æ•°æ®ã€‚&lt;/p&gt;

&lt;h3 id=&#34;åŒä¸€ä¸ª-app-å†…éƒ¨å…±äº«&#34;&gt;åŒä¸€ä¸ª App å†…éƒ¨å…±äº«&lt;/h3&gt;

&lt;p&gt;ç±»ä¼¼ UserDefaults ï¼ŒKeychain ä¹Ÿæ”¯æŒ Extension å’Œ host app ä¹‹é—´çš„å…±äº«ï¼Œéœ€è¦åœ¨æ¯ä¸ª Target çš„ Capability ä¸‹å¼€å¯ Keychain Sharing åŠŸèƒ½ï¼Œå¹¶ä¸”è®¾ç½®ä¸ºåŒä¸€ä¸ª Groupã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä¸åŒ-app-ä¹‹é—´å…±äº«&#34;&gt;ä¸åŒ App ä¹‹é—´å…±äº«&lt;/h3&gt;

&lt;p&gt;å’Œ UserDefaults ä¸åŒçš„æ˜¯ï¼ŒKeychain çš„æ•°æ®æ˜¯å¯ä»¥è·¨ App è·å–çš„ï¼Œä½†æ˜¯é™äºä¸€ä¸ªå¼€å‘è€…çš„ Appï¼Œä¹Ÿå°±æ˜¯éœ€è¦ç¡®ä¿è¿™äº› App æ‰€å±çš„ Team ID æ˜¯ç›¸åŒçš„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªä¹Ÿæ˜¯App è¿›è¡Œ SSO ç™»å½•çš„åŸºç¡€ï¼Œæ¯”å¦‚çŸ¥ä¹æ—¥æŠ¥ä½¿ç”¨çŸ¥ä¹ä¸» App ç™»å½•ä¹Ÿæ˜¯åŸºäºæ­¤åŸç†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/0L2MA23.png&#34; alt=&#34;shared items&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨éœ€è¦è¿›è¡Œ Keychain å…±äº«çš„ App å†…å¼€å¯ Keychain Sharing çš„èƒ½åŠ›ï¼Œæ‰€å±åŒä¸€ä¸ª Team ID ä¸‹çš„ App æœ¬èº«éƒ½å¯ä»¥è¯»å–è¯¥ Keychain çš„å†…å®¹ï¼Œç±»ä¼¼äº AppGroupï¼Œè¿™é‡Œä¹Ÿä¼šäº§ç”Ÿ Keychain Groupã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Allows this application to share passwords from its keychain with other applications made by your team.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/DJsInJb.png&#34; alt=&#34;Keychain Sharing&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;å‚è€ƒæ–‡æ¡£&#34;&gt;å‚è€ƒæ–‡æ¡£&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/documentation/foundation/userdefaults&#34;&gt;https://developer.apple.com/documentation/foundation/userdefaults&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.reddit.com/r/jailbreak/comments/2qpqi9/ios_812_has_protection_against_plist_file_editing/&#34;&gt;https://www.reddit.com/r/jailbreak/comments/2qpqi9/ios_812_has_protection_against_plist_file_editing/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://iphonedevwiki.net/index.php/PreferenceBundles&#34;&gt;http://iphonedevwiki.net/index.php/PreferenceBundles&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html&#34;&gt;https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/ExtensionScenarios.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/documentation/security/keychain_services&#34;&gt;https://developer.apple.com/documentation/security/keychain_services&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/soffes/SAMKeychain&#34;&gt;https://github.com/soffes/SAMKeychain&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/documentation/security/keychain_services/keychain_items/sharing_access_to_keychain_items_among_a_collection_of_apps&#34;&gt;https://developer.apple.com/documentation/security/keychain_services/keychain_items/sharing_access_to_keychain_items_among_a_collection_of_apps&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
      
    </item>
    
    <item>
      <title>å¦‚ä½•åš Send to 2Do çš„ä¹¦ç­¾</title>
      <link>https://hechen.xyz/post/send-to-2do/</link>
      <pubDate>Mon, 26 Nov 2018 14:59:50 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/send-to-2do/</guid>
      
        <description>&lt;p&gt;ä½¿ç”¨é¼ æ ‡æ‹–æ‹½ä¸‹é¢è¿™ä¸ªé“¾æ¥åˆ°ä½ çš„ Favorites Bar ä¸Šï¼Œ&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;javascript:window.location=&#34;&gt;Send to 2Do&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ç„¶åç¼–è¾‘åœ°å€ï¼Œå°†å…¶æ›¿æ¢ä¸ºå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;javascript:window.location=&#39;twodo://x-callback-url/add?task=&#39;+encodeURIComponent(document.title)+&#39;&amp;amp;note=&#39;+encodeURIComponent(window.location)+&#39;&amp;amp;action=url:&#39;+encodeURIComponent(window.location)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/7M0xN1g.jpg&#34; alt=&#34;Change Value&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œå…¶å®è¿˜æ˜¯åœ¨è§¦å‘è°ƒç”¨ URL Schemeï¼Œå…¶ä¸­&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;code&gt;document.title&lt;/code&gt; ä¸ºæ ‡é¢˜&lt;/li&gt;
&lt;li&gt;&lt;code&gt;window.location&lt;/code&gt; ä¸ºå½“å‰é¡µé¢é“¾æ¥&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“ Things çš„ URL Scheme ä¸º&lt;/p&gt;

&lt;p&gt;&lt;code&gt;things:///add?title=iamtitle&amp;amp;notes=iamnotes&amp;amp;when=tomorrow&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ä½ å¯ä»¥æŠŠé“¾æ¥å†…å®¹æ”¹ä¸ºæ”¯æŒ Send To Thingsï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;javascript:window.location=&#39;things:///add?title=&#39;+encodeURIComponent(document.title)+&#39;&amp;amp;notes=&#39;+encodeURIComponent(window.location)+&#39;&amp;amp;when=today&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»¥åŠ Send To OmniFocus ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;javascript:window.location=&#39;omnifocus:///add?note=&#39;+encodeURIComponent(window.location)+&#39;&amp;amp;name=&#39;+encodeURIComponent(document.title)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ–è€…ç›´æ¥å» &lt;a href=&#34;http://people.omnigroup.com/kc/OmniFocus/SendToOmniFocusBookmarklet.html&#34;&gt;OmniFocus é¡µé¢&lt;/a&gt; ç”¨ç›¸åŒæ–¹å¼æŠŠèµ·å·²ç»è®¾ç½®å¥½æ­£ç¡® Value çš„é“¾æ¥æ‹–åˆ°ä¸Šæ–¹å·¥å…·æ¡ä¸Šå³å¯ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ æ‰¾ä¸åˆ° Favorites Barï¼Œç‚¹å‡» Safari èœå•æ ä¸Šçš„ View èœå•å°±èƒ½çœ‹åˆ°ï¼ˆä¸­æ–‡ç³»ç»Ÿå«è§†å›¾ï¼‰&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ZBqkn4Z.jpg&#34; alt=&#34;Favorites Bar&#34; /&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>é˜…è¯»æµç¨‹</title>
      <link>https://hechen.xyz/post/reading-process/</link>
      <pubDate>Tue, 16 Oct 2018 17:01:44 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/reading-process/</guid>
      
        <description>

&lt;p&gt;æœ€è¿‘ç»Ÿä¸€äº†ä¸€ä¸‹è‡ªå·±çš„é˜…è¯»æµç¨‹ï¼Œæ›´æ–°ä¸€ä¸‹ï¼Œå…·ä½“ç”¨åˆ°çš„å·¥å…·æœ‰&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;DEVONThink Pro&lt;/li&gt;
&lt;li&gt;PDFExpert&lt;/li&gt;
&lt;li&gt;MarginNote&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å…¶ä¸­ 1 æ˜¯è¾“å…¥å’Œå½’æ¡£æºï¼Œ3 æ˜¯è¾“å‡ºæºã€‚ å¤§æ¦‚å°±æ˜¯å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/SrcVtP1.png&#34; alt=&#34;Reading Process&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;é‡‡é›†ç´ æ&#34;&gt;é‡‡é›†ç´ æ&lt;/h2&gt;

&lt;p&gt;åœ¨å¹³æ—¶æµè§ˆç½‘é¡µçš„æ—¶å€™ï¼Œçœ‹åˆ°è‡ªå·±å–œæ¬¢çš„æ–‡ç« ä¹‹åï¼Œæƒ³è¿›è¡Œä¸€äº›æ ‡è®°æˆ–è€…åšç¬”è®°ï¼Œå¤§æ¦‚æœ‰å‡ ä¸ªé€‰æ‹©ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å°è±¡ç¬”è®°ç›´æ¥ clip å½“å‰ç½‘é¡µï¼Œä¹‹ååœ¨å°è±¡ç¬”è®°é‡Œè¿›è¡Œé˜…è¯»æˆ–è€…æ ‡è®°&lt;/li&gt;
&lt;li&gt;æ”¾è¿›ç¨åè¯»æœåŠ¡ä¸­ï¼Œæ¯”å¦‚ Pocket æˆ–è€… Instapaper ç­‰ï¼›&lt;/li&gt;
&lt;li&gt;ç”¨ Safari è‡ªå¸¦çš„ Save as PDF ä¹‹åå†ç”¨å•ç‹¬çš„ PDF å·¥å…·æŸ¥çœ‹ï¼›&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è€Œæœ€è¿‘å‡ ä¸ªæœˆï¼Œå› ä¸º MarginNote 3 çš„å‘å¸ƒï¼Œç”±äºå…¶æä¾›çš„å¤§çº²è„‘å›¾çš„è‡ªåŠ¨ç”Ÿæˆï¼Œç»™æˆ‘æä¾›äº†ä¸€ç§ä¾¿åˆ©çš„æ‹†ä¹¦åŠŸèƒ½ï¼Œå› æ­¤ä¼šæŠŠå¹³æ—¶çœ‹åˆ°çš„æ–‡ç« éƒ½å½’é›†åˆ°ä¸€å¤„æ¥çœ‹ã€‚&lt;/p&gt;

&lt;p&gt;å€ŸåŠ© DEVONthink çš„ Clip To DEVONthink çš„æ’ä»¶å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠæ–‡ç« å½’é›†åˆ° DEONThink ä¸­ï¼Œæœ€ä¸»è¦çš„æ˜¯å› ä¸ºå®ƒèƒ½ä¿å­˜ WebArchiveï¼Œå³ä½¿åç»­æ–‡ç« è¢«åˆ é™¤ä¹Ÿæ²¡å…³ç³»ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Kw7CoBl.png&#34; alt=&#34;Clip To DEVONthink&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å½“æŒ‰ä¸‹ Cmmd + S è¿›è¡Œå½’æ¡£ä¹‹åï¼ŒDEVONThink å¯¹åº” Group é‡Œå°±ä¼šæŠŠè¯¥åŸå§‹é¡µé¢ä¿å­˜èµ·æ¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/m3jM9kx.png&#34; alt=&#34;DEVONthink&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç”±äº WebArchive æ— æ³•åš Highlight æ ‡è®°ï¼Œè¿™æ—¶å€™å°±ç”¨åˆ°äº† DEVONthink æä¾›çš„ OCR åŠŸèƒ½ï¼Œå°† WebArchive æå–ä¸º PDF æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/YxEsN2G.png&#34; alt=&#34;WebArchive To PDF&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;äºŒæ¬¡åŠ å·¥å¤„ç†&#34;&gt;äºŒæ¬¡åŠ å·¥å¤„ç†&lt;/h2&gt;

&lt;p&gt;å½“ä½ ä½¿ç”¨ DEVONthink ç”Ÿæˆ PDF ä¹‹åï¼Œå°±å¯ä»¥ç›´æ¥ç”¨å…¶è‡ªå¸¦çš„ PDF é˜…è¯»å·¥å…·è¿›è¡Œé˜…è¯»äº†ï¼Œå®ƒé»˜è®¤æä¾›å·¥å…·å·²ç»å®Œå…¨æ»¡è¶³ï¼Œä¸è¿‡æˆ‘æƒ³åˆ©ç”¨ MarginNote æ¥é˜…è¯»ï¼Œå› æ­¤è¿™æ—¶å€™ä½ å¯ä»¥é€‰æ‹©ç›´æ¥å‘é€åˆ° MarginNote æ¥é˜…è¯»ã€‚&lt;/p&gt;

&lt;p&gt;å…¶å®æ›´å¤šæ—¶å€™ï¼Œæˆ‘ä¼šé€‰æ‹©å…ˆä½¿ç”¨ PDF Expert è¿›è¡Œ PDF æ–‡ä»¶çš„è£å‰ªï¼Œå› ä¸ºå¤§å¤šæ•°æ—¶å€™ç½‘é¡µæ­£æ–‡å†…å®¹ä¸¤ä¾§ç•™ç™½å¤ªå¤šï¼Œæƒ³è£å‰ªæ‰ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/8I8UcFY.png&#34; alt=&#34;PDF With Margin&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è£å‰ªæ‰å¤šä½™çš„éƒ¨åˆ†ä¹‹åï¼Œpdf æ–‡ä»¶å°±å¯è¯»æ€§ä¹Ÿä¼šæå¤§æé«˜ã€‚
&lt;img src=&#34;https://i.imgur.com/1CwG33x.png&#34; alt=&#34;Final PDF&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;é˜…è¯»è¾“å‡º&#34;&gt;é˜…è¯»è¾“å‡º&lt;/h2&gt;

&lt;p&gt;åˆ°äº†è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠæ–‡æ¡£å¯¼å…¥åˆ° MarginNote ä¸­ï¼Œå¦‚å›¾æ‰€ç¤ºï¼š
&lt;img src=&#34;https://i.imgur.com/DmADrxk.png&#34; alt=&#34;MarginNote Import&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨ &lt;strong&gt;Add to Study&lt;/strong&gt;ï¼Œå°†è‡ªå·±çš„æ ‡è®°å’Œç¬”è®°ç”Ÿæˆç¬”è®°æœ¬ï¼ŒMarginNote å¼ºå¤§å°±åœ¨äºèƒ½å¤Ÿå¾ˆå¥½çš„è‡ªåŠ¨å¸®ä½ æŠŠé‡ç‚¹å½’é›†åˆ°ä¸€èµ·ï¼Œç”Ÿæˆè„‘å›¾å…³è”ï¼Œä½ è¿˜å¯ä»¥é’ˆå¯¹æŸä¸ªéƒ¨åˆ†åšç¬”è®°ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/9uvu95H.png&#34; alt=&#34;MarginNote Add To Study&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è€Œä¸”å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬çœ‹ä¸€ç¯‡æ–‡ç« å¾ˆå¤§å¯èƒ½ä¼šå±•å¼€è¿™ä¸ªä¸»é¢˜ï¼Œæ¯”å¦‚çœ‹ä¸‹è¯¥æ–‡ç« ä¸‹ç»™çš„å‚è€ƒé“¾æ¥ï¼Œè¿™äº›å¾€å¾€éƒ½æ˜¯åŒæ ·ä¸»é¢˜çš„å†…å®¹ï¼Œæˆ‘ä»¬å¸Œæœ›ç›¸å…³çš„æ–‡ç« èƒ½å¤Ÿæ•´ä½“å½’é›†åˆ°ä¸€ä¸ªç¬”è®°æœ¬ä¸‹ã€‚MarginNote å¯ä»¥å¾ˆæ–¹ä¾¿åšåˆ°ï¼Œæ¯”å¦‚ä¸‹å›¾ï¼Œæˆ‘åœ¨é˜…è¯» Apple å®˜æ–¹ URL Session Programming Guide çš„æ—¶å€™ä¼šæŸ¥çœ‹å¾ˆå¤šç›¸å…³æ–‡ç« ï¼Œä¹Ÿéƒ½æ˜¯ç›¸å…³å†…å®¹ï¼Œæˆ‘ä¼šæŠŠç¬”è®°æ•´ç†åœ¨ä¸€èµ·ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/kIvn6v8.png&#34; alt=&#34;MarginNote Note Group&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘å•ç‹¬åœ¨ MarginNote é‡Œå»ºäº†ä¸€ä¸ª Folder ï¼Œå« Articleã€‚ä¸“é—¨é˜…è¯»æˆ‘ä» DEVONthink ä¸­é‡‡é›†åˆ°çš„æ–‡ç« ã€‚é˜…è¯»å®Œæ¯•ï¼Œè¿˜å¯ä»¥å°†é˜…è¯»ç¬”è®°å½’æ¡£ï¼ŒMarginNote æ”¯æŒåˆ†äº«åˆ° å°è±¡ç¬”è®°ï¼ŒWord æˆ–è€… DEVONthink è¿›è¡Œå½’æ¡£ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/yyQ3pOr.png&#34; alt=&#34;Export&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åˆ°äº†è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šå¯¹æˆ‘æ¥è®²ä¸€ä¸ª è¾“å…¥ â”€â”€ å¤„ç† â”€â”€ é˜…è¯» â”€â”€ è¾“å‡º çš„æ•´ä¸ªæµç¨‹å°±ç»“æŸäº†ï¼ŒåŸºæœ¬ä¸Šæ˜¯ä¸€ä¸ªé—­ç¯ã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šé¢æåˆ°çš„ä¸‰ä¸ªå·¥å…·ï¼Œå‡æœ‰ iOS ç‰ˆæœ¬ï¼Œä¹Ÿå°±æ„å‘³ç€å³ä½¿æ‹¿ç€æ‰‹æœºä¹Ÿèƒ½å¤Ÿä¸ç ´åæ•´ä¸ªé˜…è¯»ç¯èŠ‚ï¼Œä¸è¿‡å…¶ä¸­ DEVONthink æä¾›çš„ iOS ç‰ˆæœ¬æ˜¯æ²¡åŠæ³•è¿›è¡Œ WebArchive å‘ PDF çš„è½¬æ¢çš„ï¼Œå¤„ç†è¿™ä¸€æ­¥æœ€åè¿˜æ˜¯å¾—æ”¾åœ¨ Mac ç«¯å¤„ç†ï¼Œä¸è¿‡è§£å†³äº†è¾“å…¥å’Œè¾“å‡ºä¹Ÿå°±æ„å‘³ç€éšæ—¶éšåœ°å¯ä»¥æ•è·æƒ³çœ‹çš„å†…å®¹æ”¾åˆ°ç¨åè¯»åˆ—è¡¨ï¼Œç„¶åè‡ªåŠ¨åŒæ­¥åˆ° Mac ç«¯è¿›è¡Œå¤„ç†ï¼Œç„¶ååœ¨ MarginNote å¯¹åº”çš„ iOS ç‰ˆæœ¬ï¼Œå¹³æ—¶åœ¨å®¶çš„æ—¶å€™è¿˜æ˜¯ä¹ æƒ¯ç”¨ iPad Pro æŸ¥çœ‹ï¼Œä½“éªŒä¹Ÿä¸é”™ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ZJsdxyS.jpg&#34; alt=&#34;iPad MarginNote&#34; /&gt;&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>ä¸‰ä¸ªç®€å•æ­¥éª¤è®©ä½ æµ‹è¯•ä½¿ç”¨ç³»ç»Ÿå•ä¾‹çš„ä»£ç </title>
      <link>https://hechen.xyz/post/testing-swift-code-that-uses-system-singletons-in-3-easy-steps/</link>
      <pubDate>Tue, 17 Jul 2018 17:09:57 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/testing-swift-code-that-uses-system-singletons-in-3-easy-steps/</guid>
      
        <description>

&lt;p&gt;å¤§éƒ¨åˆ†åœ¨ Apple å¹³å°å¼€å‘çš„ App éƒ½ä¼šä¾èµ–åŸºäºå•ä¾‹çš„ APIã€‚ä» UIScreen åˆ° UIApplicationï¼Œå†åˆ° NSBundleï¼Œè€Œ Foundationï¼ŒUIKit ä»¥åŠ AppKit é‡Œåˆ°å¤„å……æ–¥ç€é™æ€çš„ APIã€‚&lt;/p&gt;

&lt;p&gt;å°½ç®¡å•ä¾‹éå¸¸æ–¹ä¾¿ï¼Œå¹¶ä¸”éšæ—¶éšåœ°éƒ½å¯ä»¥å¾ˆè½»æ˜“çš„è·å–åˆ°ç‰¹å®šçš„ APIï¼Œä½†æ˜¯å½“å®ƒä»¬ä¸€æ—¦è¦é¢ä¸´ä»£ç è§£è€¦å’Œæµ‹è¯•çš„æ—¶å€™å°±ä¼šå‡ºç°æŒ‘æˆ˜ã€‚å•ä¾‹åŒæ—¶ä¹Ÿæ˜¯å¹³æ—¶é‡åˆ° Bug é‡Œæœ€å¸¸è§çš„ä¸€ç§ï¼Œåœ¨å•ä¾‹ä¸­çŠ¶æ€ä¼šä»¥å…±äº«çš„æ–¹å¼ç»ˆç»“ï¼Œé‚£äº›é’ˆå¯¹çŠ¶æ€åšçš„å˜æ›´å¹¶ä¸èƒ½å¾ˆå¥½çš„å¹¿æ’­åˆ°æ•´ä¸ªç³»ç»Ÿå±‚é¢ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œå°½ç®¡æˆ‘ä»¬èƒ½å¤Ÿé‡æ„è‡ªå·±çš„ä»£ç ï¼Œè®©å®ƒä»¬åªåœ¨çœŸæ­£éœ€æ±‚çš„åœ°æ–¹ä½¿ç”¨å•ä¾‹ï¼Œæˆ‘ä»¬é’ˆå¯¹ç³»ç»Ÿ API ä¹Ÿåšä¸äº†å¤ªå¤šã€‚ä½†æ˜¯ï¼Œå¥½æ¶ˆæ¯æ˜¯ï¼Œè¿™é‡Œæœ‰ä¸€äº›æŠ€å·§è®©ä½ ä½¿ç”¨ç³»ç»Ÿå•ä¾‹çš„ä»£ç ä¾ç„¶å˜å¾—å®¹æ˜“ç®¡ç†å’Œæµ‹è¯•ã€‚&lt;/p&gt;

&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€äº›ä½¿ç”¨äº† URLSession.shared å•ä¾‹çš„ä»£ç ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class DataLoader {
    enum Result {
        case data(Data)
        case error(Error)
    }

    func load(from url: URL, completionHandler: @escaping (Result) -&amp;gt; Void) {
        let task = URLSession.shared.dataTask(with: url) { (data, response, error) in
            if let error = error {
                return completionHandler(.error(error))
            }

            completionHandler(.data(data ?? Data()))
        }

        task.resume()
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸Šé¢è¿™ä¸ª &lt;strong&gt;DataLoader&lt;/strong&gt; ç°åœ¨å°±å˜å¾—å¾ˆéš¾æµ‹è¯•ï¼Œå› ä¸ºå®ƒå†…éƒ¨ä¼šè‡ªä¸»è°ƒç”¨å…±äº«çš„ URL Session æ¥æ‰§è¡Œä¸€ä¸ªç½‘ç»œè°ƒç”¨ã€‚è¿™å°±éœ€è¦æˆ‘ä»¬ä¸ºæµ‹è¯•ä»£ç ä¸­å¢åŠ ä¸€äº›ç­‰å¾…å’Œè¶…æ—¶ä»£ç ï¼Œç„¶åå¾ˆå¿«è¿™éƒ¨åˆ†ä»£ç å°±ä¼šå˜å¾—ç³Ÿç³•å’Œä¸ç¨³å®šã€‚&lt;/p&gt;

&lt;h3 id=&#34;æŠ½è±¡æˆä¸€ä¸ªåè®®&#34;&gt;æŠ½è±¡æˆä¸€ä¸ªåè®®&lt;/h3&gt;

&lt;p&gt;æˆ‘ä»¬ç¬¬ä¸€ä¸ªä»»åŠ¡å°±æ˜¯æŠŠæˆ‘ä»¬éœ€è¦çš„ URLSession çš„éƒ¨åˆ†ç§»åˆ°ä¸€ä¸ªåè®®é‡Œï¼Œè¿™æ ·æˆ‘ä»¬åœ¨æµ‹è¯•ä¸­ä¹Ÿèƒ½å¤Ÿå¾ˆå®¹æ˜“çš„è¿›è¡Œ mockã€‚åœ¨ä½œè€…çš„&lt;a href=&#34;http://www.ustream.tv/recorded/101118612&#34;&gt;ä¸€æ¬¡ talk&lt;/a&gt;ä¸­ä½œè€…å»ºè®®å°½å¯èƒ½çš„é¿å… mockï¼Œå°½ç®¡å®ƒæ˜¯ä¸€ç§å¾ˆå¥½çš„ç­–ç•¥ã€‚ä½†æ˜¯å½“ä½ å’Œç³»ç»Ÿçš„å•ä¾‹æ‰“äº¤é“çš„æ—¶å€™ï¼Œmock å°±æ˜¯ä¸€ä¸ªå¢åŠ å¯é¢„æµ‹æ€§çš„é‡è¦å·¥å…·ã€‚&lt;/p&gt;

&lt;p&gt;è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª &lt;strong&gt;NetworkEngine&lt;/strong&gt; åè®®ï¼Œç„¶åè®© URLSession ç¬¦åˆå®ƒ:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
protocol NetworkEngine {
    typealias Handler = (Data?, URLResponse?, Error?) -&amp;gt; Void

    func performRequest(for url: URL, completionHandler: @escaping Handler)
}

extension URLSession: NetworkEngine {
    typealias Handler = NetworkEngine.Handler

    func performRequest(for url: URL, completionHandler: @escaping Handler) {
        let task = dataTask(with: url, completionHandler: completionHandler)
        task.resume()
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚ä¸Šæ‰€è§ï¼Œæˆ‘ä»¬ä½¿å¾— &lt;strong&gt;URLSessionDataTask&lt;/strong&gt; æˆäº† &lt;strong&gt;URLSession&lt;/strong&gt; çš„ä¸€ä¸ªå®ç°ç»†èŠ‚ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±é¿å…äº†åœ¨æµ‹è¯•ä»£ç ä¸­ä¸å¾—ä¸åˆ›å»ºä¸åŒçš„ mock ï¼Œè€Œåªéœ€è¦å…³æ³¨ NetworkEngine å°±è¡Œã€‚&lt;/p&gt;

&lt;h3 id=&#34;åè®®ä¸­æŠŠå•ä¾‹ä½œä¸ºé»˜è®¤å€¼&#34;&gt;åè®®ä¸­æŠŠå•ä¾‹ä½œä¸ºé»˜è®¤å€¼&lt;/h3&gt;

&lt;p&gt;ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ›´æ–°æˆ‘ä»¬çš„ &lt;strong&gt;DataLoader&lt;/strong&gt; æ¥ä½¿ç”¨æ–°çš„ NetworkEngine åè®®ï¼ŒæŠŠå®ƒä½œä¸ºä¾èµ–é¡¹æ³¨å…¥ã€‚æˆ‘ä»¬æŠŠ URLSession.shared ä½œä¸ºé»˜è®¤å‚æ•°ä¼ é€’ï¼Œä»¥æ­¤åšåˆ°äº†å‘åå…¼å®¹å¹¶ä¸”å’Œä¹‹å‰ä¸€æ ·æ–¹ä¾¿ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class DataLoader {
    enum Result {
        case data(Data)
        case error(Error)
    }

    private let engine: NetworkEngine

    init(engine: NetworkEngine = URLSession.shared) {
        self.engine = engine
    }

    func load(from url: URL, completionHandler: @escaping (Result) -&amp;gt; Void) {
        engine.performRequest(for: url) { (data, response, error) in
            if let error = error {
                return completionHandler(.error(error))
            }

            completionHandler(.data(data ?? Data()))
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€šè¿‡ä½¿ç”¨é»˜è®¤å‚æ•°ï¼Œæˆ‘ä»¬ä¾ç„¶å¯ä»¥åƒä¹‹å‰ä¸€æ ·å¾ˆå®¹æ˜“çš„ç”Ÿæˆ &lt;strong&gt;DataLoader&lt;/strong&gt;ï¼Œè€Œä¸éœ€è¦æä¾›ä¸€ä¸ª &lt;strong&gt;NetworkEngine&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;h3 id=&#34;åœ¨ä½ çš„æµ‹è¯•ä¸­-mock-åè®®&#34;&gt;åœ¨ä½ çš„æµ‹è¯•ä¸­ Mock åè®®&lt;/h3&gt;

&lt;p&gt;æœ€åï¼Œè®©æˆ‘ä»¬å†™ä¸ªæµ‹è¯•ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬é€šè¿‡ mock &lt;strong&gt;NetworkEngine&lt;/strong&gt; ä½¿å¾—æˆ‘ä»¬çš„æµ‹è¯•å¿«é€Ÿï¼Œå¯é¢„æµ‹å¹¶ä¸”å®¹æ˜“ç»´æŠ¤ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
func testLoadingData() {
    class NetworkEngineMock: NetworkEngine {
        typealias Handler = NetworkEngine.Handler 

        var requestedURL: URL?

        func performRequest(for url: URL, completionHandler: @escaping Handler) {
            requestedURL = url

            let data = â€œHello worldâ€.data(using: .utf8)
            completionHandler(data, nil, nil)
        }
    }

    let engine = NetworkEngineMock()
    let loader = DataLoader(engine: engine)

    var result: DataLoader.Result?
    let url = URL(string: â€œmy/APIâ€)!
    loader.load(from: url) { result = $0 }

    XCTAssertEqual(engine.requestedURL, url)
    XCTAssertEqual(result, .data(â€œHello worldâ€.data(using: .utf8)!))
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚ä¸Šæ‰€è§ï¼Œä½œè€…è¯•å›¾è®© mock å°½å¯èƒ½çš„ç®€å•ã€‚ä¸éœ€è¦åˆ›å»ºåŒ…å«å¤§é‡é€»è¾‘çš„å¤æ‚ mockï¼Œä½ åªéœ€è¦è®©è‡ªå·±çš„ä»£ç è¿”å›ä¸€äº› hardcode çš„å€¼é€šå¸¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œè¿™æ ·ï¼Œä½ èƒ½å¤Ÿåœ¨è‡ªå·±çš„æµ‹è¯•ä¸­è¿›è¡Œæ–­è¨€ã€‚ç„¶è€Œï¼Œé£é™©å°±æ˜¯ä½ å¯èƒ½æœ€åæµ‹è¯•çš„æ˜¯è‡ªå·±çš„ mock è€Œä¸æ˜¯ç”Ÿäº§ç¯å¢ƒçš„ä»£ç ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æœ€å&#34;&gt;æœ€å&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬ç°åœ¨é€šè¿‡ä»¥ä¸‹ä¸‰ä¸ªæ­¥éª¤è®©è¿™äº›ä¾ç„¶æ–¹ä¾¿çš„ä½¿ç”¨äº†ç³»ç»Ÿçš„å•ä¾‹å¯è¢«æµ‹è¯•ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æŠ½è±¡åè®®&lt;/li&gt;
&lt;li&gt;åè®®ä¸­æŠŠå•ä¾‹ä½œä¸ºé»˜è®¤å€¼&lt;/li&gt;
&lt;li&gt;åœ¨ä½ çš„æµ‹è¯•ä¸­ Mock è¯¥åè®®&lt;/li&gt;
&lt;/ol&gt;
</description>
      
    </item>
    
    <item>
      <title>é¿å…åœ¨ Swift ä¸­ä½¿ç”¨å•ä¾‹</title>
      <link>https://hechen.xyz/post/avoiding-singletons-in-swift/</link>
      <pubDate>Mon, 16 Jul 2018 17:34:36 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/avoiding-singletons-in-swift/</guid>
      
        <description>

&lt;p&gt;â€œæˆ‘çŸ¥é“å•ä¾‹ä¸å¥½ï¼Œä½†æ˜¯&amp;hellip;â€ï¼Œè¿™æ˜¯å¼€å‘è€…å¸¸å¸¸åœ¨è®¨è®ºä»£ç çš„æ—¶å€™ä¼šæåˆ°çš„ã€‚è²Œä¼¼ç¤¾åŒºå¤§å®¶æœ‰å…±è¯† â”€â”€ å•ä¾‹ä¸å¥½ã€‚ä½†æ˜¯åŒæ—¶ï¼ŒåŒ…æ‹¬ Apple å’Œç¬¬ä¸‰æ–¹çš„ Swift å¼€å‘è€…è¿˜æ˜¯åœ¨ App å†…éƒ¨æˆ–è€…å…±äº«çš„ frameworks é‡Œä¸æ–­åœ¨ç”¨å®ƒä»¬ã€‚&lt;/p&gt;

&lt;p&gt;è¿™å‘¨ï¼Œè®©æˆ‘ä»¬å¥½å¥½çœ‹ä¸€çœ‹å•ä¾‹çš„é—®é¢˜åˆ°åº•åœ¨å“ªé‡Œï¼Œæ¢ç´¢æ›´å¤šçš„æŠ€å·§ä»¥ä¾¿æˆ‘ä»¬æ—¥å¸¸èƒ½å¤Ÿé¿å…ä½¿ç”¨å®ƒä»¬ã€‚è¿™å°±å¼€å§‹å§ï¼&lt;/p&gt;

&lt;h3 id=&#34;ä¸ºä»€ä¹ˆå•ä¾‹è¿™ä¹ˆæµè¡Œ&#34;&gt;ä¸ºä»€ä¹ˆå•ä¾‹è¿™ä¹ˆæµè¡Œï¼Ÿ&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆä¸€ç‚¹æˆ‘ä»¬è¦æƒ³çš„æ˜¯é—®é—®è‡ªå·±ï¼Œä¸ºä»€ä¹ˆå•ä¾‹è¿™ä¹ˆæµè¡Œï¼Ÿçƒ­è¿‡å¤§å¤šæ•°å¼€å‘è€…éƒ½è®¤åŒï¼Œå•ä¾‹åº”è¯¥è¢«é¿å…çš„è¯ï¼Œä¸ºä»€ä¹ˆå®ƒä»¬è¿˜ä¸æ–­çš„å‡ºç°å‘¢ï¼Ÿ&lt;/p&gt;

&lt;p&gt;æˆ‘è®¤ä¸ºæœ‰ä¸¤éƒ¨åˆ†åŸå› ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘è§‰å¾—æ—¥å¸¸å¼€å‘ Apple å¹³å°ä¸Šçš„ App æ—¶å€™å¤§é‡ä½¿ç”¨å•ä¾‹ï¼Œæœ€å¤§çš„åŸå› æ˜¯è‹¹æœè‡ªå·±ä¹Ÿåœ¨ç»å¸¸çš„ç”¨ã€‚ä½œä¸ºç¬¬ä¸‰æ–¹å¼€å‘è€…æ¥è®²ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šæŠŠ Apple çš„åšæ³•ä½œä¸ºæœ€ä½³å®è·µæ¥ç”¨ï¼Œä»»ä½• Apple è‡ªå·±å¸¸å¸¸ä½¿ç”¨çš„æ¨¡å¼åœ¨ç¤¾åŒºä¹Ÿä¼šå‘å±•çš„å¾ˆè¿…é€Ÿã€‚&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªè°œé¢˜çš„ç¬¬äºŒä¸ªåŸå› æ˜¯å•ä¾‹éå¸¸æ–¹ä¾¿ã€‚å•ä¾‹å› ä¸ºå®ƒå¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è·å–åˆ°ï¼Œå› è€Œç»å¸¸ä¼šæ‰®æ¼”ä¸€ä¸ªè·å–ç‰¹å®šæ ¸å¿ƒå€¼æˆ–è€…å¯¹è±¡çš„å¿«æ·æ–¹å¼ã€‚å¯ä»¥çœ‹ä¸‹ä¸‹é¢è¿™ä¸ªä¾‹å­ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æƒ³åœ¨ &lt;strong&gt;ProfileViewController&lt;/strong&gt; ä¸­å±•ç¤ºå½“å‰ç™»å½•ç”¨æˆ·çš„åå­—ï¼ŒåŒæ—¶å½“æŸä¸ªæŒ‰é’®æŒ‰ä¸‹çš„æ—¶å€™ï¼Œé€€ç™»å½“å‰ç”¨æˆ·ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class ProfileViewController: UIViewController {
    private lazy var nameLabel = UILabel()
    override func viewDidLoad() {
        super.viewDidLoad()
        nameLabel.text = UserManager.shared.currentUser?.name
    }
    private func handleLogOutButtonTap() {
        UserManager.shared.logOut()
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æŒ‰ç…§ä¸Šé¢è¿™æ ·ï¼ŒæŠŠä¸€ä¸ª UserManager å•ä¾‹çš„ç”¨æˆ·å’Œè´¦æˆ·å¤„ç†çš„åŠŸèƒ½å°è£…èµ·æ¥ï¼Œç¡®å®å¾ˆæ–¹ä¾¿ï¼ˆè€Œä¸”å¾ˆå¸¸è§ï¼ï¼‰ï¼Œé‚£è¿™ç§æ¨¡å¼çš„ä½¿ç”¨åˆ°åº•ä¸å¥½åœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;/p&gt;

&lt;h3 id=&#34;ä¸ºä»€ä¹ˆå•ä¾‹ä¼šå¾ˆç³Ÿç³•&#34;&gt;ä¸ºä»€ä¹ˆå•ä¾‹ä¼šå¾ˆç³Ÿç³•ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;å½“è®¨è®ºç±»ä¼¼æ¨¡å¼å’Œæ¶æ„è¿™äº›ä¸œè¥¿çš„æ—¶å€™ï¼Œå¾ˆå®¹æ˜“é™·å…¥ä¸€ä¸ªç‰¹åˆ«ç†è®ºåŒ–çš„åœˆå¥—ã€‚è™½ç„¶è®©æˆ‘ä»¬çš„ä»£ç ç†è®ºä¸Šâ€œæ­£ç¡®â€ï¼Œéµå¾ªæœ€ä½³å®è·µå’ŒåŸåˆ™æ˜¯å¾ˆç¾å¥½çš„ï¼Œä½†æ˜¯ç°å®ç»å¸¸ä¼šå¾ˆå—æ‰“å‡»ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€äº›ä¸­é—´æ–¹æ¡ˆã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œå…³äºå•ä¾‹å¼•èµ·çš„å®è´¨æ€§é—®é¢˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿä¸ºä»€ä¹ˆå®ƒä»¬è¦åº”è¯¥è¢«é¿å…å‘¢ï¼Ÿè¿™é‡Œæˆ‘å€¾å‘äºä¸‰ä¸ªåŸå› ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;è¿™äº›å•ä¾‹æ˜¯å…¨å±€çš„å¯å˜çš„å…±äº«çŠ¶æ€ã€‚å®ƒä»¬çš„çŠ¶æ€æ˜¯åœ¨æ•´ä¸ª App é‡Œè‡ªåŠ¨å…±äº«çš„ï¼Œå› æ­¤å½“å…¶çŠ¶æ€å‘ç”Ÿä¸å¯é¢„æœŸçš„å˜åŒ–çš„æ—¶å€™ï¼ŒBug ä¹Ÿå°±å¯èƒ½å¼€å§‹å‘ç”Ÿäº†ï¼›&lt;/li&gt;
&lt;li&gt;å•ä¾‹ä¹‹é—´çš„å…³ç³»ä»¥åŠä¾èµ–è¿™äº›å•ä¾‹çš„ä»£ç å¸¸å¸¸ä¸é‚£ä¹ˆå¥½å®šä¹‰ã€‚å› ä¸ºå•ä¾‹æ˜¯å¦‚æ­¤æ–¹ä¾¿å’Œå®¹æ˜“è·å¾—ï¼Œå¤§é‡çš„ä½¿ç”¨å®ƒä»¬å¸¸å¸¸ä¼šå¯¼è‡´å¾ˆéš¾ç»´æŠ¤&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E9%9D%A2%E6%9D%A1%E5%BC%8F%E4%BB%A3%E7%A0%81&#34;&gt;é¢æ¡å¼ä»£ç &lt;/a&gt;ï¼Œè¿™äº›ä»£ç ä¸­å¯¹è±¡å’Œå¯¹è±¡ä¹‹é—´æ²¡æœ‰æ¸…æ™°çš„éš”ç¦»ï¼›&lt;/li&gt;
&lt;li&gt;ç®¡ç†è¿™äº›å•ä¾‹çš„ç”Ÿå‘½å‘¨æœŸéå¸¸çš„éš¾ã€‚å› ä¸ºå•ä¾‹æœ¬èº«ä¼šåœ¨åº”ç”¨çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…å­˜æ´»ï¼Œç®¡ç†å®ƒä»¬å°±å˜å¾—å¼‚å¸¸å›°éš¾ï¼Œå› æ­¤å¸¸å¸¸ä¼šä¸å¾—ä¸ä¾èµ–å¯é€‰å€¼æ¥è·Ÿè¸ªå€¼çš„å˜åŒ–ã€‚è¿™ä¹Ÿä½¿å¾—ä¾èµ–å•ä¾‹çš„ä»£ç å˜å¾—å¾ˆéš¾æµ‹è¯•ï¼Œå› ä¸ºä½ æ²¡æ³•åœ¨ä¸€ä¸ªæµ‹è¯• case é‡ŒæŠŠçŠ¶æ€é‡ç½®ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;åœ¨æˆ‘ä»¬å‰é¢çš„ &lt;strong&gt;ProfileViewController&lt;/strong&gt; çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†æœ‰è¿™ä¸‰ä¸ªé—®é¢˜çš„ä¿¡å·å‡ºç°ã€‚é¦–å…ˆå®ƒä¾èµ– UserManager å¯¼è‡´è¿™äºŒè€…å…³ç³»å¾ˆä¸æ¸…æ™°ï¼Œå…¶æ¬¡ï¼Œå®ƒä¸å¾—ä¸è®© currentUser ä½œä¸ºå¯é€‰å€¼å‡ºç°ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡åŠæ³•åœ¨ç¼–è¯‘æœŸå°±èƒ½å¤Ÿç¡®å®šè§†å›¾æ§åˆ¶å™¨å®é™…ä¸Šå‡ºç°çš„æ—¶å€™è¿™ä¸ªæ•°æ®ä¸€å®šåœ¨ã€‚å¬èµ·æ¥å°±æ„Ÿè§‰è¦æœ‰ bug å‘ç”Ÿçš„æ„Ÿè§‰ ğŸ˜¬!&lt;/p&gt;

&lt;h3 id=&#34;ä¾èµ–æ³¨å…¥&#34;&gt;ä¾èµ–æ³¨å…¥&lt;/h3&gt;

&lt;p&gt;ç›¸å¯¹äºä½¿ç”¨ &lt;strong&gt;ProfileViewController&lt;/strong&gt; é€šè¿‡å•ä¾‹æ¥è·å–å®ƒæ‰€éœ€çš„ä¾èµ–é¡¹ï¼Œæˆ‘ä»¬è¦åœ¨å…¶åˆå§‹åŒ–æ–¹æ³•ä¸­å°†ä¾èµ–é¡¹ä¼ å…¥ã€‚è¿™é‡Œæˆ‘ä»¬æ˜¯å°†å½“å‰çš„ User ä½œä¸ºéå¯é€‰ä¼ å…¥çš„ï¼ŒåŒæ ·ï¼Œä¼ å…¥ä¸€ä¸ª &lt;strong&gt;LogOutService&lt;/strong&gt; æ¥è¿›è¡Œç™»å‡ºæ“ä½œï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class ProfileViewController: UIViewController {
    private let user: User
    private let logOutService: LogOutService
    private lazy var nameLabel = UILabel()
    init(user: User, logOutService: LogOutService) {
        self.user = user
        self.logOutService = logOutService
        super.init(nibName: nil, bundle: nil)
    }
    override func viewDidLoad() {
        super.viewDidLoad()
        nameLabel.text = user.name
    }
    private func handleLogOutButtonTap() {
        logOutService.logOut()
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·çš„è¯ï¼Œä»£ç å°±ä¼šå˜å¾—æ›´åŠ æ¸…æ™°ï¼Œå¹¶ä¸”å®¹æ˜“ç®¡ç†ã€‚æˆ‘ä»¬çš„ä»£ç ç°åœ¨å®‰å…¨çš„ä¾èµ–å…¶ Modelï¼Œå¹¶ä¸”æœ‰ä¸€ä¸ªæ¸…æ™°çš„ API è¿›è¡Œç™»å‡ºçš„äº¤äº’ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå°†å„ç§å•ä¾‹ä»¥åŠç®¡ç†å™¨é‡æ„æˆæ¸…æ™°åˆ†ç¦»çš„æœåŠ¡èƒ½å¤Ÿä½¿å¾—ä¸€ä¸ª App çš„æ ¸å¿ƒå¯¹è±¡ä¹‹é—´çš„å…³ç³»æ›´åŠ æ¸…æ™°ã€‚&lt;/p&gt;

&lt;h3 id=&#34;services&#34;&gt;Services&lt;/h3&gt;

&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œè®©æˆ‘ä»¬æ›´è¿‘ä¸€äº›æ¥çœ‹ä¸‹ &lt;strong&gt;LogOutService&lt;/strong&gt; è¿™ä¸ªç±»æ˜¯å¦‚ä½•å®ç°çš„ã€‚å®ƒå†…éƒ¨ä¹Ÿå¯¹å…¶ä¾èµ–çš„æœåŠ¡ä½¿ç”¨äº†ä¾èµ–æ³¨å…¥ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªä¼˜é›…çš„ï¼Œå®šä¹‰æ¸…æ™°çš„ API æ¥åªåšä¸€ä»¶äº‹æƒ… â”€â”€ ç™»å‡ºã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class LogOutService {
    private let user: User
    private let networkService: NetworkService
    private let navigationService: NavigationService
    init(user: User,
         networkService: NetworkService,
         navigationService: NavigationService) {
        self.user = user
        self.networkService = networkService
        self.navigationService = navigationService
    }
    func logOut() {
        networkService.request(.logout(user)) { [weak self] in
            self?.navigationService.showLoginScreen()
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;ç¿»æ–°&#34;&gt;ç¿»æ–°&lt;/h3&gt;

&lt;p&gt;ä»ä¸€ä¸ªé‡åº¦ä½¿ç”¨å•ä¾‹çš„è®¾ç½®åˆ°å®Œå…¨ä½¿ç”¨æœåŠ¡ï¼Œä¾èµ–æ³¨å…¥ä»¥åŠæœ¬åœ°çŠ¶æ€æ¥æ”¹é€ ä¼šéå¸¸çš„å›°éš¾ï¼Œä¼šèŠ±è´¹å¤§é‡æ—¶é—´ã€‚è€Œä¸”ï¼Œä¼šå¾ˆéš¾è®¤ä¸ºèŠ±å¤§é‡æ—¶é—´åœ¨è¿™ä¸Šé¢æ˜¯åˆç†çš„ï¼Œè€Œä¸”æœ‰äº›æ—¶å€™å¯èƒ½ä¼šéœ€è¦ä¸€æ¬¡æ›´å¤§è§„æ¨¡çš„é‡æ„æ‰è¡Œã€‚&lt;/p&gt;

&lt;p&gt;è°¢å¤©è°¢åœ°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç›¸è¿‘çš„æŠ€æœ¯ï¼Œåœ¨&lt;a href=&#34;https://www.swiftbysundell.com/posts/testing-swift-code-that-uses-system-singletons-in-3-easy-steps&#34;&gt;Testing Swift code that uses system singletons in 3 easy steps&lt;/a&gt;è¿™ç¯‡æ–‡ç« ä¸­ä¹Ÿä½¿ç”¨åˆ°è¿‡ï¼Œå…¶å…è®¸æˆ‘ä»¬å¯ä»¥ä»¥ä¸€ç§éå¸¸å®¹æ˜“çš„æ–¹å¼å•ä¾‹å¼€å§‹ã€‚å’Œå¾ˆå¤šå…¶ä»–è§£å†³æ–¹æ¡ˆç±»ä¼¼ â”€â”€ åè®®æ¥æ•‘åœºï¼&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¸æ˜¯ä¸€æ¬¡æ€§é‡æ„æ‰€æœ‰çš„å•ä¾‹ï¼Œè€Œæ˜¯åˆ›å»º Service ç±»ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„æŠŠæˆ‘ä»¬çš„ Service å®šä¹‰æˆ Protocolï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
protocol LogOutService {
    func logOut()
}
protocol NetworkService {
    func request(_ endpoint: Endpoint, completionHandler: @escaping () -&amp;gt; Void)
}
protocol NavigationService {
    func showLoginScreen()
    func showProfile(for user: User)
    ...
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬å°±èƒ½é€šè¿‡å°†å•ä¾‹ç¬¦åˆæˆ‘ä»¬æ–°åˆ›å»ºçš„ Service åè®®æ¥ä½¿å…¶ç¿»æ–°ä¸ºä¸€å † Serviceã€‚åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç”šè‡³ä¸éœ€è¦æ”¹å˜ä»»ä½•å®ç°ï¼Œåªæ˜¯ç®€å•çš„ä¼ é€’å®ƒä»¬ shared å®ä¾‹ä½œä¸ºä¸€ä¸ª Service å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;åŒæ ·çš„æŠ€å·§ä¹Ÿèƒ½å¤Ÿè¢«ç”¨ä½œé‡æ„æˆ‘ä»¬ app ä¸­å…¶ä»–æ ¸å¿ƒå¯¹è±¡ï¼Œé‚£äº›å¯¹è±¡æˆ‘ä»¬ä¹Ÿè®¸ä¹Ÿéƒ½æ­£åœ¨ä»¥æŸç§å•ä¾‹å½¢å¼åœ¨ä½¿ç”¨ç€ï¼Œä¾‹å¦‚ä½¿ç”¨ AppDelegate æ¥åšå¯¼èˆªã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
extension UserManager: LoginService, LogOutService {}
extension AppDelegate: NavigationService {
    func showLoginScreen() {
        navigationController.viewControllers = [
            LoginViewController(
                loginService: UserManager.shared,
                navigationService: self
            )
        ]
    }
    func showProfile(for user: User) {
        let viewController = ProfileViewController(
            user: user,
            logOutService: UserManager.shared
        )
        navigationController.pushViewController(viewController, animated: true)
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬ç°åœ¨é€šè¿‡ä½¿ç”¨ä¾èµ–æ³¨å…¥ä»¥åŠ Service çš„æ–¹å¼ï¼Œå¼€å§‹ä½¿å¾—æˆ‘ä»¬å·¥ç¨‹å¤„åœ¨ Singleton free çš„çŠ¶æ€ï¼Œè€Œä¸éœ€è¦è¿›è¡Œç‰¹åˆ«å·¨å¤§çš„å·¥ç¨‹æ”¹é€ å’Œé‡å†™ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°±èƒ½å¤Ÿä½¿ç”¨ Service æˆ–è€…å…¶ä»–ç±»å‹çš„ API é€ä¸ªæ›¿æ¢æ‰å•ä¾‹ï¼Œæ¯”å¦‚è¯´ä½¿ç”¨&lt;a href=&#34;https://www.swiftbysundell.com/posts/replacing-legacy-code-using-swift-protocols&#34;&gt;è¿™ç¯‡åšæ–‡&lt;/a&gt;ä¸­çš„æŠ€å·§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h3&gt;

&lt;p&gt;å•ä¾‹ä¹Ÿä¸æ˜¯éƒ½æ˜¯ä¸å¥½çš„ï¼Œåªæ˜¯åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œå®ƒä»¬ä¼šå¼•å‘ä¸€ç³»åˆ—é—®é¢˜ï¼Œè¿™äº›é—®é¢˜å¯ä»¥é€šè¿‡ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æ–¹å¼ä¸ºä½ ç¨‹åºé‡Œçš„å¯¹è±¡å»ºç«‹è‰¯å¥½çš„å…³ç³»æ¥è§£å†³ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ ç°åœ¨æ­£åœ¨å¼€å‘çš„ App é‡Œåœ¨ä½¿ç”¨å¤§é‡çš„å•ä¾‹ï¼Œé‚£ä½ ä¸€å®šä¹Ÿåœ¨ç»å†æˆ–è€…å·²ç»ç»å†è¿‡å®ƒä»¬æ‰€å¸¦æ¥çš„ bug äº†å§ã€‚å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿç»™ä½ ä¸€äº›çµæ„Ÿè®©ä½ æ²¡æœ‰é‚£ä¹ˆæ…Œä¹±çš„å¼€å§‹è¿œç¦»å®ƒä»¬ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>Swift ä¸­å‡ ç§ä¸åŒçš„ä¾èµ–æ³¨å…¥æ–¹å¼</title>
      <link>https://hechen.xyz/post/different-flavors-of-dependency-injection-in-swift/</link>
      <pubDate>Mon, 16 Jul 2018 13:57:24 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/different-flavors-of-dependency-injection-in-swift/</guid>
      
        <description>

&lt;p&gt;åœ¨ä¹‹å‰çš„å‡ ç¯‡åšå®¢ä¸­ï¼Œæˆ‘ä»¬å·²ç»äº†è§£äº†å‡ ç§ä½¿ç”¨ä¾èµ–æ³¨å…¥æ–¹å¼ä½¿å¾—æŸä¸ª swift app æ‹¥æœ‰ä¸€ä¸ªæ›´åŠ è§£è€¦å¯æµ‹è¯•çš„æ¶æ„ã€‚æ¯”å¦‚åœ¨ &lt;a href=&#34;http://hechen.xyz/2017/11/19/Dependency-injection-using-factories-in-Swift/&#34;&gt;åœ¨ Swift ä¸­ä½¿ç”¨å·¥å‚æ¨¡å¼è¿›è¡Œä¾èµ–æ³¨å…¥&lt;/a&gt; ä¸­å’Œå·¥å‚æ¨¡å¼ç»“åˆï¼Œä»¥åŠåœ¨&lt;a href=&#34;http://hechen.xyz/2018/07/16/Avoiding-singletons-in-Swift/&#34;&gt;é¿å…åœ¨ Swift ä¸­ä½¿ç”¨å•ä¾‹&lt;/a&gt;ä¸­æ›¿æ¢ç¨‹åºä¸­çš„å•ä¾‹å¯¹è±¡ç­‰æ–¹å¼è¿›è¡Œä¾èµ–æ³¨å…¥ã€‚&lt;/p&gt;

&lt;p&gt;åˆ°ç›®å‰ä¸ºæ­¢ï¼Œå¤§éƒ¨åˆ†æˆ‘çš„åšæ–‡ä»¥åŠä¾‹å­ä¸­éƒ½ä½¿ç”¨äº†åŸºäºåˆå§‹åŒ–çš„ä¾èµ–æ³¨å…¥æ–¹å¼ã€‚ç„¶è€Œï¼Œå°±åƒå¤§éƒ¨åˆ†çš„ç¼–ç¨‹æŠ€å·§ä¸€æ ·ï¼Œè¿˜æœ‰å¾ˆå¤š â€œå£å‘³â€ çš„è¿›è¡Œä¾èµ–æ³¨å…¥çš„æ–¹å¼ â”€â”€ æ¯ä¸€ç§éƒ½æœ‰å…¶ä¼˜ç¼ºç‚¹ã€‚ è¿™å‘¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹çœ‹å…¶ä¸­ä¸‰ç§æ–¹å¼ä»¥åŠå¦‚ä½•åœ¨ Swift ä¸­ä½¿ç”¨å®ƒä»¬ã€‚&lt;/p&gt;

&lt;h3 id=&#34;åŸºäºåˆå§‹åŒ–æ–¹æ³•&#34;&gt;åŸºäºåˆå§‹åŒ–æ–¹æ³•&lt;/h3&gt;

&lt;p&gt;è®©æˆ‘ä»¬å¿«é€Ÿå›é¡¾ä¸€ä¸‹ç”¨çš„æœ€ä¸ºå¹¿æ³›çš„ä¾èµ–æ³¨å…¥æ–¹å¼ â”€â”€ initializer-basedã€‚è¿™ä¸ªæƒ³æ³•æ˜¯åœ¨æŸä¸ªç±»è¢«åˆå§‹åŒ–çš„æ—¶å€™ä¼ å…¥å…¶æ‰€éœ€çš„ä¾èµ–çš„æ–¹å¼ã€‚è¿™ç§å½¢å¼æœ€å¤§çš„å¥½å¤„å°±æ˜¯ï¼Œå®ƒä¿è¯äº†èƒ½å¤Ÿç«‹å³æ»¡è¶³è¯¥ç±»å®Œæˆå…¶åŠŸèƒ½æ‰€éœ€è¦çš„æ‰€æœ‰ä¸œè¥¿ã€‚&lt;/p&gt;

&lt;p&gt;è®©æˆ‘ä»¬å»ºä¸€ä¸ªç±» â”€â”€ FileLoader æ¥ä»ç£ç›˜åŠ è½½æ–‡ä»¶ã€‚ä¸ºäº†å®ç°è¯¥ Loader çš„åŠŸèƒ½ï¼Œéœ€è¦ä¸¤ä¸ªä¾èµ–é¡¹ï¼Œç³»ç»Ÿæ‰€æä¾›çš„å®ä¾‹å¯¹è±¡ â”€â”€ &lt;strong&gt;FileManager&lt;/strong&gt; å’Œ &lt;strong&gt;Cache&lt;/strong&gt;ã€‚ä½¿ç”¨åŸºäºåˆå§‹åŒ–çš„ä¾èµ–æ³¨å…¥çš„æ‰§è¡Œä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class FileLoader {
    private let fileManager: FileManager
    private let cache: Cache

    init(fileManager: FileManager = .default,
         cache: Cache = .init()) {
        self.fileManager = fileManager
        self.cache = cache
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯ä»¥å…³æ³¨ä¸‹åˆå§‹åŒ–æ–¹æ³•é‡Œé»˜è®¤å‚æ•°çš„è®¾ç½®ï¼Œå…¶å¯ä»¥é¿å…æ¯æ¬¡éƒ½éœ€è¦è‡ªè¡Œåˆ›å»ºçš„é—®é¢˜ã€‚è¿™æ ·èƒ½å¤Ÿç®€åŒ–æˆ‘ä»¬åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨ &lt;strong&gt;FileLoader&lt;/strong&gt; ç±»åˆ›å»ºæ–‡ä»¶åŠ è½½å™¨çš„å·¥ä½œï¼Œè€Œä¸”ä¹Ÿèƒ½å¤Ÿèƒ½å¤Ÿä¼ å…¥ mock æ•°æ®æˆ–è€…æˆ‘ä»¬çš„æµ‹è¯•ä»£ç ä¸­çš„åˆ›å»ºçš„å®ä¾‹è¿›è¡Œæµ‹è¯•ã€‚&lt;/p&gt;

&lt;h3 id=&#34;åŸºäºå±æ€§&#34;&gt;åŸºäºå±æ€§&lt;/h3&gt;

&lt;p&gt;è™½ç„¶å‰ä¸€ç§åŸºäºåˆå§‹åŒ–çš„ä¾èµ–æ³¨å…¥å½¢å¼å¸¸å¸¸ç»™æˆ‘ä»¬è‡ªå®šä¹‰ç±»å¸¦æ¥å¾ˆå¤šå¥½å¤„ï¼Œä½†æ˜¯æœ‰æ—¶å€™ï¼Œå½“ä½ ä¸å¾—ä¸ç»§æ‰¿è‡ªæŸä¸ªç³»ç»Ÿç±»çš„æ—¶å€™ä¼šé‡åˆ°ä¸€äº›å›°éš¾ã€‚å…¶ä¸­ä¸€ä¸ªä¾‹å­å°±æ˜¯ï¼Œå½“æˆ‘ä»¬æ„å»º view controllerï¼Œå°¤å…¶æ˜¯ä½ åœ¨ä½¿ç”¨ XIB ä»¥åŠ Storyboard ç±»å®šä¹‰å®ƒä»¬çš„æ—¶å€™ï¼Œå› ä¸ºæ­¤æ—¶ä½ ä¸å†èƒ½å¤ŸæŒæ§å®ƒä»¬çš„åˆå§‹åŒ–æ–¹æ³•äº†ã€‚&lt;/p&gt;

&lt;p&gt;å¯¹äºè¿™äº›æƒ…å†µï¼ŒåŸºäºå±æ€§çš„ä¾èµ–æ³¨å…¥æ–¹å¼æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ã€‚ç›¸å¯¹äºåˆå§‹åŒ–çš„æ—¶å€™è¿›è¡Œå¯¹è±¡çš„ä¾èµ–é¡¹æ³¨å…¥ï¼ŒåŸºäºå±æ€§çš„å½¢å¼å¯ä»¥åœ¨ä¹‹åé€šè¿‡ç®€å•çš„èµ‹å€¼æ¥åšåˆ°ï¼Œå…¶èƒ½å¤Ÿè®©ä½ å‡å°‘æ¨¡æ¿ä»£ç çš„ä¹¦å†™ï¼Œå°¤å…¶æ˜¯åœ¨ä½ ç¡®å®æ²¡æœ‰å¿…è¦è¿›è¡Œæ³¨å…¥çš„æ—¶å€™èƒ½å¤Ÿæœ‰æ›´å¥½çš„é»˜è®¤å®ç°ã€‚&lt;/p&gt;

&lt;p&gt;è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸ªä¾‹å­ï¼Œåœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬åœ¨æ„å»ºä¸€ä¸ª &lt;strong&gt;PhotoEditorViewController&lt;/strong&gt; ï¼Œè¿™ä¸ªè§†å›¾æ§åˆ¶å™¨ä½¿å¾—ç”¨æˆ·ç¼–è¾‘å®ƒä»¬ç…§ç‰‡åº“ä¸­çš„å›¾ç‰‡ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªåŠŸèƒ½ï¼Œè¯¥è§†å›¾æ§åˆ¶å™¨éœ€è¦ç”¨åˆ°ç³»ç»Ÿæä¾›çš„ PHPhotoLibrary ç±»å‹çš„ä¸€ä¸ªå®ä¾‹ï¼ˆè¯¥ç±»æœ¬èº«æ˜¯ä¸€ä¸ªå•ä¾‹ï¼‰ä»¥åŠæˆ‘ä»¬è‡ªå·±å®ç°çš„ç±» &lt;strong&gt;PhotoEditorEngine&lt;/strong&gt; çš„ä¸€ä¸ªå®ä¾‹ã€‚é‚£ä¸ºäº†ä¸é€šè¿‡è‡ªå®šä¹‰åˆå§‹åŒ–æ–¹æ³•è¿›è¡Œä¾èµ–æ³¨å…¥çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€äº›å…·æœ‰é»˜è®¤å€¼çš„å¯å˜å±æ€§ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class PhotoEditorViewController: UIViewController {
    var library: PhotoLibrary = PHPhotoLibrary.shared()
    var engine = PhotoEditorEngine()
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½¿ç”¨ &lt;a href=&#34;https://www.swiftbysundell.com/posts/testing-swift-code-that-uses-system-singletons-in-3-easy-steps&#34;&gt;Testing Swift code that uses system singletons in 3 easy steps&lt;/a&gt; è¿™ç¯‡æ–‡ç« ä¸­çš„æ‰‹æ³•ï¼Œé€šè¿‡ä½¿ç”¨ä¸€ä¸ªåè®®æä¾›ä¸€ä¸ªæ›´ä¸ºæŠ½è±¡çš„ &lt;strong&gt;PhotoLibrary&lt;/strong&gt; æ¥å£æ¥è·å–ç³»ç»Ÿçš„å›¾ç‰‡åº“ã€‚è¿™æ ·ä¼šä½¿å¾—æµ‹è¯•å’Œ Mock æ•°æ®ç‰¹åˆ«çš„å®¹æ˜“ã€‚&lt;/p&gt;

&lt;p&gt;ä¸Šé¢è¿™äº›å·¥ä½œæ¯”è¾ƒå¥½çš„æ˜¯æˆ‘ä»¬ä¾ç„¶èƒ½å¤Ÿé€šè¿‡ç®€å•çš„ç»™è§†å›¾æ§åˆ¶å™¨æ¥èµ‹å€¼ï¼Œä»è€Œåœ¨æˆ‘ä»¬çš„æµ‹è¯•ä¸­ç®€å•çš„æ³¨å…¥ Mock ä»£ç ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class PhotoEditorViewControllerTests: XCTestCase {
    func testApplyingBlackAndWhiteFilter() {
        let viewController = PhotoEditorViewController()

        // Assign a mock photo library to gain complete control over
        // what photos are stored in it
        let library = PhotoLibraryMock()
        library.photos = [TestPhotoFactory.photoWithColor(.red)]
        viewController.library = library

        // Run our testing commands
        viewController.selectPhoto(atIndex: 0)
        viewController.apply(filter: .blackAndWhite)
        viewController.savePhoto()

        // Assert that the outcome is correct
        XCTAssertTrue(photoIsBlackAndWhite(library.photos[0]))
    }   
}

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;åŸºäºå‚æ•°&#34;&gt;åŸºäºå‚æ•°&lt;/h3&gt;

&lt;p&gt;æœ€åä¸€ç§ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸‹åŸºäºå‚æ•°çš„ä¾èµ–æ³¨å…¥å½¢å¼ã€‚è¿™ç§æ–¹å¼å°¤å…¶åœ¨ä½ æƒ³è®©æ—§æœ‰ä»£ç æ›´åŠ å¯æµ‹è¯•ï¼Œè€Œä¸éœ€è¦å¯¹ç°å­˜çš„ç»“æ„è¿›è¡Œæ›´å¤šæ”¹åŠ¨çš„æ—¶å€™å°¤å…¶æœ‰æ•ˆã€‚&lt;/p&gt;

&lt;p&gt;è®¸å¤šæ—¶å€™ï¼Œæˆ‘ä»¬ä»…éœ€è¦æŸä¸ªç‰¹å®šçš„ä¾èµ–é¡¹ä¸€æ¬¡ï¼Œæˆ–è€…æˆ‘ä»¬ä»…ä»…éœ€è¦åœ¨æŸäº›ç‰¹å®šæ¡ä»¶ä¸‹è¿›è¡Œ mockã€‚ä¸éœ€è¦æ”¹å˜æŸä¸ªå¯¹è±¡çš„åˆå§‹åŒ–æ–¹æ³•æˆ–è€…æš´éœ²å¯å˜å±æ€§ï¼ˆé€šå¸¸éƒ½ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å‘å‡ºä¸€ä¸ªæ¥å—ä¸€ä¸ªä¾èµ–é¡¹ä½œä¸ºå‚æ•°çš„ç‰¹å®š APIã€‚&lt;/p&gt;

&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸ª &lt;strong&gt;NoteManager&lt;/strong&gt; ç±»ï¼Œè¯¥ç±»æ˜¯æŸä¸ªç¬”è®°ç±»åº”ç”¨çš„ä¸€éƒ¨åˆ†ã€‚å®ƒçš„å·¥ä½œå°±æ˜¯ç®¡ç†æ‰€æœ‰ç”¨æˆ·å·²ç»ä¹¦å†™çš„ç¬”è®°ï¼Œæä¾›ä¸€ä¸ª API è®©ç”¨æˆ·èƒ½å¤ŸæŸ¥è¯¢ç¬”è®°ã€‚è€ƒè™‘åˆ°è¿™ä¸ªæ“ä½œå¯èƒ½è€—æ—¶ï¼ˆå¦‚æœç”¨æˆ·æœ‰è®¸å¤šç¬”è®°ï¼Œé€šå¸¸æƒ…å†µä¸‹æ˜¯è¿™æ ·ï¼‰ï¼Œæˆ‘ä»¬æŠŠè¯¥åŠ¨ä½œæ­£å¸¸æ”¾ç½®äºä¸€ä¸ªåå°çº¿ç¨‹æ‰§è¡Œï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class NoteManager {
    func loadNotes(matching query: String,
                   completionHandler: @escaping ([Note]) -&amp;gt; Void) {
        DispatchQueue.global(qos: .userInitiated).async {
            let database = self.loadDatabase()
            let notes = database.filter { note in
                return note.matches(query: query)
            }

            completionHandler(notes)
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å°½ç®¡ä¸Šé¢çš„ä»£ç åœ¨æˆ‘ä»¬çš„ç”Ÿäº§ç¯å¢ƒé‡Œä¹Ÿç®—æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œä½†åœ¨æµ‹è¯•ä¸­æˆ‘ä»¬æ­£å¸¸æƒ…å†µä¸‹æ˜¯æƒ³é¿å…ä¸€äº›å¼‚æ­¥ä»£ç çš„ï¼Œå°½å¯èƒ½çš„å¹³è¡ŒåŒ–ä»¥é¿å… &lt;a href=&#34;https://www.swiftbysundell.com/posts/reducing-flakiness-in-swift-tests&#34;&gt;flakiness&lt;/a&gt;. å¦‚æœè¦ç±»ä¼¼äºåŸºäºåˆå§‹åŒ–æˆ–è€…åŸºäºå±æ€§çš„ä¾èµ–æ³¨å…¥èƒ½å¤ŸæŒ‡å®šä¸€ä¸ªæ˜¾å¼çš„é˜Ÿåˆ—æä¾›ç»™ NoteManager æ¥ç”¨çš„æ–¹å¼ï¼Œéœ€è¦å¯¹è¯¥ç±»è¿›è¡Œå¾ˆå¤šæ”¹å˜ï¼Œè¿™æ˜¯æˆ‘ä»¬åœ¨å½“ä¸‹æ— æ³•åšæˆ–è€…ä¸æ„¿æ„åšçš„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ—¶å€™ï¼ŒåŸºäºå‚æ•°çš„ä¾èµ–æ³¨å…¥æ–¹å¼çš„å®ç°å°±èƒ½å¤Ÿè¾¾åˆ°ã€‚ç›¸å¯¹äºä¸å¾—ä¸å¯¹æ•´ä¸ªç±»è¿›è¡Œé‡æ„ï¼Œæˆ‘ä»¬é€šè¿‡æ’å…¥é˜Ÿåˆ—ç›¸å…³ä»£ç ä½¿å¾— &lt;code&gt;loadNotes&lt;/code&gt; æ–¹æ³•åœ¨è¯¥é˜Ÿåˆ—ä¸Šæ‰§è¡Œï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class NoteManager {
    func loadNotes(matching query: String,
                   on queue: DispatchQueue = .global(qos: .userInitiated),
                   completionHandler: @escaping ([Note]) -&amp;gt; Void) {
        queue.async {
            let database = self.loadDatabase()
            let notes = database.filter { note in
                return note.matches(query: query)
            }

            completionHandler(notes)
        }
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·å°±ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿå¾ˆå®¹æ˜“çš„åœ¨æµ‹è¯•ä»£ç ä¸­ä½¿ç”¨æŸä¸ªå®šåˆ¶çš„æˆ‘ä»¬å¯ç­‰å¾…çš„é˜Ÿåˆ—ã€‚è¿™æ ·ä¹Ÿå‡ ä¹ä½¿å¾—æˆ‘ä»¬æŠŠä¸Šé¢çš„æ¥å£è½¬å˜æˆäº†ä¸€ä¸ªåŒæ­¥æ¥å£ï¼Œä½¿å¾—ä¸€åˆ‡å˜å¾—æ›´åŠ å®¹æ˜“å’Œå¯é¢„æµ‹ã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–ä¸€ä¸ªåŸºäºå‚æ•°çš„ä¾èµ–æ³¨å…¥çš„ä½¿ç”¨æ¡ˆä¾‹æ˜¯å½“ä½ æƒ³æµ‹è¯•æŸä¸ªé™æ€çš„ API çš„æ—¶å€™ã€‚å› ä¸ºé™æ€çš„ API æˆ‘ä»¬æ˜¯ä¸å­˜åœ¨åˆå§‹åŒ–æ–¹æ³•çš„ï¼ŒåŒæ—¶æˆ‘ä»¬ç†æƒ³æƒ…å†µä¸‹ä¹Ÿæ˜¯ä¸åº”è¯¥ç»´æŠ¤ä»»ä½•é™æ€çš„çŠ¶æ€çš„ï¼Œé‚£åŸºäºå‚æ•°çš„ä¾èµ–æ³¨å…¥æ–¹å¼å°±æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªé™æ€çš„ç±» &lt;strong&gt;MessageSender&lt;/strong&gt;ï¼Œ è¯¥ç±»å½“å‰ä¾èµ–æŸä¸ªå•ä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class MessageSender {
    static func send(_ message: Message, to user: User) throws {
        Database.shared.insert(message)

        let data: Data = try wrap(message)
        let endpoint = Endpoint.sendMessage(to: user)
        NetworkManager.shared.post(data, to: endpoint.url)
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“ç„¶ï¼Œä¸€ä¸ªé•¿è¿œçš„è§£å†³æ–¹æ¡ˆæ›´å¯èƒ½æ˜¯é‡æ„ &lt;strong&gt;MessageSender&lt;/strong&gt; è¿™ä¸ªç±»ï¼Œè®©å®ƒå˜æˆä¸€ä¸ªéé™æ€çš„ï¼Œèƒ½å¤Ÿåœ¨å…¶æ‰€æœ‰è¢«ä½¿ç”¨çš„åœ°æ–¹è¢«æ­£ç¡®çš„æ³¨å…¥ä¾èµ–ã€‚ä½†æ˜¯åŸºäºæˆ‘ä»¬èƒ½å¤Ÿæ›´å®¹æ˜“çš„æµ‹è¯•å®ƒï¼ˆæ¯”å¦‚ï¼Œé‡ç°æˆ–è€…éªŒè¯æŸä¸ª Bugï¼‰ï¼Œæˆ‘ä»¬èƒ½ç®€å•çš„ä½¿ç”¨å‚æ•°ä½œä¸ºä¾èµ–é¡¹è¿›è¡Œæ³¨å…¥ï¼Œè€Œä¸æ˜¯åŸºäºæŸä¸ªå•ä¾‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
class MessageSender {
    static func send(_ message: Message,
                     to user: User,
                     database: Database = .shared,
                     networkManager: NetworkManager = .shared) throws {
        database.insert(message)

        let data: Data = try wrap(message)
        let endpoint = Endpoint.sendMessage(to: user)
        networkManager.post(data, to: endpoint.url)
    }
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬åˆå†æ¬¡ä½¿ç”¨äº†ç¼ºçœçš„å‚æ•°ï¼Œä¸ä»…ä»…æ›´åŠ æ–¹ä¾¿è€Œå·²ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œèƒ½å¤Ÿåœ¨ 100% å‘åå…¼å®¹çš„æƒ…å†µä¸‹ä¸ºæˆ‘ä»¬çš„ä»£ç å¢åŠ æµ‹è¯•æ”¯æŒã€‚&lt;/p&gt;

&lt;h2 id=&#34;ç»“è®º&#34;&gt;ç»“è®º&lt;/h2&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œå“ªä¸€ç§ä¾èµ–æ³¨å…¥çš„æ–¹æ¡ˆæ˜¯æœ€å¥½çš„å‘¢ï¼Ÿå°±åƒå¤§éƒ¨åˆ†æ—¶å€™ä¸€æ ·ï¼Œæˆ‘çš„ç­”æ¡ˆå¾ˆæ— èŠçš„ï¼š çœ‹æƒ…å†µï¼æˆ‘åœ¨è¯¥åšå®¢ä¸­æ‰€è§†å›¾å»åšçš„ä¸€ä»¶äº‹æƒ…å°±æ˜¯é’ˆå¯¹æŸä¸ªç‰¹å®šé—®é¢˜ç»™å‡ºéœ€è¦ä¸åŒçš„è§£å†³æ–¹æ¡ˆã€‚åŸå› å¾ˆç®€å•ï¼Œæˆ‘çœŸçš„ä¸ç›¸ä¿¡åˆæ‰€è°“é“¶å¼¹çš„å­˜åœ¨ã€‚æˆ‘è®¤ä¸ºï¼ŒæŒ‰ç…§æˆ‘ä»¬æ„æ„¿å…·å¤‡å¤šä¸ªå·¥å…·æˆ–è€…å¯¹äºç‰¹å®šæŠ€å·§çš„å¤šç§è§£å†³æ–¹æ¡ˆèƒ½å¤Ÿä½¿æˆ‘ä»¬å˜å¾—æ›´å¥½ï¼Œåœ¨å†™ä»£ç çš„æ—¶å€™ä¹Ÿèƒ½å¤Ÿæ¸¸åˆƒæœ‰ä½™ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>é‚£äº›æˆ‘æ¢å¤ Mac ç³»ç»Ÿä¹‹åè¦å®‰è£…çš„ Apps</title>
      <link>https://hechen.xyz/post/my-favorite-mac-apps/</link>
      <pubDate>Wed, 11 Jul 2018 12:58:37 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/my-favorite-mac-apps/</guid>
      
        <description>

&lt;p&gt;è®°å½•ä¸€ä¸‹è‡ªå·±å¸¸ç”¨çš„ Mac Appsï¼Œæ¯æ¬¡é‡è£…ä¹‹ååˆ°äº†ç”¨çš„æ—¶å€™å‘ç°å¿˜è®°å®‰è£…äº†(ä¸æ˜¯æ¯æ¬¡éƒ½ç”¨ TimeMachine æ¢å¤)ï¼Œè€Œä¸”å¼ºçƒˆç®€æ˜“å¤§å®¶å¦‚æœæŸä¸ª App æœ‰å¯¹åº”çš„ç‹¬ç«‹å®‰è£…ç‰ˆæœ¬çš„è¯ï¼Œè´­ä¹°å…¶ç‹¬ç«‹å®‰è£…ç‰ˆæœ¬ä¸ºå¥½ï¼Œæ²™ç›’ç¯å¢ƒä»¥åŠå’Œ Apple ID ç»‘å®šçš„ç‰¹æ€§å°±ä½¿å¾—åŠŸèƒ½æ€§ä»¥åŠçµæ´»åº¦å¤§å‡ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;blockquote&gt;
&lt;p&gt;æ›´æ–°æ—¶é—´ 2018-10-07
æ›´æ¢å›¾åºŠï¼Œæ›´æ–°å›¾ç‰‡&lt;/p&gt;

&lt;p&gt;æ›´æ–°æ—¶é—´ 2018-08-10
ä¸ä¹…å‰ï¼Œå·²ç»è®¢é˜…äº†ä¸€å¹´çš„ Setappï¼Œå‘ç°ä¸Šé¢å¥½å¤š App è‡ªå·±éƒ½ä¹‹å‰ä¹°è¿‡äº†ï¼ŒSighï¼
å¦‚æœä½ ä½¿ç”¨ Ulysses æˆ–è€… MoneyWiz 3.0 çš„è¯ï¼Œè®¢é˜… Setapp å°±ä¼šéå¸¸çš„å€¼å¾—ï¼&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/q3yToeZ.png&#34; alt=&#34;Mac Apps&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;åŠå…¬å·¥å…·&#34;&gt;åŠå…¬å·¥å…·&lt;/h2&gt;

&lt;p&gt;ç¦»å¼€è¿™äº›å·¥å…·ï¼Œè²Œä¼¼æ— æ³•åŠå…¬çš„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;airmail&#34;&gt;AirMail&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/airmail-3/id918858936?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/19ADIxn.jpg&#34; alt=&#34;AirMai&#34; /&gt;&lt;/p&gt;

&lt;p&gt;é‚®ç®±å®¢æˆ·ç«¯ï¼Œçœ‹ä¸­ AirMail ä¸»è¦æ˜¯å› ä¸ºå…¶å¼ºå¤§çš„ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆã€‚&lt;/p&gt;

&lt;h3 id=&#34;slack&#34;&gt;Slack&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/slack/id803453959?mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/W1wtsje.jpg&#34; alt=&#34;Slack&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å…¬å¸çš„æ—¥å¸¸æ²Ÿé€šäº¤æµä¸»è¦æˆ˜åœºï¼Œå…¶å®æ•´ä¸ªæ“ä½œä½“éªŒæˆ‘æ˜¯ä¸å¤ªé€‚åº”çš„ï¼Œä¸è¿‡å®ƒå¼ºå¤§åœ¨ç¬¬ä¸‰æ–¹æœåŠ¡çš„é›†æˆä¸Šï¼Œå¯ä»¥åšå¾ˆå¤šè‡ªåŠ¨åŒ–çš„äº‹æƒ…ã€‚&lt;/p&gt;

&lt;h3 id=&#34;fantastical-2&#34;&gt;Fantastical 2&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://flexibits.com/fantastical&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/1naxpaM.jpg&#34; alt=&#34;Fantastical&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ—¥å†å·¥å…·ï¼ŒæŸ¥çœ‹æ»¡æ»¡çš„ä¸€å±å¹•æ—¥ç¨‹ï¼Œä½ ä¼šæ„Ÿè§‰å¾ˆèˆ’æœçš„ã€‚&lt;/p&gt;

&lt;h4 id=&#34;tunnelblick&#34;&gt;Tunnelblick&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://tunnelblick.net/downloads.html&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ghIEHNQ.png&#34; alt=&#34;Tunnelblick-menu&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å…¬å¸éœ€è¦ä½¿ç”¨è¯¥ App æ¥æ¥å…¥åŠå…¬å®¤ç½‘ç»œã€‚è¿œç¨‹åŠå…¬å¿…å¤‡ã€‚&lt;/p&gt;

&lt;h4 id=&#34;office-ä¸‰ä»¶å¥—&#34;&gt;Office ä¸‰ä»¶å¥—&lt;/h4&gt;

&lt;p&gt;å¾®è½¯çš„ Office ä¸‰ä»¶å¥—ï¼ŒWordï¼ŒExcelï¼ŒPowerPointã€‚ ç”¨çš„é¢‘ç‡ä¸é«˜ï¼Œä½†æ˜¯ç”¨çš„æ—¶å€™å¾—æœ‰ã€‚&lt;/p&gt;

&lt;h2 id=&#34;gtd&#34;&gt;GTD&lt;/h2&gt;

&lt;p&gt;æ—¥å¸¸ GTD å·¥å…·ï¼ŒåŸºæœ¬å°±æ˜¯å„å®¶è¯„æµ‹å¸¸æèµ·çš„å‡ æ¬¾ Appã€‚&lt;/p&gt;

&lt;h3 id=&#34;2do&#34;&gt;2Do&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://www.2doapp.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/st89Smb.jpg&#34; alt=&#34;2Do on Mac&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æœ€è¿‘æ‰å®Œå…¨è½¬å‘ 2Doï¼Œè¿™ä¸ª GTD å·¥å…·æ˜¯æˆ‘æœ€æ—©ä¹°å…¥çš„ï¼Œä½†æ˜¯åæ¥å› ä¸ºå…¶è‡ªåŠ¨åŒ–å¤ªå¼±ï¼Œè¢«æ‰“å…¥å†·å®«ã€‚æœ€è¿‘å‡ ä¸ªæœˆåˆå¼€å§‹æ¡èµ·æ¥äº†ï¼Œå¸å¼•æˆ‘çš„å‡ ä¸ªç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Colorful Tab&lt;/li&gt;
&lt;li&gt;Mail AutoCapture&lt;/li&gt;
&lt;li&gt;Smart List&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿˜æœ‰ä¸€ç‚¹å°±æ˜¯ï¼Œå…¶åŒæ­¥ç›®å‰ç¨³å®šçš„å°±åªèƒ½ä½¿ç”¨ Dropbox äº†ï¼Œåœ¨å›½å†…åŸºæœ¬å¯¹å¤§éƒ¨åˆ†äººå°±æ˜¯ä¸ªéšœç¢ã€‚&lt;/p&gt;

&lt;h3 id=&#34;things-3&#34;&gt;Things 3&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/5ifAVwf.jpg&#34; alt=&#34;Things3&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Things 2 ä¹‹å‰ä¹Ÿæœ‰ï¼Œä¸è¿‡å› ä¸ºåŠŸèƒ½å¤ªç®€å•ï¼ŒåŸºæœ¬å¤„äºä¹°äº†çœ‹çœ‹çš„çŠ¶æ€ï¼Œåæ¥ Things 3 çš„å‡ºç°ä¸»è¦çœ‹ä¸­å®ƒçš„è®¾è®¡å…ƒç´ ã€‚&lt;/p&gt;

&lt;h3 id=&#34;omnifocus-3&#34;&gt;OmniFocus 3&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/D72LM50.jpg&#34; alt=&#34;OmniFocus 3&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨å®ƒæœ€ä¸»è¦çš„åŸå› æ˜¯å®ƒæ”¯æŒ AppleScript æ¯”è¾ƒæ–¹ä¾¿ã€‚å°¤å…¶æ˜¯ç»“åˆ Keyboard Maestro æ¥ç”¨å¤ªæ–¹ä¾¿ã€‚æ¯”å¦‚æˆ‘ä¼šå»ºç«‹ä¸€äº›å®šæ—¶ä»»åŠ¡ï¼Œæ¯å‘¨äº”ä¸‹åˆä¸‹ç­å‰è‡ªåŠ¨ç”Ÿæˆä¸€å¼ å‘¨æŠ¥è¡¨å•ï¼Œåˆ—å‡ºæ¥æœ¬å‘¨å®Œæˆçš„ Task ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;æœ€è¿‘åˆšåˆä» 2 å‡çº§åˆ° 3 ä»£ï¼ŒåŠä»·æŠ˜æ‰£ 39.99$&lt;/p&gt;

&lt;p&gt;3 ä¸»è¦å°†ä¹‹å‰ Context æ›´æ¢ä¸ºæ”¯æŒå¤šå±æ€§çš„ Tagï¼Œä¹Ÿç®—è¡¥å……äº†ä¸€ä¸ªç«äº‰ç‚¹å§ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ç³»ç»Ÿå·¥å…·&#34;&gt;ç³»ç»Ÿå·¥å…·&lt;/h2&gt;

&lt;p&gt;åŸºæœ¬æ˜¯ç³»ç»Ÿç¼ºå°‘çš„æˆ–è€…åŠŸèƒ½éš¾ä»¥æ»¡è¶³æ—¥å¸¸ä½¿ç”¨çš„ä¸€äº› Appã€‚&lt;/p&gt;

&lt;h3 id=&#34;1-blocker&#34;&gt;1 Blocker&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/app/id1107421413&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/l3aGI1P.jpg&#34; alt=&#34;1 Blocker&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;istat-menus&#34;&gt;iStat Menus&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;http://download.bjango.com/istatmenus/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/PtO8FNP.jpg&#34; alt=&#34;iStat Menus&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;bartender-3&#34;&gt;Bartender 3&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://www.macbartender.com/Demo/Bartender%203.zip&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/EnE2fyQ.png&#34; alt=&#34;Bartender&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;surge&#34;&gt;Surge&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://nssurge.com/&#34;&gt;Surge&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æœ€è¿‘ Yachen Liu å‘å¸ƒäº† Surge 3 çš„ Mac ç‰ˆæœ¬é¢„è§ˆç‰ˆæœ¬&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/CNc6AIK.png&#34; alt=&#34;Surge 3&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å®è´¨ä¸Šæ˜¯ä¸ªç½‘ç»œè°ƒè¯•å·¥å…·ï¼Œä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹è¢«ç”¨æ¥ä½œä¸ºçˆ±å›½ä¸Šç½‘å·¥å…·äº†ã€‚ è€Œä¸”å®šä»·ç­–ç•¥ä¹Ÿæ˜¯å¼•å‘äº†å¾ˆå¤šå£æ°´æˆ˜ï¼Œä¸è¿‡å•†å“å˜›ï¼Œå¦‚æœä½ è§‰å¾—ä¸å€¼å°±ä¸ä¹°å°±è¡Œäº†ï¼Œä¸å¿…è¦æƒ³ç”¨è¿˜éª‚ä»–å®šä»·é«˜ï¼Œå¯¹å§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/gkhCynx.png&#34; alt=&#34;Surge Dashboard&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;wallpaper-wizard&#34;&gt;Wallpaper Wizard&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/wallpaper-wizard-2/id1266674560?mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/lYnieJQ.jpg&#34; alt=&#34;Wallpaper Wizard&#34; /&gt;&lt;/p&gt;

&lt;p&gt;MacPaw å®¶çš„å£çº¸åº”ç”¨ï¼Œé™æ—¶å…è´¹çš„æ—¶å€™å…¥çš„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;tinkertool&#34;&gt;TinkerTool&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://www.bresink.com/osx/TinkerTool.html&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/YqvFP1Y.png&#34; alt=&#34;TinkerTool&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªç³»ç»Ÿå¢å¼ºå·¥å…·ï¼Œå¯ä»¥å¯¹ Dashboard å’Œ Docker ç­‰è¿›è¡Œå®šåˆ¶åŒ–ä¿®æ”¹ã€‚&lt;/p&gt;

&lt;h3 id=&#34;capto&#34;&gt;Capto&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://www.globaldelight.com/capto/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/9QeUc6Z.jpg&#34; alt=&#34;Capto&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æˆªå±å’Œå½•åˆ¶è§†é¢‘å·¥å…·ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ•ˆç‡å·¥å…·&#34;&gt;æ•ˆç‡å·¥å…·&lt;/h2&gt;

&lt;h3 id=&#34;1password-7-for-mac&#34;&gt;1Password 7 for Mac&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://app-updates.agilebits.com/download/OPM7&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/Bb13IZD.jpg&#34; alt=&#34;1Password 7&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;alfred-3&#34;&gt;Alfred 3&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://cachefly.alfredapp.com/Alfred_3.6.2_922.dmg&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/WeFkSYh.jpg&#34; alt=&#34;Alfred&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;launchbar-6&#34;&gt;LaunchBar 6&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://www.obdev.at/products/launchbar/download.html&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/FVgOB3g.png&#34; alt=&#34;LaunchBar&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;bettertouchtool&#34;&gt;BetterTouchTool&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://bettertouchtool.net/releases/BetterTouchTool.zip&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/4RfNX0T.jpg&#34; alt=&#34;BetterTouchTool&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;keyboard-maestro&#34;&gt;Keyboard Maestro&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://www.keyboardmaestro.com/action/download?km-kmi-7-b3&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/IOZeiaH.png&#34; alt=&#34;Keyboard Maestro&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;yoink&#34;&gt;Yoink&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://eternalstorms.at/yoink/mac/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/oMcckyM.jpg&#34; alt=&#34;Yoink&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;unclutter&#34;&gt;Unclutter&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://unclutterapp.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/SunNE17.png&#34; alt=&#34;Unclutter&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;toothfairy&#34;&gt;ToothFairy&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/toothfairy/id1191449274?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/2crElmV.jpg&#34; alt=&#34;ToothFairy&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;popclip&#34;&gt;PopClip&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/popclip/id445189367?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/qytMbLT.jpg&#34; alt=&#34;PopClip&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;copied&#34;&gt;Copied&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://geo.itunes.apple.com/us/app/copied/id1026349850?ls=1&amp;amp;mt=12&amp;amp;at=1010l8Ju&amp;amp;ct=web&amp;amp;uo=8&amp;amp;at=1010l8Ju&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/hRW1Xoo.jpg&#34; alt=&#34;Copied&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸€æ¬¾å‰ªè´´æ¿å·¥å…·ï¼Œåº”è¯¥æ˜¯ç›®å‰ Mac ä¸Šæœ€å¼ºå¤§çš„å‰ªè´´æ¿å·¥å…·äº†ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å†™ä½œ&#34;&gt;å†™ä½œ&lt;/h2&gt;

&lt;h3 id=&#34;day-one&#34;&gt;Day One&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/day-one/id1055511498?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/fKmOZa9.jpg&#34; alt=&#34;Day One&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ—¥è®°åº”ç”¨ï¼Œä¹‹å‰ä¹°äº† iOS å’Œ Mac åŒç‰ˆæœ¬ï¼Œæ”¹æˆè®¢é˜…ä¹‹åè‡ªåŠ¨å‡çº§ä¸º Plus ä¼šå‘˜äº†ï¼ŒåŠŸèƒ½å·²ç»å®Œå…¨è¶³å¤Ÿã€‚æœ€è¿‘çš„ Premium ä¼šå‘˜å¢åŠ äº†éŸ³é¢‘æ—¥è®°ä»¥åŠ Dark Theme çš„ä¸»é¢˜äº†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ulysses&#34;&gt;Ulysses&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/ulysses/id1225570693?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/GBaAJW2.jpg&#34; alt=&#34;Ulysses&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è¿™ä¸ªå®Œå…¨æ˜¯å†²åŠ¨æ¶ˆè´¹ï¼Œå°±æ˜¯æƒ³çœ‹çœ‹å¤§å®¶æ§æ€è¿™ä¹ˆç‹ åˆ°åº•ä¼˜ç§€åœ¨å“ªé‡Œï¼Œè¯´å®è¯å…¶è‡ªå®šä¹‰çš„ Markdown æ ¼å¼æˆ‘è¿˜æ˜¯ç”¨ä¸å¤ªä¹ æƒ¯ï¼Œä¸è¿‡ç”¨äº†æ¯å‡ æ¬¡ã€‚ä»éè®¢é˜…ç”¨åˆ°äº†è®¢é˜…&lt;/p&gt;

&lt;h3 id=&#34;mweb&#34;&gt;MWeb&lt;/h3&gt;

&lt;p&gt;æ¨èå®‰è£…å…¶é MAS ç‰ˆæœ¬ï¼Œ&lt;a href=&#34;https://zh.mweb.im/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/fMxRIDB.jpg&#34; alt=&#34;MWeb&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å‰ä¸€é˜µå­åˆšåˆå‡çº§åˆ°äº† 3.0 ç‰ˆæœ¬ï¼Œè™½ç„¶ UI ä¸Šå’Œ Ulysses å·®å¾—è¿œï¼Œä¸è¿‡å› ä¸ºæœ¬åœ°åŒ–åšçš„å¥½ï¼Œå„é¡¹æœåŠ¡æ¥å…¥çš„æ¯”è¾ƒå®Œæ•´ï¼Œæ¯”å¦‚å›¾åºŠï¼Œé™æ€ç½‘ç«™è‡ªåŠ¨ç”Ÿæˆç­‰éƒ½æ˜¯æ¯”è¾ƒå¸å¼•äººçš„åœ°æ–¹ã€‚&lt;/p&gt;

&lt;h3 id=&#34;notability&#34;&gt;Notability&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/notability/id736189492?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/GPiorsk.jpg&#34; alt=&#34;Notability&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;goodnotes&#34;&gt;GoodNotes&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/goodnotes/id1026566364?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-07-13-2400x2400bb -2-.jpg&#34; alt=&#34;GoodNotes&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;mindnode-5&#34;&gt;MindNode 5&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/mindnode-5/id1289197285?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/1er4hI3.jpg&#34; alt=&#34;MindNode 5&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;é˜…è¯»&#34;&gt;é˜…è¯»&lt;/h2&gt;

&lt;h3 id=&#34;devonthink-pro-office&#34;&gt;DEVONThink Pro Office&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://www.devontechnologies.com/download/products.html&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-07-13-42007085dd.png&#34; alt=&#34;DEVONThink Pro Office&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å·²ç»å®Œå…¨æŠŠ DENONThink å®¶çš„äº§å“ä½œä¸ºæ„å»ºæˆ‘çŸ¥è¯†å›¾è°±çš„å·¥å…·äº†ã€‚å¿…å¤‡ã€‚&lt;/p&gt;

&lt;h3 id=&#34;reeder-3&#34;&gt;Reeder 3&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/us/app/reeder-3/id880001334?mt=12&amp;amp;uo=4&amp;amp;at=1001lsTF&amp;amp;ct=iOS_detail_share_880001334&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/NPLz9Wl.jpg&#34; alt=&#34;Reeder 3&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;marginnote-3&#34;&gt;MarginNote 3&lt;/h3&gt;

&lt;p&gt;&lt;a href=&#34;https://marginnote.com/?lang=zh-hans&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/kPu5B0k.jpg&#34; alt=&#34;MarginNote 3&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;å¼€å‘å·¥å…·&#34;&gt;å¼€å‘å·¥å…·&lt;/h2&gt;

&lt;h3 id=&#34;ide&#34;&gt;IDE&lt;/h3&gt;

&lt;h4 id=&#34;xcode&#34;&gt;Xcode&lt;/h4&gt;

&lt;p&gt;è¯ä¸å¤šè¯´ï¼Œè€è€å®å®çš„ä» App Store ä¸‹è½½å§ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/NSW9lFo.jpg&#34; alt=&#34;Xcode&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;appcode&#34;&gt;AppCode&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://www.jetbrains.com/objc/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/pdXy6FK.png&#34; alt=&#34;AppCode&#34; /&gt;&lt;/p&gt;

&lt;p&gt;AppCode å¼ºå¤§å°±å¼ºå¤§åœ¨ Jetbrain å›¢é˜Ÿä¸€è´¯çš„ Refactor åŠŸèƒ½ã€‚ä¸è¿‡åœ¨ 15å¯¸ ä¸­é… MacBook Pro ä¸Šä¾ç„¶ä¼šæ—¶ä¸æ—¶å¡é¡¿ï¼Œä¸æ¸…æ¥šæ—¶ä¸æ—¶å› ä¸ºå…¶åŸºäº JVM é‚£ä¸€å¥—æ‰€è‡´ã€‚æ¨èä¸ªäººå¼€å‘è€…æˆ–è€…é¡¹ç›®ä¸å¤ªåºå¤§çš„å›¢é˜Ÿæˆ–è€…ä¸ªäººä½¿ç”¨ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ç¼–è¾‘å™¨&#34;&gt;ç¼–è¾‘å™¨&lt;/h3&gt;

&lt;h4 id=&#34;visual-studio-code&#34;&gt;Visual Studio Code&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://code.visualstudio.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ExXn0QN.png&#34; alt=&#34;Visual Studio Code&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç›®å‰å½“ä¹‹æ— æ„§æœ€å¥½ä½¿çš„ç¼–è¾‘å™¨äº†ï¼Œå½“ç„¶å¯ä»¥ä½œä¸ºå¤§é‡è„šæœ¬è¯­è¨€çš„è½»é‡ IDE ä½¿ç”¨äº†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä»£ç ç®¡ç†&#34;&gt;ä»£ç ç®¡ç†&lt;/h3&gt;

&lt;h4 id=&#34;tower&#34;&gt;Tower&lt;/h4&gt;

&lt;p&gt;Tower æ˜¯ä¸€æ¬¾å¤šå¹³å°æ”¯æŒçš„ Git GUIï¼Œä½¿ç”¨å‘½ä»¤è¡Œè™½ç„¶æŸäº›ç¨‹åº¦ä¸Šæ¯”è¾ƒå¿«ï¼Œä¹Ÿæ˜¾å¾— Geek èŒƒå„¿ï¼Œä½†æ˜¯åœ¨æŸ¥çœ‹ Diff ç­‰åŠŸèƒ½ä¸Šç¡®å®ä¸å¤ªç›´è§‚ï¼Œå› æ­¤ä¸€æ¬¾ Git çš„ UI å·¥å…·æ˜¾å¾—å¾ˆé‡è¦ã€‚Tower æ˜¯ä¸€æ¬¾æ”¶è´¹è½¯ä»¶ï¼Œæœ€è¿‘ 3.0 è½¬ä¸ºäº†è®¢é˜…å¼ã€‚åˆšè®¢é˜…äº†ä¸€å¹´åŸºç¡€ç‰ˆå†æ¥ç€ç”¨ï¼Œæ¯•ç«Ÿåˆ‡æ¢å·¥å…·çš„ä»£ä»·æœ‰æ—¶å€™è›®å¤§çš„ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.git-tower.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/r4FdJaF.jpg&#34; alt=&#34;Microsoft.VisualStudio.Services.Screenshots&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;ohmystar&#34;&gt;OhMyStar&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/us/app/ohmystar2/id1218642292?ls=1&amp;amp;mt=8&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/3NNd0ct.jpg&#34; alt=&#34;OhMyStar 2&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;snippetslab&#34;&gt;SnippetsLab&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/snippetslab/id1006087419?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/qd4LQGz.jpg&#34; alt=&#34;SnippetsLab&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;è®¾è®¡&#34;&gt;è®¾è®¡&lt;/h3&gt;

&lt;h4 id=&#34;sketch&#34;&gt;Sketch&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://www.sketchapp.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/NXGXH8X.jpg&#34; alt=&#34;Sketch&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;sip-for-mac&#34;&gt;Sip for Mac&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://sipapp.io/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/f3NUIHy.jpg&#34; alt=&#34;sip-color-format-mac-2016&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;paintcode&#34;&gt;PaintCode&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://www.paintcodeapp.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/E7UILLI.png&#34; alt=&#34;PaintCode 3&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸»è¦é’ˆå¯¹ä¸€äº›å¤æ‚çš„è®¾è®¡å›¾å½¢ï¼Œç”¨ä»£ç ç»˜åˆ¶ä¼šéå¸¸å¤æ‚ï¼Œæ¯”å¦‚ä¸€ä¸ªéœ€è¦ä½¿ç”¨ Bezier ç»˜åˆ¶å¤æ‚çš„å›¾å½¢ï¼Œå¦‚æœäººå·¥ç”»ï¼Œè´¹æ—¶è´¹åŠ›ã€‚ä½¿ç”¨ PaintCode èƒ½å¤Ÿè§£å†³è¿™ä¸ªç—›ç‚¹ï¼Œæ”¯æŒ Objective-C å’Œ Swift ä¸¤ç§è¯­è¨€ã€‚&lt;/p&gt;

&lt;p&gt;ç»“åˆ Playground çš„è¯ä½ æ„Ÿå—ä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;eagle&#34;&gt;Eagle&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/4kEFUi4.png&#34; alt=&#34;Eagle&#34; /&gt;&lt;/p&gt;

&lt;p&gt;è®¾è®¡å¸ˆç”¨æ¥æ”¶é›†ç´ ææ‰€ç”¨&lt;/p&gt;

&lt;h3 id=&#34;è°ƒè¯•&#34;&gt;è°ƒè¯•&lt;/h3&gt;

&lt;h4 id=&#34;charles&#34;&gt;Charles&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://www.charlesproxy.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/s7LX5NO.png&#34; alt=&#34;Charles&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨å…¬å¸çš„åºåˆ—å·ï¼Œæ‰‹æœºç‰ˆæœ¬æˆ‘ä¹Ÿå…¥äº†ï¼Œä¸è¿‡åœ¨ iOS ç”Ÿæ€é‡Œå…¶å¹¶æ²¡æœ‰ Mac ä¸Šåœ¨åŒç­‰åŠŸèƒ½ä¸Šçš„åœ°ä½ï¼Œåœ¨ iOS ä¸Šæˆ‘æ›´å–œæ¬¢ä½¿ç”¨ surge æˆ–è€… Thor æ¥æŠ“åŒ…ï¼Œè€Œåè€…çš„åŠŸèƒ½åŸºæœ¬ä¸Šç›®å‰æ˜¯å¸‚é¢ä¸Šæœ€å®Œæ•´çš„ App äº†ã€‚ ä½†æ˜¯åœ¨ Mac å¹³å°ï¼ŒCharles çš„åœ°ä½ä¾ç„¶æ— äººæ’¼åŠ¨ã€‚&lt;/p&gt;

&lt;h4 id=&#34;paw&#34;&gt;Paw&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://paw.cloud/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/zt7Up5u.jpg&#34; alt=&#34;paw-lg&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å¼ºå¤§çš„ API è°ƒè¯•å·¥å…·&lt;/p&gt;

&lt;h4 id=&#34;reveal&#34;&gt;Reveal&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://revealapp.com/features/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/ITkfXe6.jpg&#34; alt=&#34;Reveal&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;å…¶ä»–&#34;&gt;å…¶ä»–&lt;/h3&gt;

&lt;h4 id=&#34;monodraw&#34;&gt;Monodraw&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://monodraw.helftone.com/&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/M20TPBn.jpg&#34; alt=&#34;Monodraw&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä»£ç æ³¨é‡ŠåŠ å¼ºå·¥å…·ï¼Œå¯ä»¥ç”¨æ¥å¯¹ä»£ç è¿›è¡Œæ³¨é‡Šã€‚&lt;/p&gt;

&lt;h4 id=&#34;cutebaby&#34;&gt;CuteBaby&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/GyIzViM.jpg&#34; alt=&#34;CuteBaby&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Model åºåˆ—åŒ–å·¥å…·ï¼Œè§£å†³çš„ç—›ç‚¹å°±æ˜¯åç«¯ç»™ä½ ä¸€ä¸ª JSON ç»“æ„ï¼Œä½ éœ€è¦è‡ªè¡Œæ˜ å°„æˆå·¥ç¨‹ä¸­çš„ç±»ï¼Œè¿™ä¸ªé‡å¤å·¥ä½œæœ‰æ—¶å€™ä¼šè®©æ‚¨ç‚¸æ‰ï¼Œå› ä¸ºæœ‰çš„æ¥å£è¿”å›çš„ç»“æ„å¤æ‚ï¼Œå­—æ®µç¹æ‚ã€‚ä¸è¿‡ç½‘ç»œä¸Šæœ‰å¾ˆå¤šå¼€æºçš„é¡¹ç›®å…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸€å®šç¨‹åº¦ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ç¤¾äº¤&#34;&gt;ç¤¾äº¤&lt;/h2&gt;

&lt;h4 id=&#34;telegram&#34;&gt;Telegram&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://telegram.org/dl/macos&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/cWw9qpK.jpg&#34; alt=&#34;Telegram&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;tweetbot-3&#34;&gt;Tweetbot 3&lt;/h4&gt;

&lt;p&gt;&lt;a href=&#34;https://itunes.apple.com/cn/app/tweetbot-3-for-twitter/id1384080005?l=en&amp;amp;mt=12&#34;&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/yK4hhTr.jpg&#34; alt=&#34;Tweetbot&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;å…¶ä»–-1&#34;&gt;å…¶ä»–&lt;/h2&gt;

&lt;h4 id=&#34;rescuetime&#34;&gt;RescueTime&lt;/h4&gt;

&lt;p&gt;ä¹°äº† Premium ä¼šå‘˜ï¼Œè®°å½•æˆ‘æ—¥å¸¸åœ¨ Mac ä¸Šçš„å·¥ä½œè®°å½•ã€‚å·²ç»è®°å½•äº†å¤§æ¦‚æœ‰ 2 å¹´å¤šçš„æ•°æ®äº†ï¼Œå¾ˆç›´è§‚ã€‚&lt;/p&gt;

&lt;h4 id=&#34;pcalc&#34;&gt;PCalc&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/PRMDseI.jpg&#34; alt=&#34;PCalc&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¹Ÿç®—æ˜¯è€ç‰Œçš„è®¡ç®—å™¨äº†&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>What is LLVM</title>
      <link>https://hechen.xyz/post/what-is-llvm/</link>
      <pubDate>Tue, 10 Jul 2018 12:05:58 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/what-is-llvm/</guid>
      
        <description>

&lt;h1 id=&#34;ä»€ä¹ˆæ˜¯-llvm-éšè—åœ¨-swift-rust-clang-ç­‰è¯­è¨€èƒŒåçš„å¥¥ç§˜&#34;&gt;ä»€ä¹ˆæ˜¯ LLVMï¼Ÿéšè—åœ¨ Swiftï¼ŒRustï¼ŒClang ç­‰è¯­è¨€èƒŒåçš„å¥¥ç§˜&lt;/h1&gt;

&lt;blockquote&gt;
&lt;p&gt;äº†è§£ç¼–è¯‘å™¨æ˜¯å¦‚ä½•ç”Ÿæˆæœºå™¨åŸç”Ÿä»£ç ä¼šä½¿å¾—å€’è…¾æ–°è¯­è¨€æˆ–è€…åŠ å¼ºå·²ç»å­˜åœ¨çš„ç¼–ç¨‹è¯­è¨€å˜å¾—æ¯”ä»¥å¾€æ›´åŠ å®¹æ˜“äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æ–°çš„ç¼–ç¨‹è¯­è¨€ï¼Œé’ˆå¯¹ç°å­˜è¯­è¨€çš„ä¼˜åŒ–å¦‚åŒé›¨åæ˜¥ç¬‹èˆ¬äº§ç”Ÿã€‚ Mozilla çš„ &lt;strong&gt;Rust&lt;/strong&gt;ï¼Œ Apple çš„ &lt;strong&gt;Swift&lt;/strong&gt;ï¼ŒJetBrain çš„ &lt;strong&gt;Kotlin&lt;/strong&gt;ç­‰è¯­è¨€ç»™å¼€å‘è€…æä¾›äº†åœ¨é€Ÿåº¦ï¼Œå®‰å…¨æ€§ï¼Œä¾¿æ·æ€§ï¼Œå¯ç§»æ¤æ€§ä»¥åŠæ€§èƒ½ç­‰æ–¹é¢æ›´å¤šçš„é€‰æ‹©ã€‚&lt;/p&gt;

&lt;p&gt;ä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªæ—¶é—´ç‚¹å‘¢ï¼Ÿä¸€ä¸ªé‡å¤§çš„åŸå› æ˜¯é‚£äº›æ„å»ºå…·ä½“è¯­è¨€ç›¸å…³çš„æ–°å¼å·¥å…·çš„å‡ºç°ã€‚åœ¨è¿™ä¸€å †å·¥å…·ä¸­ï¼Œæœ€é‡è¦çš„å°±æ˜¯ LLVMï¼Œå…¶å…¨ç§°æ˜¯ Low-Level Virtual Machineï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå…¶æœ€æ—©æ˜¯ç”± Swift è¯­è¨€çš„å‘æ˜äºº Chris Lattner åœ¨ä¼Šåˆ©è¯ºæ–¯å·å·ç«‹å¤§å­¦æœŸé—´çš„ä¸€ä¸ªç ”ç©¶é¡¹ç›®è€Œæ¥ã€‚&lt;/p&gt;

&lt;p&gt;LLVM ä¸ä»…ä»…ä½¿å¾—åˆ›å»ºæ–°å¼è¯­è¨€æ›´åŠ å®¹æ˜“ï¼Œä¹Ÿä½¿å¾—é’ˆå¯¹ç°å­˜ç¼–ç¨‹è¯­è¨€è¿›è¡Œå¢å¼ºå®Œå–„æ›´åŠ ä¾¿æ·ã€‚å®ƒæä¾›äº†ä¸€å †å·¥å…·ä½¿å¾—åˆ›é€ è¯­è¨€çš„è¿‡ç¨‹ä¸­éœ€è¦çš„é‚£äº›ä»¤äººå¤´ç–¼çš„äº‹æƒ…å˜å¾—è‡ªåŠ¨åŒ–ï¼šåˆ›å»ºä¸€ä¸ªç¼–è¯‘å™¨ï¼Œè¾“å‡ºä»£ç éœ€è¦é€‚é…å¤šå¹³å°å’Œæ¶æ„ï¼Œç¼–å†™ä»£ç å¤„ç†è¯­è¨€å½“ä¸­é€šå¸¸éƒ½å­˜åœ¨çš„é‚£äº›æ¯”è¾ƒæ™¦æ¶©çš„éƒ¨åˆ†ï¼Œæ¯”å¦‚å¼‚å¸¸ã€‚LLVM çš„è‡ªç”±å¼€å‘è®¸å¯ä½¿å¾—å®ƒå¯ä»¥è¢«è‡ªç”±çš„ä½œä¸ºä¸€ä¸ªè½¯ä»¶ç»„ä»¶æˆ–è€…è¢«éƒ¨ç½²æˆæœåŠ¡æ¥ä½¿ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;ä½¿ç”¨äº† LLVM çš„ç¼–ç¨‹è¯­è¨€èŠ±åå†Œç§æœ‰å¾ˆå¤šç†Ÿæ‚‰çš„åå­—ã€‚Apple çš„ Swift è¯­è¨€ä½¿ç”¨ LLVM ä½œä¸ºå…¶ç¼–è¯‘å™¨æ¡†æ¶ï¼ŒRust è¯­è¨€ä½¿ç”¨ LLVM ä½œä¸ºå…¶å·¥å…·é“¾ä¸­çš„ä¸€ä¸ªæ ¸å¿ƒç»„ä»¶ã€‚åŒæ ·ï¼Œè®¸å¤šç¼–è¯‘å™¨ä¹Ÿæœ‰å…¶ LLVM ç‰ˆæœ¬ï¼Œä¾‹å¦‚ Clangï¼Œä¸€ä¸ª C/C++ ç¼–è¯‘å™¨ï¼Œå®ƒæ˜¯å’Œ LLVM åŠŸèƒ½ç‰¹åˆ«ç›¸è¿‘çš„ä¸€ä¸ªé¡¹ç›®ã€‚è¿˜æœ‰ Kotlin è¯­è¨€ï¼Œå…¶åä¹‰ä¸Šæ˜¯ä¸€é—¨ JVM è¯­è¨€ï¼Œä¹Ÿæ­£åœ¨å¼€å‘è¯¥è¯­è¨€çš„ä¸€ä¸ªç‰ˆæœ¬ï¼š &lt;a href=&#34;https://www.infoworld.com/article/3187370/application-development/kotlin-compiles-directly-to-native-code-via-llvm.html&#34;&gt;Kotlin Native&lt;/a&gt;ï¼Œå…¶ä½¿ç”¨ LLVM ç¼–è¯‘æˆæœºå™¨åŸç”Ÿä»£ç ã€‚&lt;/p&gt;

&lt;h2 id=&#34;llvm-æ˜¯ä»€ä¹ˆ&#34;&gt;LLVM æ˜¯ä»€ä¹ˆ&lt;/h2&gt;

&lt;p&gt;LLVM æœ€æ ¸å¿ƒçš„åŠŸèƒ½å°±æ˜¯ï¼Œå¯ä»¥é€šè¿‡ç¼–ç æ–¹å¼åˆ›é€ æœºå™¨åŸç”Ÿä»£ç ã€‚ä¸€ä¸ªå¼€å‘è€…å¯ä»¥ä½¿ç”¨å…¶ API åˆ›é€ æŒ‡ä»¤ï¼Œè¯¥æŒ‡ä»¤æ˜¯ä¸€ç§ intermediate representation æ ¼å¼ï¼Œç®€ç§° IRã€‚ä¹‹åï¼ŒLLVM èƒ½å¤Ÿå°† IR ç¼–è¯‘æˆç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ–è€…å¯¹å…¶æ‰§è¡Œå³æ—¶ç¼–è¯‘ä»¥è¿è¡Œåœ¨å¦å¤–ä¸€ä¸ªç¨‹åºï¼Œä¾‹å¦‚æŸç¼–ç¨‹è¯­è¨€çš„è§£é‡Šå™¨çš„ä¸Šä¸‹æ–‡ä¸­ã€‚&lt;/p&gt;

&lt;p&gt;å¾ˆå¤šç¼–ç¨‹è¯­è¨€ä¸­å¾ˆå¸¸è§çš„ç»“æ„ä½“æˆ–è€…æ¨¡å¼ï¼ŒLLVM çš„ API éƒ½æä¾›äº†åŸå§‹è¯­ä¹‰çš„æ”¯æŒã€‚ä¾‹å¦‚ï¼Œå‡ ä¹æ‰€æœ‰çš„è¯­è¨€éƒ½æœ‰å‡½æ•°æˆ–è€…å…¨å±€å˜é‡çš„æ¦‚å¿µï¼ŒLLVM åœ¨å…¶ IR ä¸­æŠŠå‡½æ•°å’Œå…¨å±€å˜é‡ä½œä¸ºç‹¬ç«‹å…ƒç´ å®šä¹‰å‡ºæ¥ï¼Œå› æ­¤ä½ ä¸éœ€è¦èŠ±å¤ªå¤šæ—¶é—´å’Œç²¾åŠ›æ¥é‡å¤é€ è¿™äº›ç‰¹å®šçš„è½®å­ï¼Œä½ åªéœ€è¦ä½¿ç”¨ LLVM çš„å®ç°ï¼Œä¸“æ³¨äºä½ çš„è¯­è¨€æœ€éœ€è¦å…³æ³¨çš„åœ°æ–¹å³å¯ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/xIbW9gq.jpg&#34; alt=&#34;ä¸€ä¸ª LLVM çš„ IR çš„ä¾‹è¯. å³ä¾§æ˜¯ä¸€ä¸ªç®€å•çš„ C ç¨‹åº; å·¦ä¾§æ˜¯åŒæ ·çš„ä»£ç è¢« Clang ç¼–è¯‘å™¨ç¿»è¯‘æˆçš„ LLVM IR&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;llvm-ä¸“ä¸ºç§»æ¤æ€§è€Œè®¾è®¡&#34;&gt;LLVM: ä¸“ä¸ºç§»æ¤æ€§è€Œè®¾è®¡&lt;/h2&gt;

&lt;p&gt;æ¶‰åŠ LLVM çš„ä¸€ç‚¹å°±æ˜¯ï¼Œç»å¸¸åœ¨è®¨è®º C è¯­è¨€çš„æ—¶å€™è¢«æåŠï¼š C è¯­è¨€æœ‰æ—¶å€™ä¼šè¢«æè¿°ä¸ºä¸€é—¨å¯ç§»æ¤çš„é«˜é˜¶æ±‡ç¼–è¯­è¨€ï¼Œå°±æ˜¯å› ä¸ºå…¶å…·å¤‡èƒ½è¢«æ˜ å°„æˆå¾ˆæ¥è¿‘ç¡¬ä»¶è®¾å¤‡çš„æŒ‡ä»¤ï¼Œè€Œä¸”å®ƒå·²ç»è¢«ç§»æ¤åˆ°å‡ ä¹æ‰€æœ‰çš„ç³»ç»Ÿæ¶æ„ä¸Šã€‚ä½†æ˜¯ C è¯­è¨€åªèƒ½ä½œä¸ºä¸€ç§å¯ç§»æ¤çš„æ±‡ç¼–è¯­è¨€å®é™…ä¸Šä¹Ÿæœ‰å…¶å‰¯ä½œç”¨ï¼Œè¿™ä¸ªç¡®å®ä¹Ÿä¸æ˜¯å…¶è®¾è®¡ç›®æ ‡ã€‚&lt;/p&gt;

&lt;p&gt;ä½œä¸ºå¯¹æ¯”ï¼ŒLLVM çš„ IR ä»æœ€åˆå°±æ˜¯è¢«è®¾è®¡ä½œä¸ºä¸€ä¸ªå¯ç§»æ¤çš„æ±‡ç¼–ã€‚ä½“ç°çš„ç¬¬ä¸€ç‚¹å°±æ˜¯å…¶æä¾›ç‹¬ç«‹äºç‰¹å®šæœºå™¨æ¶æ„çš„è¯­ä¹‰ï¼Œä¾‹å¦‚ï¼Œinteger ç±»å‹å¹¶ä¸ä¼šè¢«é™åˆ¶åœ¨ç‰¹å®šç¡¬ä»¶è®¾å¤‡ä¸Šçš„æœ€å¤§ä½æ•°ï¼ˆæ¯”å¦‚ 32 ä½ æˆ–è€… 64 ä½ï¼‰ã€‚ä½ å¯ä»¥æŒ‰ç…§ä½ çš„éœ€è¦çš„ä½æ•°æ¥åˆ›å»ºä½ æ‰€éœ€è¦çš„ integer ç±»å‹ï¼Œæ¯”å¦‚ ä¸€ä¸ª 128 ä½çš„ integerã€‚ä½ ä¹Ÿä¸éœ€è¦æ‹…å¿ƒé’ˆå¯¹ç‰¹å®šå¤„ç†å™¨æŒ‡ä»¤é›†æ¥å†åŠ å·¥ï¼ŒLLVM å·²ç»ä¸ºäº†è€ƒè™‘äº†è¿™äº›ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ æƒ³çœ‹åˆ° LLVM IR é•¿çš„ä»€ä¹ˆæ ·å­ï¼Œå¯ä»¥å»çœ‹ä¸€ä¸‹ &lt;a href=&#34;http://ellcc.org/&#34;&gt;ELLCC é¡¹ç›®&lt;/a&gt;ï¼Œå°è¯•ä¸€ä¸‹ &lt;a href=&#34;http://ellcc.org/demo/index.cgi&#34;&gt;Demo&lt;/a&gt; ç›´æ¥ä½¿ç”¨æµè§ˆå™¨å°† C ä»£ç è½¬æ¢ä¸º LLVM IRã€‚&lt;/p&gt;

&lt;h2 id=&#34;ç¼–ç¨‹è¯­è¨€æ˜¯å¦‚ä½•ä½¿ç”¨-llvm-çš„&#34;&gt;ç¼–ç¨‹è¯­è¨€æ˜¯å¦‚ä½•ä½¿ç”¨ LLVM çš„&lt;/h2&gt;

&lt;p&gt;æœ€å¸¸ç”¨çš„åœºæ™¯å°±æ˜¯ä½œä¸ºæŸä¸€ç§è¯­è¨€çš„ç¼–è¯‘å™¨å‰ç«¯ï¼ˆahead-of-time (AOT) compilerï¼‰ï¼Œé™¤äº†å¦‚æ­¤ï¼ŒLLVM è¿˜æœ‰å…¶ä»–å¾ˆå¤šå¯èƒ½æ€§ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä½¿ç”¨-llvm-è¿›è¡Œå³æ—¶ç¼–è¯‘&#34;&gt;ä½¿ç”¨ LLVM è¿›è¡Œå³æ—¶ç¼–è¯‘&lt;/h3&gt;

&lt;p&gt;ä¸€äº›æƒ…å½¢éœ€è¦æˆ‘ä»¬çš„ä»£ç åœ¨è¿è¡Œæ—¶å³æ—¶ç”Ÿæˆï¼Œè€Œä¸æ˜¯æå‰ç¼–è¯‘å¥½ã€‚æ¯”å¦‚ &lt;a href=&#34;https://www.infoworld.com/article/3241107/python/julia-vs-python-julia-language-rises-for-data-science.html?nsdr=true&#34;&gt;Julia è¯­è¨€&lt;/a&gt;ï¼ŒJIT ç¼–è¯‘å…¶ä»£ç ï¼Œå› ä¸ºå…¶éœ€è¦è¿è¡Œå¾ˆå¿«ï¼Œèƒ½å¤Ÿä½¿å¾—ç”¨æˆ·é€šè¿‡äº¤äº’å¼è§£æå™¨ï¼ˆ&lt;a href=&#34;https://en.wikipedia.org/wiki/Readâ€“evalâ€“print_loop&#34;&gt;REPL&lt;/a&gt;ï¼‰æˆ–è€…å¯äº¤äº’å¼¹çª—æ¥äº¤äº’ã€‚Monoï¼Œä½¿ç”¨ .Net å®ç°ï¼Œèƒ½å¤Ÿåˆ©ç”¨ &lt;a href=&#34;http://www.mono-project.com/docs/advanced/runtime/docs/llvm-backend/&#34;&gt;LLVM åç«¯ç¼–è¯‘ä¸ºæœºå™¨åŸç”Ÿä»£ç &lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.infoworld.com/article/2880767/python/5-projects-push-python-performance.html&#34;&gt;Numba&lt;/a&gt;ï¼Œä¸€ä¸ªä¸º Python æä¾›çš„æ•°å­¦è®¡ç®—åŠ é€ŸåŒ…ï¼ŒJIT å°†é€‰æ‹©çš„ Python å‡½æ•°ç¼–è¯‘ä¸ºæœºå™¨ä»£ç ã€‚å®ƒä¹Ÿèƒ½æå‰ç¼–è¯‘ Numba ä¿®é¥°çš„ä»£ç ï¼Œä½†æ˜¯ï¼ˆä¾‹å¦‚ Juliaï¼‰ï¼ŒPython ç”±äºå…¶è§£é‡Šæ€§è¯­è¨€çš„ç‰¹æ€§èƒ½å¤Ÿæä¾›å¿«é€Ÿçš„å¼€å‘å·¥ä½œã€‚ä½¿ç”¨ JIT ç¼–è¯‘èƒ½å¤Ÿäº§å‡ºæ¯”æå‰ç¼–è¯‘æ›´å¥½çš„ Python çš„äº¤äº’å·¥ä½œæµã€‚&lt;/p&gt;

&lt;p&gt;å…¶ä»–çš„è¯­è¨€è¿˜æœ‰ç”¨éä¼ ç»Ÿæ–¹å¼æŠŠ LLVM ä½œä¸º JIT æ¥å®éªŒçš„è¯­è¨€ï¼Œæ¯”å¦‚ &lt;a href=&#34;https://www.pgcon.org/2017/schedule/events/1092.en.html&#34;&gt;JIT-Compiling SQL Queries in PostgreSQL Using LLVM&lt;/a&gt;ï¼Œèƒ½å¤Ÿè¾¾åˆ°é«˜è¾¾ 5 å€çš„æ€§èƒ½æå‡ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/viRT3KE.jpg&#34; alt=&#34;Numba ä½¿ç”¨ LLVM å³æ—¶ç¼–è¯‘å…¶æ•°å€¼ä»£ç ä»è€ŒåŠ é€Ÿå…¶æ‰§è¡Œé€Ÿåº¦ã€‚JIT åŠ é€Ÿçš„ sum2d å‡½æ•°å®Œæˆæ‰§è¡Œæ¯”ä½¿ç”¨å¸¸è§„ Python ä»£ç çš„å®ç°å¿«å¤§çº¦ 139 å€&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;åˆ©ç”¨-llvm-è¿›è¡Œè‡ªåŠ¨åŒ–çš„ä»£ç ä¼˜åŒ–&#34;&gt;åˆ©ç”¨ LLVM è¿›è¡Œè‡ªåŠ¨åŒ–çš„ä»£ç ä¼˜åŒ–&lt;/h3&gt;

&lt;p&gt;LLVM ä¸ä»…ä»…æ˜¯å°† IR ç¼–è¯‘æˆåŸç”Ÿæœºå™¨ä»£ç ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ç¼–ç å¼•å¯¼å…¶è¿›è¡Œæ›´å¤§ç²’åº¦çš„ä¼˜åŒ–å·¥ä½œï¼Œæ•´ä¸ªå·¥ä½œä¼šè´¯ç©¿æ•´ä¸ªé“¾æ¥è¿‡ç¨‹ã€‚ä¼˜åŒ–å·¥ä½œå¯ä»¥éå¸¸æ¿€è¿›ï¼ŒåŒ…æ‹¬å¯¹å‡½æ•°è¿›è¡Œå†…è”ï¼Œç§»é™¤æ­»ä»£ç ï¼ˆåŒ…å«æ— ç”¨çš„ç±»å‹å£°æ˜ä»¥åŠå‡½æ•°å‚æ•°ï¼‰æˆ–è€…&lt;a href=&#34;https://en.wikipedia.org/wiki/Loop_unrolling&#34;&gt;å±•å¼€å¾ªç¯&lt;/a&gt;ç­‰ã€‚&lt;/p&gt;

&lt;p&gt;è¿™æ¬¡ä¾ç„¶ï¼Œä¸Šé¢è¿™äº›ä½ å¹¶ä¸éœ€è¦éƒ½è‡ªå·±æ¥åšã€‚ LLVM èƒ½å¤Ÿå¸®ä½ å¤„ç†è¿™äº›äº‹æƒ…ï¼Œä½ ä¹Ÿå¯ä»¥æŒ‰éœ€å…³é—­è¿™äº›åŠŸèƒ½ã€‚ä¸¾ä¾‹æ¥è®²ï¼Œå¦‚æœä½ æƒ³ç‰ºç‰²ä¸€éƒ¨åˆ†æ€§èƒ½æ¥å‡å°äºŒè¿›åˆ¶çš„å¤§å°ï¼Œä½ å¯ä»¥ä½¿ç”¨è‡ªå·±çš„ç¼–è¯‘å™¨å‰ç«¯æ¥å‘ŠçŸ¥ LLVM æ¥å…³é—­å¾ªç¯å±•å¼€ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä½¿ç”¨-llvm-çš„é¢†åŸŸç‰¹å®šè¯­è¨€&#34;&gt;ä½¿ç”¨ LLVM çš„é¢†åŸŸç‰¹å®šè¯­è¨€&lt;/h3&gt;

&lt;p&gt;LLVM å·²ç»è¢«ç”¨ä»¥ä¸ºè®¸å¤šè·¨é¢†åŸŸé€šç”¨è®¡ç®—æœºè¯­è¨€äº§ç”Ÿç¼–è¯‘å™¨ï¼Œä½†æ˜¯å®ƒåœ¨ç”Ÿæˆéå¸¸å‚ç›´æˆ–è€…è§£å†³æŸäº›å…·ä½“é—®é¢˜çš„è¯­è¨€æ–¹é¢ä¹Ÿéå¸¸æœ‰ç”¨ã€‚åœ¨æŸäº›ç¨‹åº¦ä¸Šï¼Œè¿™æ‰æ˜¯ LLVM æœ€é—ªå…‰çš„ç‚¹æ‰€åœ¨ï¼Œå› ä¸ºå®ƒç§»é™¤äº†ä¸€å¤§å †åˆ›å»ºè¯¥è¯­è¨€è¿‡ç¨‹ä¸­çš„å•è°ƒçƒ¦èºçš„å·¥ä½œï¼Œå¹¶ä¸”ä½¿å¾—å®ƒè¡¨ç°çš„æ›´å¥½ã€‚&lt;/p&gt;

&lt;p&gt;æ¯”å¦‚ï¼Œ&lt;a href=&#34;https://github.com/kripken/emscripten&#34;&gt;Emscripten&lt;/a&gt; é¡¹ç›®ï¼Œé‡‡ç”¨äº† LLVM IR ä»£ç ï¼Œå°†å…¶è½¬æ¢æˆ JavaScriptï¼Œç†è®ºä¸Šå…è®¸ä»»ä½•å…·å¤‡ LLVM åç«¯çš„è¯­è¨€å¯ä»¥å¯¼å‡ºåœ¨æµè§ˆå™¨ä¸­è¿è¡Œçš„ä»£ç ã€‚è™½ç„¶ Emscripten çš„é•¿æœŸè®¡åˆ’æ˜¯èƒ½å¤Ÿæ‹¥æœ‰å¯ç”Ÿæˆ WebAssembly çš„åŸºäº LLVM çš„åç«¯ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸€ä¸ªå±•ç¤º LLVM çµæ´»æ€§çš„å¾ˆå¥½çš„ä¾‹è¯ã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–ä¸€ç§ LLVM å¯ä»¥è¢«ä½¿ç”¨çš„æ–¹å¼å°±æ˜¯ä¸ºå·²å­˜åœ¨çš„ç¼–ç¨‹è¯­è¨€å¢åŠ ç‰¹å®šé¢†åŸŸçš„æ‰©å±•ã€‚Nvidia ä½¿ç”¨ LLVM åˆ›é€ äº†&lt;a href=&#34;https://developer.nvidia.com/cuda-llvm-compiler&#34;&gt;Nvidia CUDA Compiler&lt;/a&gt;ï¼Œå…¶èƒ½å¤Ÿè®©ç¼–ç¨‹è¯­è¨€å¢åŠ é’ˆå¯¹ CUDA çš„åŸç”Ÿæ”¯æŒï¼Œè€Œä¸æ˜¯é€šè¿‡åŠ è½½æŸä¸ªåº“æ¥å”¤èµ·ã€‚&lt;/p&gt;

&lt;h2 id=&#34;åœ¨å¤šç§è¯­è¨€ä¸­ä½¿ç”¨-llvm&#34;&gt;åœ¨å¤šç§è¯­è¨€ä¸­ä½¿ç”¨ LLVM&lt;/h2&gt;

&lt;p&gt;å’Œ LLVM æ‰“äº¤é“çš„ä¸€ç§å…¸å‹æ–¹å¼å°±æ˜¯æ‰¾åˆ°ä½ å¾ˆèˆ’æœçš„ä¸€ç§ç¼–ç¨‹è¯­è¨€çš„ä»£ç æ¥ä½“ä¼šï¼Œå½“ç„¶ï¼Œè¿™ç§ç¼–ç¨‹è¯­è¨€è¦æ”¯æŒ LLVMã€‚&lt;/p&gt;

&lt;p&gt;ä¸¤ç§å¸¸è§é€‰æ‹©çš„è¯­è¨€æ˜¯ C å’Œ C++ã€‚è®¸å¤š LLVM çš„å¼€å‘è€…é»˜è®¤é€‰æ‹©è¿™äºŒè€…ä¹‹ä¸€æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;LLVM æœ¬èº«å°±æ˜¯ C++ å†™çš„ï¼›&lt;/li&gt;
&lt;li&gt;LLVM çš„ API èƒ½å¤Ÿåœ¨ C å’Œ C++ ä¸­æ— ç¼ä½¿ç”¨ï¼›&lt;/li&gt;
&lt;li&gt;éœ€è¦è¯­è¨€éƒ½å€¾å‘äºåŸºäº C å’Œ C++ è¿›è¡Œå¼€å‘ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å°½ç®¡ï¼Œè¿™ä¸¤ç§è¯­è¨€å¹¶ä¸æ˜¯å”¯ä¸€çš„é€‰æ‹©ã€‚è®¸å¤šè¯­è¨€èƒ½å¤ŸåŸç”Ÿè°ƒç”¨ C åº“çš„æ–¹æ³•ï¼Œæ‰€ä»¥ç†è®ºä¸Šæ˜¯å¯ä»¥ä½¿ç”¨è¿™äº›è¯­è¨€æ¥è¿›è¡Œ LLVM å¼€å‘çš„ï¼Œä½†æ˜¯å…¶ä¹Ÿæœ‰åŠ©äºåœ¨æŸç§è¯­è¨€ä¸­å®é™…å­˜åœ¨ä¸€ä¸ªåº“ï¼Œèƒ½å¤Ÿä¼˜é›…çš„å°è£… LLVM çš„ APIã€‚å¹¸è¿çš„æ˜¯ï¼Œè®¸å¤šè¯­è¨€å’Œè¿è¡Œæ—¶éƒ½æœ‰è¿™äº›åº“ï¼ŒåŒ…æ‹¬ &lt;a href=&#34;https://github.com/Microsoft/LLVMSharp&#34;&gt;C#/.Net/Mono&lt;/a&gt;, &lt;a href=&#34;https://crates.io/crates/llvm-sys&#34;&gt;Rust&lt;/a&gt;, &lt;a href=&#34;https://hackage.haskell.org/package/llvm&#34;&gt;Haskell&lt;/a&gt;, &lt;a href=&#34;https://opam.ocaml.org/packages/llvm/&#34;&gt;OCAML&lt;/a&gt;, &lt;a href=&#34;https://www.npmjs.com/package/llvm-node&#34;&gt;Node.js&lt;/a&gt;, &lt;a href=&#34;https://llvm.org/svn/llvm-project/llgo/trunk/README.TXT&#34;&gt;Go&lt;/a&gt;, å’Œ &lt;a href=&#34;https://github.com/numba/llvmlite&#34;&gt;Python&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;ä¸è¿‡ï¼Œä½ éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™äº›è¯­è¨€ä¸­æœ‰ä¸€äº›é’ˆå¯¹ LLVM çš„ç»‘å®šæ”¯æŒå¹¶ä¸å®Œæ•´ã€‚ä»¥ Python è¯­è¨€ä¸¾ä¾‹ï¼Œè™½ç„¶å­˜åœ¨å¤šç§é€‰æ‹©ï¼Œä½†æ˜¯å®ƒä»¬éƒ½ä¼šåœ¨å®Œæ•´æ€§å’ŒåŠŸæ•ˆæ€§ä¸Šæœ‰å·®åˆ«ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;LLVM é¡¹ç›®ä¸‹&lt;a href=&#34;https://github.com/llvm-mirror/llvm/tree/master/bindings/python&#34;&gt;ç»´æŠ¤æœ‰é’ˆå¯¹ LLVM çš„ C ç‰ˆ API çš„ç»‘å®šé›†åˆ&lt;/a&gt;ï¼Œä½†æ˜¯å®ƒä»¬å·²ç»ä¸å†è¢«ç»´æŠ¤äº†ï¼›&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.infoworld.com/article/3247799/development-tools/what-is-llvm-the-power-behind-swift-rust-clang-and-more.html&#34;&gt;llvmpy&lt;/a&gt; åœ¨ 2015 å¹´åœæ­¢çš„ç»´æŠ¤ï¼Œè¿™å¯¹äºä»»ä½•çš„è½¯ä»¶é¡¹ç›®æ¥è®²éƒ½ä¸æ˜¯ä¸€ä»¶å¥½äº‹ã€‚åœ¨ä½¿ç”¨ LLVM çš„æ—¶å€™æ›´æ˜¯å¦‚æ­¤ï¼Œè€ƒè™‘åˆ°æ¯ä¸€ä¸ªç‰ˆæœ¬çš„ LLVM æ‰€å¸¦æ¥çš„å˜åŒ–æ•°é‡ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/numba/llvmlite&#34;&gt;llvmlite&lt;/a&gt; æ˜¯ç”± Numba çš„å¼€å‘å›¢é˜Ÿåˆ›å»ºçš„ï¼Œå·²ç»æˆä¸ºäº†å½“ä¸‹åœ¨ Python ä¸­åš LLVM å¼€å‘çš„æœ‰åŠ›ç«äº‰è€…ã€‚å®ƒåŸºäº Numba é¡¹ç›®çš„éœ€æ±‚ï¼Œåªå®ç°äº†ä¸€å°éƒ¨åˆ† LLVM çš„åŠŸèƒ½ã€‚ä½†æ˜¯è¿™ä¸ªåŠŸèƒ½å­é›†å·²ç»èƒ½å¤Ÿæ»¡è¶³å¤§éƒ¨åˆ† LLVM å¼€å‘è€…ä½¿ç”¨äº†ã€‚&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/revng/llvmcpy&#34;&gt;llvmcpy&lt;/a&gt; æ—¨åœ¨æ›´æ–° Python ä¸º C åº“æä¾›çš„ç»‘å®šï¼Œä½¿å¾—å®ƒä»¬èƒ½å¤Ÿä»¥è‡ªåŠ¨åŒ–çš„å½¢å¼ä¿æŒæ›´æ–°ï¼Œå¹¶ä¸” Python çš„åŸç”Ÿè¯­æ³•ä½¿å¾—å®ƒä»¬èƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ã€‚llvmcpy ä¾ç„¶å¤„äºåˆçº§é˜¶æ®µï¼Œä½†æ˜¯å·²ç»åšäº†å¾ˆå¤šå’Œ LLVM API æ‰“äº¤é“çš„åŸºç¡€å·¥ä½œã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If youâ€™re curious about how to use LLVM libraries to build a language, LLVMâ€™s own creators have a tutorial, using either C++ or OCAML, that steps you through creating a simple language called Kaleidoscope. Itâ€™s since been ported to other languages:&lt;/p&gt;

&lt;p&gt;å¦‚æœä½ å¾ˆå¥½å¥‡å¦‚ä½•ä½¿ç”¨ LLVM åº“æ„å»ºä¸€é—¨è¯­è¨€çš„è¯ï¼ŒLLVM çš„åŸåˆ›è€…ä»¬æä¾›äº†&lt;a href=&#34;https://llvm.org/docs/tutorial/index.html&#34;&gt;æ•™ç¨‹&lt;/a&gt;ï¼Œè¯¥æ•™ç¨‹ä½¿ç”¨ C++ æˆ–è€… OCAML ï¼ŒæŒ‡å¯¼ä½ ä»å¤´åˆ°å°¾åˆ›é€ ä¸€é—¨ç®€å•çš„è¯­è¨€ &lt;strong&gt;Kaleidoscope&lt;/strong&gt;ï¼Œè€Œè¿™ä¸ªç¤ºä¾‹å·²ç»è¢«ç§»æ¤åˆ°å…¶ä»–è¯­è¨€ä¸Šäº†ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;http://www.stephendiehl.com/llvm/&#34;&gt;Haskell&lt;/a&gt;: å’ŒåŸå§‹æ•™ç¨‹æœ€æ¥è¿‘çš„ç§»æ¤ï¼›&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Pythonï¼š&lt;a href=&#34;https://github.com/eliben/pykaleidoscope&#34;&gt;ä¸€ä¸ªç‰ˆæœ¬&lt;/a&gt;å’Œè¯¥æ•™ç¨‹éå¸¸æ¥è¿‘ï¼Œ&lt;a href=&#34;https://github.com/frederickjeanguerin/pykaleidoscope&#34;&gt;å¦å¤–ä¸€ä¸ªç‰ˆæœ¬&lt;/a&gt; æ›´æ¿€è¿›ä¸€äº›ï¼Œé‡å†™äº†ä¸€ä¸ªäº¤äº’å‘½ä»¤è¡Œã€‚ä¸¤è€…éƒ½ä½¿ç”¨äº† llvmlite ä½œä¸ºå’Œ LLVM çš„ç»‘å®šï¼›&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://github.com/jauhien/iron-kaleidoscope&#34;&gt;Rust&lt;/a&gt; å’Œ &lt;a href=&#34;https://harlanhaskins.com/2017/01/08/building-a-compiler-with-swift-in-llvm-part-1-introduction-and-the-lexer.html&#34;&gt;Swift&lt;/a&gt;ï¼šä¼¼ä¹ä¸å¯é¿å…ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°è¿™ä¸¤ä¸ªè¯­è¨€ç‰ˆæœ¬çš„ç§»æ¤ç‰ˆæœ¬æ•™ç¨‹ï¼Œå› ä¸º LLVM æœ¬èº«æ›´å°±æ˜¯å› ä¸ºè¿™äºŒè€…æ‰å¾—ä»¥åˆ›é€ çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;æœ€åï¼Œè¿™ä¸ªæ•™ç¨‹ä¹Ÿæœ‰å…¶ä»–äººç±»è¯­è¨€çš„ç‰ˆæœ¬ã€‚å®ƒå·²ç»è¢«ç¿»è¯‘æˆä¸­æ–‡äº†ï¼Œæœ‰ä½¿ç”¨ &lt;a href=&#34;https://github.com/liancheng/llvm-tutorial-cn&#34;&gt;C++&lt;/a&gt; çš„ï¼Œä¹Ÿæœ‰ &lt;a href=&#34;https://github.com/moevis/Kaleidoscope-LLVM-tutorial-zh-cn&#34;&gt;Python&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&#34;llvm-åšä¸åˆ°å“ªäº›&#34;&gt;LLVM åšä¸åˆ°å“ªäº›&lt;/h2&gt;

&lt;p&gt;ä»¥ä¸Šæåˆ°çš„éƒ½æ˜¯ LLVM èƒ½å¤Ÿæä¾›çš„åŠŸèƒ½ï¼Œå®ƒè¿˜æœ‰ä¸€äº›æ— æ³•åšåˆ°çš„äº‹æƒ…ï¼Œäº†è§£ä¸€ä¸‹ä¼šæ¯”è¾ƒæœ‰ç”¨ã€‚&lt;/p&gt;

&lt;p&gt;ä¸¾ä¾‹è€Œè¨€ï¼ŒLLVM ä¸ä¼šè¿›è¡Œè¯­æ³•è§£æã€‚è®¸å¤šå·¥å…·ï¼Œæ¯”å¦‚ &lt;a href=&#34;http://dinosaur.compilertools.net/&#34;&gt;lex/yacc&lt;/a&gt;ï¼Œ&lt;a href=&#34;http://aquamentus.com/flex_bison.html&#34;&gt;ï¬‚ex/bison&lt;/a&gt; ä»¥åŠ &lt;a href=&#34;http://www.antlr.org/&#34;&gt;ANTLR&lt;/a&gt; ç­‰éƒ½å·²ç»åšäº†è¿™äº›å·¥ä½œã€‚è§£æè¯­æ³•å°±æ„å‘³ç€è¦å’Œç¼–è¯‘è¡Œä¸ºè¿›è¡Œè§£è€¦ï¼Œæ‰€ä»¥ï¼ŒLLVM æ²¡æœ‰è¯•å›¾å»åšè¿™éƒ¨åˆ†å·¥ä½œä¹Ÿä¸æ„å¤–ã€‚&lt;/p&gt;

&lt;p&gt;LLVM ä¹Ÿä¸ä¼šè¯•å›¾è§£å†³å›´ç»•æŸç§ç‰¹å®šè¯­è¨€æ›´å¤§èŒƒå›´çš„å‘¨è¾¹è¡Œä¸ºã€‚ä½ éœ€è¦è‡ªè¡Œå®‰è£…ç¼–è¯‘å™¨äºŒè¿›åˆ¶ï¼Œç®¡ç†å®‰è£…è¿‡ç¨‹ä¸­çš„åŒ…ä»¥åŠå‡çº§å·¥å…·é“¾ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åä¸€ç‚¹ï¼Œä¹Ÿæ˜¯æœ€é‡è¦çš„æ˜¯ï¼Œä¾ç„¶åˆå¾ˆå¤šè¯­è¨€é€šç”¨çš„éƒ¨åˆ† LLVM æ²¡æœ‰åŸç”Ÿæ”¯æŒçš„ã€‚è®¸å¤šç¼–ç¨‹è¯­è¨€éƒ½å­˜åœ¨åƒåœ¾å›æ”¶å†…å­˜ç®¡ç†çš„è¡Œä¸ºï¼Œè¦ä¹ˆä½œä¸ºç®¡ç†å†…å­˜çš„ä¸»è¦æ–¹å¼ï¼Œè¦ä¹ˆä½œä¸ºæŸç§ç­–ç•¥ï¼Œä¾‹å¦‚ RAIIï¼ˆC++ å’Œ Rust è¯­è¨€ä¸­ä½¿ç”¨çš„ï¼‰çš„è¾…åŠ©ã€‚LLVM ä¸æä¾›åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä½†æ˜¯å®ƒç¡®å®&lt;a href=&#34;https://llvm.org/docs/GarbageCollection.html&#34;&gt;æä¾›ä¸€äº›å·¥å…·&lt;/a&gt;ï¼Œèƒ½å¤Ÿå…è®¸ä»£ç å¯ä»¥ä½¿ç”¨å…ƒæ•°æ®æ¥åšæ ‡è®°ä½¿å¾—ç¼–å†™åƒåœ¾æ”¶é›†å™¨æ›´åŠ å®¹æ˜“ã€‚&lt;/p&gt;

&lt;p&gt;å°½ç®¡å¦‚æ­¤ï¼ŒLLVM è¿˜æ˜¯å­˜åœ¨æœ€ç»ˆæ·»åŠ åŸç”Ÿæ”¯æŒæ‰§è¡Œåƒåœ¾å›æ”¶æœºåˆ¶çš„å¯èƒ½æ€§ã€‚LLVM æ­£åœ¨ä»¥æ¯ 6 ä¸ªæœˆä¸€ä¸ªå¤§ç‰ˆæœ¬æ›´æ–°åœ¨å¿«é€Ÿå‘å±•ã€‚è€Œè¿™ä¸ªå‘å±•æ­¥é€Ÿå¾ˆå¤§ç¨‹åº¦ä¸Šå› ä¸ºç›®å‰å¾ˆå¤šä¸»æµç¼–ç¨‹è¯­è¨€å·²ç»æŠŠå…¶ä½œä¸ºå®ƒä»¬å¼€å‘è¿‡ç¨‹çš„æ ¸å¿ƒä¸€ç¯ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>In App Purchase</title>
      <link>https://hechen.xyz/post/in-app-purchase/</link>
      <pubDate>Thu, 24 May 2018 10:40:39 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/in-app-purchase/</guid>
      
        <description>

&lt;p&gt;å¯¹äºåœ¨ App Store ä¸­ä¸Šæ¶çš„åº”â½¤æ¥è¯´ï¼Œåº”â½¤å†…è´­ä¹°(In-App Purchaseï¼Œç®€ç§° IAP) åº”è¯¥æ˜¯ä¸€ä¸ªé¿ä¸å¼€çš„è¯é¢˜ï¼Œå°¤å…¶æ˜¯å»å¹´å¾®ä¿¡æ‰“èµå’Œ Apple ä¹‹é—´çš„äº‰æ‰§æ›´è®© IAP ç«äº†ä¸€æŠŠï¼Œä¸ä»…ä»…å¤§å…¬å¸ï¼Œä½œä¸ºä¸ªäººå¼€å‘è€…æ¥è®²ï¼ŒIAP ä¹Ÿæ˜¯éå¸¸é‡è¦çš„ï¼Œè¯´ä¸å®šå°±æ˜¯ä½ å…»å®¶ç³Šå£çš„å·¥å…·å‘¢ã€‚&lt;/p&gt;

&lt;!-- more --&gt;

&lt;p&gt;æ•´ä¸ª IAP çš„è¿‡ç¨‹ï¼Œåœ¨å®¢æˆ·ç«¯çš„å®ç°ä¾èµ–äº &lt;code&gt;StoreKit&lt;/code&gt; è¿™ä¸ªæ¡†æ¶ï¼Œæ‰€æœ‰çš„æ”¯ä»˜ç›¸å…³æ“ä½œéƒ½æ˜¯äº¤ç”± StoreKit æ¥å®Œæˆçš„ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å…ˆå¤ä¹ ä¸€ä¸‹ IAP çš„æ•´ä¸ªæµç¨‹ã€‚&lt;/p&gt;

&lt;h2 id=&#34;in-app-purchase-çš„æ•´ä½“æµç¨‹&#34;&gt;In App Purchase çš„æ•´ä½“æµç¨‹&lt;/h2&gt;

&lt;h3 id=&#34;é˜¶æ®µ-1&#34;&gt;é˜¶æ®µ 1&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-09-03-4DDE8387-EDB1-42CC-B18C-3DC6CA1DC688.png&#34; alt=&#34;In App Purchase è¿‡ç¨‹&#34; /&gt;&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;åŠ è½½ In-App Identifier&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯ä» AppStore ä¸­è·å–æœ¬åœ°åŒ–çš„å•†å“ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;æŠŠ IAP çš„è´­ä¹°ç•Œâ¾¯é¢å±•ç¤ºç»™â½¤ç”¨æˆ·ï¼Œâ½¤ç”¨æˆ·å¯ä»¥åŒæ„è´­ä¹°å¹¶ç‚¹å‡»è´­ä¹°æŒ‰é’®ã€‚&lt;/li&gt;
&lt;li&gt;â½¤ç”¨æˆ·æˆæƒè´­ä¹°ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ï¨¸å‘é€è´­ä¹°è¯·æ±‚ã€‚&lt;/li&gt;
&lt;li&gt;æœåŠ¡å™¨ï¨¸å¤„ç†ï§¤è´­ä¹°è¯·æ±‚ï¼Œå¹¶æŠŠç»“æœè¿”å›ç»™ StoreKitã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœè´­ä¹°è¯·æ±‚éªŒè¯é€šè¿‡ï¼Œå®¢æˆ·ç«¯æ­¤æ—¶è§£é”å†…å®¹æˆ–è€…æä¾›â¾¦é‡‘ï¤Šå¸ã€‚&lt;/li&gt;
&lt;li&gt;è‡³æ­¤ï¼Œæ•´ä¸ªäº¤æ˜“ï§ æµç¨‹ç»“æŸã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;é˜¶æ®µ-2&#34;&gt;é˜¶æ®µ 2&lt;/h3&gt;

&lt;p&gt;å…·ä½“åˆ°å’Œ Apple Store æ‰“äº¤é“çš„è¯ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-08-27-intro_2x.png&#34; alt=&#34;IAP With App Store&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;é˜¶æ®µ-3&#34;&gt;é˜¶æ®µ 3&lt;/h3&gt;

&lt;p&gt;å¦‚æœæ¶‰åŠåˆ°è‡ªå·± App ç«¯ Server çš„å‚ä¸ï¼ŒåŸºæœ¬å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-08-29-1*MwLeHUGSupbb9j-oYQyflw.png&#34; alt=&#34;IAP With Business Server&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ­£å¸¸å¤šå‡ºçš„å‡ æ­¥ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;è·å– Product æ ‡è¯†åˆ—è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;å®¢æˆ·ç«¯ä¸Šä¼  Receipt æ•°æ®ç»™ Serverï¼ŒServer è‡ªè¡Œæ ¡éªŒæˆ–è€…ä½¿ç”¨ Apple çš„æ¥å£æ ¡éªŒï¼›&lt;/li&gt;
&lt;li&gt;Server ç«¯å‘ŠçŸ¥ç»™å®¢æˆ·ç«¯ä»˜è´¹å†…å®¹&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;æ³¨å†Œå•†å“&#34;&gt;æ³¨å†Œå•†å“&lt;/h3&gt;

&lt;p&gt;å•†å“æ³¨å†Œæ˜¯é€šè¿‡ iTunes Connect åå°è¿›è¡Œçš„ï¼Œå…¶ä¸­å•†å“ç±»å‹éœ€è¦æå‰æ˜ç¡®å¥½ã€‚&lt;/p&gt;

&lt;h4 id=&#34;å•†å“ç±»å‹&#34;&gt;å•†å“ç±»å‹&lt;/h4&gt;

&lt;p&gt;å‚ä¸ App å†…æ”¯ä»˜åŠ¨ä½œçš„å•†å“æœ‰å››ç§ç±»å‹ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Consumable products ï¼ˆæ¶ˆè€—å‹å•†å“ï¼‰&lt;/li&gt;
&lt;li&gt;Non-consumable products ï¼ˆéæ¶ˆè€—å‹å•†å“ï¼‰&lt;/li&gt;
&lt;li&gt;Auto-renewable subscriptions ï¼ˆè‡ªåŠ¨ç»­çº¦è®¢é˜…ï¼‰&lt;/li&gt;
&lt;li&gt;Non-renewable subscriptions ï¼ˆéè‡ªåŠ¨ç»­çº¦è®¢é˜…ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…¶ä¸­å…³äºéè‡ªåŠ¨ç»­çº¦è®¢é˜…ï¼ŒApp çš„å¼€å‘è€…æœ‰ä¹‰åŠ¡åŒæ­¥æœåŠ¡åˆ°ç”¨æˆ·çš„æ‰€æœ‰è®¾å¤‡ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;å¦‚ä¸‹ï¼Œæ˜¯å®˜æ–¹æ–‡æ¡£åˆ—å‡ºæ¥çš„å››ç§å•†å“ç±»å‹çš„ä¸€äº›ä¸»è¦å±æ€§ã€‚&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Product type&lt;/th&gt;
&lt;th&gt;Non-consumable&lt;/th&gt;
&lt;th&gt;Consumable&lt;/th&gt;
&lt;th&gt;Auto-renewable&lt;/th&gt;
&lt;th&gt;Non-renewing&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;Users can buy&lt;/td&gt;
&lt;td&gt;Once&lt;/td&gt;
&lt;td&gt;Multiple times&lt;/td&gt;
&lt;td&gt;Multiple times&lt;/td&gt;
&lt;td&gt;Multiple times&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Appears in the receipt&lt;/td&gt;
&lt;td&gt;Always&lt;/td&gt;
&lt;td&gt;Once&lt;/td&gt;
&lt;td&gt;Always&lt;/td&gt;
&lt;td&gt;Always&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Synced across devices&lt;/td&gt;
&lt;td&gt;By the system&lt;/td&gt;
&lt;td&gt;Not synced&lt;/td&gt;
&lt;td&gt;By the system&lt;/td&gt;
&lt;td&gt;By your app&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td&gt;Restored&lt;/td&gt;
&lt;td&gt;By the system&lt;/td&gt;
&lt;td&gt;Not restored&lt;/td&gt;
&lt;td&gt;By the system&lt;/td&gt;
&lt;td&gt;By your app&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;å…¶ä¸­éœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;é™¤äº†éæ¶ˆè€—å‹å•†å“åªèƒ½ä¹°ä¸€æ¬¡ï¼Œå†æ¬¡è´­ä¹°åº”è¯¥ä¼šå¤±è´¥ä»¥å¤–ï¼Œå…¶ä»–ä¸‰ç§ç±»å‹ï¼ˆæ¶ˆè€—å‹ï¼Œè¿ç»­/éè¿ç»­è®¢é˜…ï¼‰éƒ½æ˜¯å¯ä»¥æ— é™åˆ¶è´­ä¹°çš„ï¼ŒApple æ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼›&lt;/li&gt;
&lt;li&gt;é™¤äº†æ¶ˆè€—å‹å•†å“åœ¨ Receipt ä¸­å‡ºç°ä¸€æ¬¡ï¼Œå…¶ä»–ä¸‰ç§ç±»å‹ï¼ˆéæ¶ˆè€—å‹ï¼Œè¿ç»­/éè¿ç»­è®¢é˜…ï¼‰æ˜¯å§‹ç»ˆéƒ½ä¼šåœ¨å…¶ä¸­çš„ï¼Œè¿™ä¹Ÿæ˜¯åç»­åšè®¢é˜…æ ¡éªŒè‡³å…³é‡è¦çš„ä¸€ç¯ï¼›&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;è·å–-product-id&#34;&gt;è·å– Product ID&lt;/h3&gt;

&lt;p&gt;è¿™é‡Œè·å–çš„æ˜¯ Product åœ¨ iTunes Connect åå°æ³¨å†Œå•†å“æ—¶å¡«å†™çš„ Product ID&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-09-03-15359854946888.png&#34; alt=&#34;Product ID&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In-App Identifier ä¸ºæ¯ä¸ªå¯é”€å”®çš„å•†å“æä¾›ä¸€ä¸ªå”¯ä¸€æ ‡è¯†ã€‚åœ¨å®¢æˆ·ç«¯ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å†™æ­»ä»£ç :&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let identifiers = [&amp;quot;com.myCompany.myApp.product1&amp;quot;, &amp;quot;com.myCompany.myApp.product2&amp;quot; ]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ–è€…ä» Server ç«¯è·å–ã€‚&lt;/p&gt;

&lt;h3 id=&#34;è·å–å•†å“ä¿¡æ¯&#34;&gt;è·å–å•†å“ä¿¡æ¯&lt;/h3&gt;

&lt;p&gt;ç„¶åé€šè¿‡ä¸Šä¸€æ­¥å–å¾—çš„ Product ID æ¥è·å–å…·ä½“æŸä¸ª Product çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä»·æ ¼ï¼Œæè¿°ç­‰ç­‰ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;// è·å–ä¸€æ‰¹å•†å“çš„ä¿¡æ¯

let request = SKProductsRequest(productIdentifiers: identifierSet) 

request.delegate = self

request.start()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åœ¨ä»£ç†å›è°ƒä¸­å¤„ç†è·å–çš„ç»“æœï¼Œè¿›è¡Œå±•ç¤ºæˆ–è€… Cacheã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;func productRequest(_ request: SKProductsRequest, didReceive response: SKProductsResponse) {

    for product in response.products {
    
    } 
} 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å®˜æ–¹å»ºè®®æ˜¯ä¸è¦è¿›è¡Œç¼“å­˜ï¼Œå› ä¸º Product çš„ä¿¡æ¯æœ‰å¯èƒ½ä¼šæ›´æ–°ï¼Œæ¯”å¦‚ç”¨æˆ·åˆ‡æ¢ AppStore çš„åŒºåŸŸï¼Œä»·æ ¼ä¿¡æ¯ä¹Ÿä¼šå› ä¸ºç›¸åº”çš„æ±‡ç‡å‘ç”Ÿå˜åŒ–ã€‚ä¸è¿‡ï¼åœ¨å›½å†…ï¼Œè¢«ç‰ºç‰²æœ€å¤§çš„ç”¨æˆ·ä½“éªŒä¸æ˜¯è¿™ç§è¾¹ç•Œæƒ…å†µï¼Œè€Œæ˜¯è·å– Product ä¿¡æ¯æ˜¯éœ€è¦å’Œ Apple Server æ‰“äº¤é“çš„ï¼Œè¿™å°±æœ‰ä¸ªé—®é¢˜ â€”â€” æ…¢ï¼&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¼šåœ¨å¼€æœºçš„æ—¶å€™æå‰é¢„å–æ‰€æœ‰ Product ä¿¡æ¯ï¼Œå¹¶ä¸”ç¼“å­˜èµ·æ¥ã€‚ä¸‹æ¬¡å¼¹å‡ºå……å€¼é¢æ¿çš„æ—¶å€™å°±ç›´æ¥åˆ—å‡ºå•†å“ä¿¡æ¯å³å¯ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å±•ç¤ºæ”¯ä»˜-ui&#34;&gt;å±•ç¤ºæ”¯ä»˜ UI&lt;/h2&gt;

&lt;p&gt;æ¥ä¸‹æ¥å°±çœ‹ä»€ä¹ˆæ—¶å€™è¿›è¡Œè´­ä¹°äº†ï¼Œå±•ç¤ºå•†å“é¢æ¿è¿›è¡Œè´­ä¹°ã€‚ç”¨æˆ·åœ¨é¢æ¿ä¸Šè¿›è¡Œé€‰æ‹©ä¹‹åï¼Œå°±è¿›å…¥äº†ä¸‹ä¸€é˜¶æ®µ â”€â”€ æ”¯ä»˜&lt;/p&gt;

&lt;h2 id=&#34;å‘å‡ºè´­ä¹°è¯·æ±‚&#34;&gt;å‘å‡ºè´­ä¹°è¯·æ±‚&lt;/h2&gt;

&lt;p&gt;è¿™â¼€æ­¥ä¹Ÿå¾ˆç®€å•ï¼Œ ä¸¤â¾ï¨ˆä»£ç å°±å¯ä»¥æå®šã€‚åªéœ€è¦æŠŠä¹‹å‰æ‹¿åˆ°çš„å•†å“å¯¹è±¡ä¼ åˆ° &lt;code&gt;SKPayment&lt;/code&gt; çš„åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œæ„é€ ä¸€ä¸ª &lt;code&gt;SKPayment&lt;/code&gt; å®ï¦µï¼Œå†æŠŠè¿™ä¸ªå®ï¦µåŠ â¼Šåˆ°è´­ä¹°é˜Ÿï¦œä¸­å³å¯:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let payment = SKPayment(product: product) SKPaymentQueue.default().add(payment)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¹‹åå°±äº¤ç»™ Apple äº†ï¼Œæ­¤æ—¶åº”ç”¨å†…ä¼šå¼¹å‡ºè‹¹æœè®¾è®¡çš„è´­ä¹°çª—å£ï¼Œç”¨æˆ·åªè¦ä½¿â½¤æŒ‡çº¹æˆ–è€…è¾“å…¥å¯†ç å³å¯åŒæ„ä»˜æ¬¾ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å¤„ç†è´­ä¹°ç»“æœ&#34;&gt;å¤„ç†è´­ä¹°ç»“æœ&lt;/h2&gt;

&lt;p&gt;å½“â½¤æˆ·çš„è´­ä¹°è¯·æ±‚ç»è¿‡ &lt;code&gt;StoreKit&lt;/code&gt; å’Œè‹¹æœæœåŠ¡ï¨¸çš„éªŒè¯åï¼Œå¼€å‘è€…å¯ä»¥åœ¨å›è°ƒå‡½æ•°ä¸­æ¥æ”¶åˆ°ã€‚Apple å…·ä½“çš„å›è°ƒä¼šé€šè¿‡ &lt;code&gt;SKPaymentQueue&lt;/code&gt; æ¥è¿›è¡Œï¼Œå¦‚ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ”¯ä»˜ä¹‹å‰å°±å‘ &lt;code&gt;SKPaymentQueue&lt;/code&gt; ä¸­åŠ å…¥ä»£ç†ç›‘å¬ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;SKPaymentQueue.default().add(self)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½ å¯ä»¥æŠŠå…·ä½“çš„ç›‘å¬æ”¾åœ¨ä¸€ä¸ªç‹¬ç«‹çš„ç±»ä¸­å®Œæˆã€‚åœ¨è¯¥ Observer ä¸­ï¼Œå®ç°ä»£ç†æ–¹æ³•ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;// å¤„ç†ï§¤ SKPaymentQueueObserver äº‹ä»¶
// MARK: - SKPaymentTransactionObserver
func paymentQueue(_ queue: SKPaymentQueue, updatedTransactions transactions:[SK PaymentTransaction]) {
    for transaction in transactions {
        switch transaction.transactionState { 
            case .purchased:
            // Validate the purchase
            
            // Locate the file
            guard let url = Bundle.main.appStoreReceiptURL else {
                // Handle failure
                return    
            }

            // Read the contents
            let receipt = Data(contentsOf: url)
        } 
    }
} 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¯¹äºæ¯ä¸€ä¸ªä½ æäº¤çš„ Paymentï¼Œå°±ä¸€å®šä¼šæœ‰ä¸€ä¸ªç›¸åº”çš„ Transaction ç”Ÿæˆä»¥ä¾¿å…¶åç»­å¤„ç†ã€‚é€šè¿‡æ£€æŸ¥ transaction çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‡å®šæ¯ç§çŠ¶æ€ä¸‹çš„å¤„ç†é€»è¾‘ã€‚å¦‚æœçŠ¶æ€æ˜¾ç¤ºå·²è´­ä¹°ï¼Œ æˆ‘ä»¬è¿˜æ˜¯åº”è¯¥å’Œâ¾ƒå·±çš„æœåŠ¡å™¨ï¨¸è¿›ï¨ˆä¸€æ¬¡æ ¡éªŒï¼Œç¡®ä¿äº¤ï§ çœŸå®æœ‰æ•ˆâ½½è€Œï¥§æ˜¯é€šè¿‡è¶Šç‹±åçš„æŸäº›æ’ä»¶å®Œæˆçš„ã€‚è¢«æ£€éªŒçš„ï¼Œæ˜¯ä¸€ç§è¢«è‹¹æœç§°ä¹‹ä¸ºæ”¶æ®(receipt)çš„å‡­è¯ï¼Œå°±åƒæˆ‘ä»¬åœ¨è¶…å¸‚è´­ç‰©æˆ–è€…é¥­åº—å°±é¤åæ‹¿åˆ°çš„æ”¶æ®ä¸€æ ·ï¼Œæ¯â¼€ä¸ªè´­ä¹°çš„å•†å“éƒ½æœ‰â¾ƒå·±çš„æ”¶æ®ã€‚è¿™ä¸ªæ”¶æ®ç”±è‹¹æœç­¾å‘ï¼Œä¿å­˜åœ¨å®¢æˆ·ç«¯æœ¬åœ°ã€‚&lt;/p&gt;

&lt;p&gt;ç›®å‰ Apple å®˜æ–¹æä¾›ä¸¤ç§æ–¹å¼ï¼Œä¸€ç§æ˜¯æœ¬æœºæ ¡éªŒï¼Œä¸€ç§æ˜¯ Server ç«¯æ ¡éªŒã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-09-03-E9DC4D03-7F18-49CC-B21D-835904E2B39F.png&#34; alt=&#34;Receipt Validation Ways&#34; /&gt;&lt;/p&gt;

&lt;h2 id=&#34;final-æŠ•é€’å•†å“&#34;&gt;Finalï¼ŒæŠ•é€’å•†å“&lt;/h2&gt;

&lt;p&gt;å½“ Server ç«¯æ£€éªŒå®Œæˆä¹‹åï¼Œè¯´æ˜æœ¬åœ°äº¤æ˜“å·²ç»æˆåŠŸå®Œæˆï¼Œå› æ­¤å°†ç”¨æˆ·è´­ä¹°çš„å†…å®¹æä¾›ç»™ç”¨æˆ·ä½¿ç”¨ã€‚å½“ç„¶ï¼Œå¯¹äºä¸šåŠ¡æ–¹ï¼Œè´­ä¹°å®Œæˆä¸ä»£è¡¨ä¸šåŠ¡å®Œæˆï¼Œå› æ­¤å¤§å¤šæ•°æƒ…å†µä¸‹è¿˜æœ‰ä¸€æ­¥è¿›è¡Œå•†å“ä¸šåŠ¡æ ¡éªŒçš„è¿‡ç¨‹ã€‚&lt;/p&gt;

&lt;p&gt;éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼š&lt;/p&gt;

&lt;p&gt;Apple ä¹Ÿæ˜ç¡®å‘Šè¯‰å¼€å‘è€…æœ‰å‡ ä¸ªå…³é”®çš„è·¯å¾„èŠ‚ç‚¹éœ€è¦æ³¨æ„ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/2018-09-03-C1BB8495-728D-43E7-9C40-8EC9B3A22905.png&#34; alt=&#34;å…³é”®è·¯å¾„&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ç›‘å¬äº¤æ˜“çŠ¶æ€çš„ä»£ç ä¸€å®šè¦è¶Šæ—©è¶Šå¥½ï¼Œæ¯”å¦‚åœ¨ App å®Œæˆå¯åŠ¨ä¹‹åè¿›è¡Œæ³¨å†Œï¼Œç¡®ä¿æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…éƒ½æœ‰ä»£ç é€»è¾‘æ¥å¤„ç†ç›‘å¬åˆ°çš„äº¤æ˜“ï¼Œæ ¹æ®ç›‘å¬åˆ°çš„ Transaction çš„çŠ¶æ€æ¥åˆ†å‘å¤„ç†é€»è¾‘ã€‚å› ä¸ºå¾ˆæœ‰å¯èƒ½ä½ ç›‘å¬çš„æ—¶æœºå¤ªæ™šï¼Œå¯¼è‡´ Apple é€šçŸ¥æœ‰ä¸€äº›ä¹‹å‰æœªå®Œæˆçš„äº¤æ˜“çš„æ—¶å€™ä½ æ— æ³•æ•è·ã€‚è¯´ç™½äº†å°±æ˜¯ç”¨æˆ·çš„è´­ä¹°æµç¨‹è·Ÿ App ç”Ÿå‘½å‘¨æœŸä¸æŒ‚é’©å¯¼è‡´çš„ï¼Œå…¸å‹çš„æœ‰ä»¥ä¸‹å‡ ä¸ªåœºæ™¯&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;ç”¨æˆ·æ€æ­»äº† App&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·éœ€è¦æ›´æ–°å¸å·ä¸­çš„ä»˜è´¹ä¿¡æ¯ï¼ˆæ­¤æ—¶å·²è·³å‡º App ï¼‰&lt;/li&gt;
&lt;li&gt;App é—ªé€€&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·è¿›è¡Œäº†è®¢é˜…ç»­æœŸ&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·è¿›å…¥äº†æ¨ä»‹ä¿ƒé”€ä»·çš„æµç¨‹&lt;/li&gt;
&lt;li&gt;ç”¨æˆ·è·³å‡º App è¾“å…¥æ¨å¹¿ç &lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;ç»“æŸäº¤æ˜“&#34;&gt;ç»“æŸäº¤æ˜“&lt;/h2&gt;

&lt;p&gt;åœ¨æœ€åä¸€æ­¥ä¸­ï¼Œå¦‚æœæ˜¯æ­£å¸¸çš„äº¤ï§ ï¼Œé‚£ä¹ˆç®€å•çš„ç»“æŸå®ƒä»¬å°±â¾ï¦ºã€‚ä½†å¯¹äºå…¶ä»–å¼‚å¸¸çš„äº¤æ˜“ï§ ï¼Œâ½æ¯”å¦‚å‡ºç°ï¦ºä¸€äº› errorï¼Œä¹Ÿè¦å¦¥å–„çš„ç»“æŸå®ƒä»¬ã€‚å¦‚æœæ˜¯â¾ƒåŠ¨ç»­æœŸçš„è®¢é˜…ï¼Œä¹Ÿä¼šç»è¿‡è¿™ä¸€æ­¥ã€‚å¦‚æœ äº¤ï§ æ²¡æœ‰è¢«æ­£ç¡®çš„ç»“æŸï¼Œå®ƒä»¬ä¼šä¸€ç›´åœç•™ï§åœ¨ä¸Šæ–‡æåˆ°çš„é˜Ÿï¦œä¸­ï¼Œæ¯æ¬¡å›è°ƒå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œé˜Ÿåˆ— ä¸­éƒ½ä¼šæœ‰è¿™äº›æ²¡æœ‰è¢«ç»“æŸçš„äº¤ï§ ã€‚ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆéœ€è¦æå‰ç›‘å¬çš„åŸå› äº†ã€‚&lt;/p&gt;

&lt;p&gt;ç»“æŸäº¤ï§ çš„ä»£ç â¾®å¸¸ç®€å•ï¼Œåªæœ‰ä¸€ï¨ˆ:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;SKPaymentQueue.default().finishTransaction(transaction)
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;å…³äº-transaction-å’Œ-receipt-çš„åŒºåˆ«å’Œè”ç³»&#34;&gt;å…³äº Transaction å’Œ Receipt çš„åŒºåˆ«å’Œè”ç³»&lt;/h3&gt;

&lt;p&gt;å¾ˆå¤šåŒå­¦åœ¨è¿›è¡Œ IAP å¼€å‘çš„æ—¶å€™å¸¸å¸¸æœ‰ä¸€ä¸ªå¾ˆå¤§çš„å›°æƒ‘å°±æ˜¯ Transaction å’Œ Receipt å‚»å‚»åˆ†ä¸æ¸…æ¥šï¼Œè¿™é‡Œé‡æ–°æ¢³ç†äº†ä¸€ä¸‹ã€‚&lt;/p&gt;

&lt;h4 id=&#34;å…³äº-transaction&#34;&gt;å…³äº Transaction&lt;/h4&gt;

&lt;p&gt;å…¶å®å‰é¢è®² Payment çš„æ“ä½œçš„æ—¶å€™å·²ç»è¡¨æ˜äº†ï¼Œ Transaction æ˜¯å’Œå…·ä½“çš„ä¸€æ¬¡ Payment å¯¹åº”çš„ï¼Œä¹Ÿå°±æ˜¯å‘ç”Ÿä¸€æ¬¡ Payment å°±ä¼šç”Ÿæˆ Transactionï¼Œä½†æ˜¯ï¼Œå¹¶ä¸æ˜¯ 1 å¯¹ 1 çš„å…³ç³»ï¼Œæ¯”å¦‚æœ¬æ¬¡ Payment å¯¹åº”çš„ Transaction å·²ç»è¢« finish äº†ï¼Œç”¨æˆ·æ¢äº†æ‰‹æœºï¼Œç™»é™†åŒæ · AppleID çš„æ—¶å€™ä½¿ç”¨ Restore åŠŸèƒ½ï¼ŒApple ä¼šç”Ÿæˆ Transaction ç»™ä½ ï¼Œæœ¬æ¬¡çš„ Transaction å°±å¯¹åº”çš„ä¹‹å‰çš„ Paymentï¼Œåªæ˜¯çŠ¶æ€æ ‡è®°ä¸º .restoredã€‚&lt;/p&gt;

&lt;p&gt;Transaction çš„çŠ¶æ€ä¸»è¦æœ‰ä»¥ä¸‹è¿™ä¹ˆå‡ ç§ï¼š&lt;/p&gt;

&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th align=&#34;left&#34;&gt;çŠ¶æ€&lt;/th&gt;
&lt;th align=&#34;left&#34;&gt;å«ä¹‰&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;

&lt;tbody&gt;
&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;.purchasing&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ä¸éœ€è¦åšä»€ä¹ˆï¼Œç»§ç»­ç­‰å¾… SKPaymentTransactionState çš„çŠ¶æ€æµè½¬&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;.purchased&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ç”¨æˆ·å·²å®Œæˆä»˜è´¹ï¼Œå¤„ç†ä»˜è´¹åçš„æµç¨‹å¹¶è°ƒç”¨ finishTransaction æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;.failed&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ç”¨æˆ·ä»˜è´¹å¤±è´¥ï¼Œå¤„ç†ä»˜è´¹å¤±è´¥çš„æµç¨‹å¹¶è°ƒç”¨ finishTransaction æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;.restored&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ç”¨æˆ·ä»˜è´¹æˆåŠŸï¼Œå¤„ç†ä»˜è´¹åçš„æµç¨‹å¹¶è°ƒç”¨ finishTransaction æ–¹æ³•&lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
&lt;td align=&#34;left&#34;&gt;.deferred&lt;/td&gt;
&lt;td align=&#34;left&#34;&gt;ä¸éœ€è¦åšä»€ä¹ˆï¼Œç»§ç»­ç­‰å¾… SKPaymentTransactionState çš„çŠ¶æ€æµè½¬&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;&lt;strong&gt;Note&lt;/strong&gt;: å¯¹äº &lt;code&gt;finishTransaction&lt;/code&gt; çš„å‡ ç‚¹è¯´æ˜ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å¯¹äºé‚£äº›ä¾èµ–è‹¹æœä¸‹è½½æœåŠ¡çš„ï¼Œæ¯”å¦‚å­˜å‚¨åœ¨ iTunes Connect ä¸Šçš„ä»˜è´¹å†…å®¹è¦ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå¦‚æœä¸‹è½½å®Œæˆä¹‹å‰å°±è¿›è¡Œäº† finish åŠ¨ä½œä¼šå¯¼è‡´ Apple é˜»æ–­æ‰€æœ‰çš„ä¸‹è½½æµç¨‹ï¼Œå¹¶ä¸”æ— æ³•é‡æ–°ä¸‹è½½ï¼›&lt;/li&gt;
&lt;li&gt;Transaction éœ€è¦é…åˆ Receipt éªŒè¯æ˜¯å¦åˆæ³•ï¼Œå•çº¯é å‰ç«¯æ˜¯ä¸é è°±çš„ï¼Œå› æ­¤äº¤ç”±ä¸šåŠ¡åç«¯éªŒè¯ Receipt æ›´å®‰å…¨åˆç†ï¼Œä¸šåŠ¡åç«¯æ¥å†³å®šæ˜¯å¦éœ€è¦ finish&lt;/li&gt;
&lt;li&gt;æ–‡æ¡£é‡Œè¯´ï¼šYour app needs to finish every transaction, regardless of whether the transaction succeeded or failed. æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°† Transaction Finish æ‰ï¼Œå¦åˆ™ä¼šå§‹ç»ˆå‡ºç°åœ¨ PaymentQueue é‡Œï¼ŒBUTï¼Œä¸­é—´æ€çš„äº¤æ˜“æ˜¯ä¸éœ€è¦ finish çš„ï¼Œæ¯”å¦‚ .purchasing å’Œ .deferred&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;å…³äº-receipt&#34;&gt;å…³äº Receipt&lt;/h4&gt;

&lt;p&gt;Receipt æ˜¯ App Store ç­¾å‘çš„ï¼Œæ˜¯ä½ çš„ App ä¸Šå’Œè¯¥ App ä¸Šå‘ç”Ÿçš„æ”¯ä»˜è¡Œä¸ºè®°å½•ã€‚å®ƒå­˜å‚¨åœ¨è®¾å¤‡ä¸Šçš„æŸä¸ªå›ºå®šåœ°å€ï¼ŒStoreKit å¹¶ä¸ä¼šç”Ÿæˆå®ƒï¼Œå®ƒæ˜¯ä» App Store æ‹‰å–ä¸‹æ¥çš„ä¸€ä¸ªæ–‡ä»¶ã€‚å¦‚å›¾æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
guard let url = Bundle.main.appStoreReceiptURL else {
    // handle failure
    return
}

// read the contents
let receipt = Data(contentsOf: url)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœæœ¬åœ°è¯¥åœ°å€é‡Œæ²¡æœ‰ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¿›è¡Œåˆ·æ–°ï¼Œå®è´¨ä¸Šå°±æ˜¯ä» App Store è¯·æ±‚ Receipt æ•°æ®ã€‚è¯·æ±‚å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let request = SKReceiptRefreshRequest()

request.delegate = self

request.start()
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;è¿™é‡Œæœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹&#34;&gt;è¿™é‡Œæœ‰å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ï¼š&lt;/h2&gt;

&lt;h3 id=&#34;æ¢å¤å·²ç»è´­ä¹°çš„å•†å“&#34;&gt;æ¢å¤å·²ç»è´­ä¹°çš„å•†å“&lt;/h3&gt;

&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„äº‹æƒ…å°±æ˜¯ï¼šå¦‚æœä¸€ä¸ªç”¨æˆ·è¯•å›¾å»è´­ä¹°ä¸€ä¸ªä¹‹å‰è´­ä¹°è¿‡çš„å•†å“ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ä½ App æä¾›çš„ Restore åŠŸèƒ½æ¢å¤çš„è¯ï¼ŒApp Store ä¼šä¾ç„¶åˆ›å»ºä¸€ä¸ªæ­£å¸¸çš„æ–°äº¤æ˜“ã€‚ç”¨æˆ·æ˜¯ä¸ä¼šè¢«å†æ¬¡æ”¶è´¹çš„ï¼Œè¿™é‡Œçš„é—®é¢˜æ˜¯ï¼ŒTransaction çš„çŠ¶æ€å¯ä¸æ˜¯ restoredï¼Œè€Œæ˜¯å®Œå…¨æ–°çš„ Transactionï¼Œä½ å¯ä»¥æŒ‰ç…§ä¹‹å‰çš„æ­£å¸¸æµç¨‹èµ°ï¼Œå½“ç„¶å¯¹äºè‡ªå¸¦è´¦æˆ·ä½“ç³»çš„ App æ¥è®²ï¼Œéœ€è¦è‡ªè¡Œåˆ¤æ–­å’Œè®¡ç®—ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å‚è€ƒèµ„æ–™&#34;&gt;å‚è€ƒèµ„æ–™ï¼š&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/in-app-purchase/&#34;&gt;In App Purchase&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Introduction.html&#34;&gt;In-App Purchase Programming Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Introduction.html&#34;&gt;Receipt Validation Programming Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://forums.developer.apple.com/thread/46737&#34;&gt;How to detect refunded IAPs from receipts?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://stackoverflow.com/questions/10771240/check-if-a-non-renewable-subscription-was-refunded-by-apple&#34;&gt;Check if a non-renewable subscription was refunded by Apple?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://stackoverflow.com/questions/6439482/how-does-apple-notify-ios-apps-of-refunds-of-in-app-purchases-iap&#34;&gt;How does Apple notify iOS apps of refunds of in-app purchases (IAP)?&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
      
    </item>
    
    <item>
      <title>åœ¨ Swift ä¸­ä½¿ç”¨å·¥å‚æ¨¡å¼è¿›è¡Œä¾èµ–æ³¨å…¥</title>
      <link>https://hechen.xyz/post/dependency-injection-using-factories-in-swift/</link>
      <pubDate>Sun, 19 Nov 2017 18:17:15 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/dependency-injection-using-factories-in-swift/</guid>
      
        <description>

&lt;p&gt;ä¾èµ–æ³¨å…¥æ˜¯ä¸€é¡¹ä½¿å¾—ä»£ç æ›´åŠ å¯æµ‹è¯•çš„å…³é”®å·¥å…·ã€‚æˆ‘ä»¬ä¸éœ€è¦æŒæœ‰æŸäº›å¯¹è±¡ï¼Œæˆ–è€…åˆ›å»ºè¿™äº›å¯¹è±¡çš„è‡ªæœ‰ä¾èµ–ï¼Œæˆ–è€…é€šè¿‡å•ä¾‹æ¥è·å–ä»–ä»¬ï¼Œè€Œæ˜¯å°½å¯èƒ½ä½¿é‚£äº›å¯¹è±¡èƒ½å¤Ÿæ­£å¸¸è¿è½¬æ‰€å¿…é¡»çš„ä¸€åˆ‡å†…å®¹ï¼ˆå…¶ä»–å¯¹è±¡ï¼‰é€šè¿‡å¤–ç•Œä¼ å…¥ï¼Œè¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼Œä¸€æ–¹é¢èƒ½æ¸…æ™°çš„çœ‹å¾—åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰ä¾èµ–é¡¹ï¼Œå¦ä¸€æ–¹ä¾¿ä¹Ÿä½¿å¾—æµ‹è¯•å·¥ä½œå˜å¾—æ›´ä¸ºç®€å•ï¼ˆå› ä¸ºæˆ‘ä»¬å¯ä»¥æ¨¡æ‹Ÿè¿™äº›ä¾èµ–é¡¹æ¥æ•è·ã€éªŒè¯çŠ¶æ€ä»¥åŠå€¼ã€‚ï¼‰&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œå°½ç®¡ä¾èµ–æ³¨å…¥ç¡®å®å¾ˆæœ‰ç”¨ï¼Œä½†æ˜¯å½“åœ¨å·¥ç¨‹ä¸­å¹¿æ³›ä½¿ç”¨çš„æ—¶å€™è¿˜æ˜¯ä¼šæœ‰ä¸€äº›ç—›ç‚¹ã€‚éšç€æŸä¸ªå¯¹è±¡çš„ä¾èµ–é¡¹è¶Šæ¥è¶Šå¤šï¼Œåˆå§‹åŒ–è¯¥å¯¹è±¡å°±å˜å¾—è¶Šæ¥è¶Šè¹©è„šã€‚è™½ç„¶ä½¿å¾—ä»£ç å¯æµ‹æ²¡æ¯›ç—…ï¼Œä½†æ˜¯å¦‚æœåƒä¸‹é¢è¿™ç§æ¯æ¬¡éœ€è¦è¿™æ ·æ¥å†™åˆå§‹åŒ–æ–¹æ³•ï¼Œä¹Ÿå¤ªä¸çˆ½äº†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class UserManager {
    init(dataLoader: DataLoader, database: Database, cache: Cache,
        keychain: Keychain, tokenManager: TokenManager) {
        // ...
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œè¿™å‘¨å’±ä»¬æ¥æ·±å…¥äº†è§£ä¸€ä¸‹æŸç§ä¾èµ–æ³¨å…¥çš„æŠ€å·§ï¼Œä½¿å¾—æˆ‘ä»¬çš„ä»£ç ä¸å¤±å»å¯æµ‹æ€§ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦å†å¼ºè¿«è‡ªå·±å»å†™ä¸€å›¢åˆå§‹åŒ–æ–¹æ³•æˆ–è€…å¤æ‚çš„ä¾èµ–ç®¡ç†çš„ä»£ç ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ä¼ é€’ä¾èµ–é¡¹&#34;&gt;ä¼ é€’ä¾èµ–é¡¹&lt;/h2&gt;

&lt;p&gt;æˆ‘ä»¬é‡åˆ°ä¸Šé¢ä»£ç  demo ä¸­çš„é—®é¢˜ï¼Œæœ€ä¸»è¦çš„åŸå› æ˜¯æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¹ˆå¤šä¾èµ–é¡¹ä¼ é€’ç»™æŸä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿ä¹‹åæ¥ä½¿ç”¨ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨æ„å»ºä¸€ä¸ªæ¶ˆæ¯æ”¶å‘çš„ Appï¼Œè¿™é‡Œæœ‰ä¸€ä¸ª view controller éœ€è¦å±•ç¤ºæŸä¸ªç”¨æˆ·æ‰€æœ‰çš„æ¶ˆæ¯ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class MessageListViewController: UITableViewController {
    private let loader: MessageLoader

    init(loader: MessageLoader) {
        self.loader = loader
        super.init(nibName: nil, bundle: nil)
    }

    override func viewWillAppear(_Â animated: Bool) {
        super.viewWillAppear(animated)

        loader.load { [weak self]() messages in
            self?.reloadTableView(with: messages)
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚ä¸Šä»£ç èƒ½çœ‹åˆ°ï¼Œæˆ‘ä»¬ç»™ &lt;code&gt;MessageListViewController&lt;/code&gt; ä¼ å…¥æŸä¸ªä¾èµ–é¡¹ &lt;code&gt;MessageLoader&lt;/code&gt;ï¼Œä¹‹åå…¶è¢«ç”¨æ¥åŠ è½½æ•°æ®ã€‚è¿™é‡Œå…¶å®å¹¶æ²¡æœ‰å¤ªå¤§çš„é—®é¢˜ï¼Œå› ä¸ºä»…ä»…åªæœ‰ä¸€ä¸ªä¾èµ–è€Œå·²ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬çš„åˆ—è¡¨è§†å›¾å¹¶ä¸æ˜¯ä¸€ä¸ªæ­»æ°”æ²‰æ²‰çš„å±•ç¤ºè€Œå·²ï¼ŒæŸäº›çŠ¶æ€ä¸‹è¿˜éœ€è¦ä»¬è¿›è¡Œå¯¼èˆªåˆ°æŸè§†å›¾æ§åˆ¶å™¨çš„å·¥ä½œã€‚&lt;/p&gt;

&lt;p&gt;å…·ä½“æ¥è®²ï¼Œæˆ‘ä»¬æƒ³è®©ç”¨æˆ·åœ¨ç‚¹å‡»æ¶ˆæ¯åˆ—è¡¨ä¸­æŸä¸ª cell çš„æ—¶å€™ï¼Œå¯¼èˆªåˆ°ä¸€ä¸ªæ–°çš„è§†å›¾ä¸­ã€‚æˆ‘ä»¬ä¸ºè¿™ä¸ªæ–°çš„è§†å›¾åˆ›å»ºä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ &lt;code&gt;MessageViewController&lt;/code&gt;ï¼Œä½¿å¾—ç”¨æˆ·èƒ½å¤Ÿå•ç‹¬æŸ¥çœ‹æŸæ¡æ¶ˆæ¯ï¼Œå¹¶ä¸”èƒ½å¤Ÿå›å¤è¯¥æ¶ˆæ¯ã€‚ä¸ºäº†è¯¥åŠŸèƒ½ï¼Œæˆ‘ä»¬å®ç°äº† &lt;code&gt;MessageSender&lt;/code&gt; ç±»ï¼Œå½“åˆ›å»ºè¯¥ç±»çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°†å‰é¢é‚£ä¸ªæ–°çš„è§†å›¾æ§åˆ¶å™¨ä¼ é€’ç»™ä»–ï¼Œä»£ç ç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;override func tableView(_Â tableView: UITableView, didSelectRowAt indexPath: IndexPath) {
    let message = messages[indexPath.row]()
    let viewController = MessageViewController(message: message, sender: sender)
    navigationController?.pushViewController(viewController, animated: true)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é—®é¢˜æ¥äº†ï¼Œ&lt;code&gt;MessageViewController&lt;/code&gt; éœ€è¦æœ‰ä¸€ä¸ª &lt;code&gt;MessageSender&lt;/code&gt; å®ä¾‹ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä½¿å¾— &lt;code&gt;MessageListViewController&lt;/code&gt; çœ‹åˆ°è¯¥ç±»ã€‚ä¸€ç§åŠæ³•å°±æ˜¯ç®€å•çš„ï¼Œå°† sender åŠ å…¥åˆ° åˆ—è¡¨è§†å›¾æ§åˆ¶å™¨çš„åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class MessageListViewController: UITableViewController {
    init(loader: MessageLoader, sender: MessageSender) {
        ...
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸€æ—¦å¦‚ä¸Šé¢è¿™æ ·å¼€å§‹å†™ä»£ç ï¼Œæˆ‘ä»¬å°±é€æ­¥çš„è¿›å…¥åºå¤§åˆå§‹åŒ–æ–¹æ³•çš„ä¸å½’è·¯ä¸Šå’¯ï¼Œç„¶åä½¿å¾— &lt;code&gt;MessageListViewController&lt;/code&gt; ä¼šå˜å¾—è¶Šæ¥è¶Šéš¾ç”¨ï¼ˆä¹Ÿä¼šè®©è°ƒç”¨è¿™å¾ˆå›°æƒ‘ï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªåˆ—è¡¨è§†å›¾æ§åˆ¶å™¨è¿˜éœ€è¦å…³å¿ƒæŸä¸ªå‘é€æ¶ˆæ¯çš„äººï¼Ÿï¼‰ã€‚&lt;/p&gt;

&lt;p&gt;å¦å¤–ä¸€ä¸ªå¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼ˆä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¸¸ç”¨çš„è§£å†³æ–¹æ¡ˆï¼‰ï¼Œå°±æ˜¯æŠŠ MessageSender åšæˆä¸€ä¸ªå•ä¾‹ï¼Œè¿™æ ·çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆå®¹æ˜“åœ¨ä»»ä½•åœ°æ–¹å–åˆ°ä»–çš„å€¼ï¼Œä¹Ÿå¯ä»¥éšæ—¶å°†å•ä¾‹å¯¹è±¡æ³¨å…¥&lt;code&gt;MessageViewController&lt;/code&gt; ä¸­ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let viewController = MessageViewController(
    message: message,
    sender: MessageSender.shared
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶è€Œï¼Œå°±å¦‚ &lt;a href=&#34;https://www.swiftbysundell.com/posts/avoiding-singletons-in-swift&#34;&gt;Avoiding singletons in Swift&lt;/a&gt; è¿™ç¯‡æ–‡ç« ä¸­è®²çš„ï¼Œå•ä¾‹è¿™ç§æ–¹å¼ä¼šä¼´éšä¸€äº›æ˜æ˜¾çš„ç¼ºé™·ï¼Œå¯¼è‡´æˆ‘ä»¬ä¼šéš¾ä»¥çœ‹æ¸…ä¾èµ–å…³ç³»ï¼Œä»è€Œå¯¹æ•´ä¸ªæ¡†æ¶éƒ½éš¾ä»¥ç†è§£ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å·¥å‚æ¨¡å¼æ¥æ•‘åœº&#34;&gt;å·¥å‚æ¨¡å¼æ¥æ•‘åœº&lt;/h2&gt;

&lt;p&gt;Wouldn&amp;rsquo;t it be nice if we could just skip all of the above, and enable MessageListViewController to be completely unaware of MessageSender, and all other dependencies that any subsequent view controllers might need?&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿé¿å…æ‰ä¸Šé¢è¿™äº›é—®é¢˜ï¼Œèƒ½å¤Ÿä½¿å¾— &lt;code&gt;MessageListViewController&lt;/code&gt; å®Œå…¨ä¸å…³å¿ƒ &lt;code&gt;MessageSender&lt;/code&gt;ï¼Œç”šè‡³æ˜¯åç»­çš„è§†å›¾æ§åˆ¶å™¨çš„å…¶ä»–ä¾èµ–ï¼Œå²‚ä¸æ˜¯å¾ˆçˆ½ï¼Ÿ&lt;/p&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬æœ‰æŸç§å½¢å¼çš„å·¥å‚ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å…¶ä¼ å…¥æŒ‡å®šçš„ messageï¼Œç„¶åå¾ˆæ–¹ä¾¿çš„äº§å‡ºä¸€ä¸ª &lt;code&gt;MessageViewController&lt;/code&gt; å‡ºæ¥ï¼Œç±»ä¼¼ä¸‹é¢è¿™æ ·ï¼Œå°±èƒ½å¤Ÿå¾ˆæ–¹ä¾¿å¹¶ä¸”ç®€æ´çš„å®ç°ä¸Šé¢çš„ç†æƒ³ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let viewController = factory.makeMessageViewController(for: message)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚ &lt;a href=&#34;https://www.swiftbysundell.com/posts/using-the-factory-pattern-to-avoid-shared-state-in-swift?rq=factories&#34;&gt;Using the factory pattern to avoid shared state in Swift&lt;/a&gt; è¿™ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬çœ‹åˆ°çš„ï¼Œå…³äºå·¥å‚æ¨¡å¼ä¸­ï¼Œæˆ‘æœ€å–œæ¬¢çš„ä¸€ç‚¹å°±æ˜¯ï¼Œä»–èƒ½å¤Ÿä½¿å¾—ä½ å°†æŸä¸ªå¯¹è±¡çš„åˆ›å»ºå’Œä½¿ç”¨ä¸¤è€…è§£è€¦ï¼Œä¹Ÿèƒ½ä½¿å¾—è®¸å¤šå¯¹è±¡å’Œè¿™äº›å¯¹è±¡çš„ä¾èµ–ä¹‹é—´æœ‰ä¸€ä¸ªç›¸å¯¹è§£è€¦çš„å…³ç³»ï¼Œè¿›è€Œèƒ½ä½¿å¾—æˆ‘ä»¬æƒ³é‡æ„ä»£ç æˆ–è€…ä¿®æ”¹æŸäº›éƒ¨åˆ†çš„æ—¶å€™ç›¸å¯¹æ›´å®¹æ˜“ä¸€äº›ã€‚&lt;/p&gt;

&lt;h3 id=&#34;é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢&#34;&gt;é‚£æˆ‘ä»¬è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ&lt;/h3&gt;

&lt;p&gt;é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå·¥å‚åè®®ï¼Œè¯¥åè®®ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿåœ¨å¹¶ä¸çŸ¥é“æŸä¸ªè§†å›¾æ§åˆ¶å™¨çš„ä¾èµ–é¡¹æˆ–è€…å…¶åˆå§‹åŒ–æ–¹æ³•çš„å‰æä¸‹ï¼Œå¾ˆå®¹æ˜“çš„åœ¨æˆ‘ä»¬çš„åº”ç”¨ä¸­åˆ›å»ºå‡ºæˆ‘ä»¬éœ€è¦çš„ä»»æ„çš„è§†å›¾æ§åˆ¶å™¨ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;protocol ViewControllerFactory {
    func makeMessageListViewController() -&amp;gt; MessageListViewController
    func makeMessageViewController(for message: Message) -&amp;gt; MessageViewController
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;åˆ°è¿™é‡Œæˆ‘ä»¬è¿˜ä¸èƒ½åœæ­¢ã€‚æˆ‘ä»¬åŒæ ·ä¸ºå·¥å‚æ·»åŠ ä¸€äº›é™„ä»¶çš„åè®®ç”¨æ¥åˆ›å»ºè§†å›¾æ§åˆ¶å™¨çš„ä¾èµ–ï¼Œæ¯”å¦‚ä¸‹é¢è¿™ä¸ªåè®®ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥ä¸ºæŸä¸ªåˆ—è¡¨è§†å›¾æ§åˆ¶å™¨ç”Ÿæˆä¸€ä¸ª &lt;code&gt;MessageLoader&lt;/code&gt; å‡ºæ¥ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;protocol MessageLoaderFactory {
    func makeMessageLoader() -&amp;gt; MessageLoader
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;å•ä¾‹ä¾èµ–&#34;&gt;å•ä¾‹ä¾èµ–&lt;/h2&gt;

&lt;p&gt;ä¸€æ—¦æˆ‘ä»¬å‡†å¤‡å¥½è¿™äº›å·¥å‚åè®®ä¹‹åï¼Œå›åˆ°ä¸Šé¢ &lt;code&gt;MessageListViewController&lt;/code&gt; çš„åœ°æ–¹ï¼Œé‡æ„è¿™æ®µä»£ç ï¼Œæ— éœ€ä½¿ç”¨å…¶ä¾èµ–é¡¹çš„å®ä¾‹è€Œæ˜¯ç®€å•çš„å¼•å…¥ä¸€ä¸ªå·¥å‚å®ä¾‹å³å¯ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class MessageListViewController: UITableViewController {
    
    
    typealias Factory = MessageLoaderFactory &amp;amp; ViewControllerFactory

    private let factory: Factory
    
    private lazy var loader = factory.makeMessageLoader()

    init(factory: Factory) {
        self.factory = factory
        super.init(nibName: nil, bundle: nil)
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€šè¿‡ä¸Šé¢è¿™ä¹ˆåšï¼Œæˆ‘ä»¬å¯ä»¥åšåˆ°ä¸¤ç‚¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æˆ‘ä»¬å°†ä¸€å †ä¾èµ–é¡¹ç®€åŒ–æˆäº†ä¸€ä¸ªå•ä¸€çš„å·¥å‚ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MessageListViewController&lt;/code&gt; æ— éœ€å†éœ€å†å…³å¿ƒ &lt;code&gt;MessageViewController&lt;/code&gt; çš„ä¾èµ–é¡¹äº†&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&#34;ä¸€ä¸ªä½¿ç”¨-container-çš„ä¾‹å­&#34;&gt;ä¸€ä¸ªä½¿ç”¨ Container çš„ä¾‹å­&lt;/h2&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯¥å®ç°å·¥å‚åè®®äº†ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ª &lt;code&gt;DependencyContainer&lt;/code&gt;ï¼Œè¯¥å¯¹è±¡ä¼šåŒ…å«æˆ‘ä»¬åº”ç”¨ä¸­é‚£äº›æ­£å¸¸æƒ…å†µä¸‹ä¼šè¢«ç›´æ¥ç”¨æ¥ä½œä¸ºä¾èµ–çš„æ ¸å¿ƒå·¥å…·å¯¹è±¡ä»¬ã€‚è¿™äº›ä¸ä»…ä»…åŒ…æ‹¬ç±»ä¼¼ä¹‹å‰ &lt;code&gt;MessageSender&lt;/code&gt;ï¼Œä¹ŸåŒ…æ‹¬æ›´åŠ åº•å±‚çš„ä¸šåŠ¡é€»è¾‘ä¸Šçš„ç±»ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯èƒ½ä¼šç”¨åˆ° &lt;code&gt;NetworkManager&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class DependencyContainer {
    private lazy var messageSender = MessageSender(networkManager: networkManager)
    private lazy var networkManager = NetworkManager(urlSession: .shared)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»ä¸Šé¢è¿™æ®µä»£ç ï¼Œä½ èƒ½çœ‹åˆ°ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†æ‡’åŠ è½½å±æ€§ä»¥ä¾¿èƒ½å¤Ÿåœ¨åˆå§‹åŒ–è¯¥å¯¹è±¡çš„æ—¶å€™èƒ½å¤Ÿå¼•ç”¨ç›¸åŒç±»ä¸­çš„å…¶ä»–å±æ€§ã€‚è¿™æ˜¯è®¾ç½®ä½ ä¾èµ–å…³ç³»çš„ä¸€ç§éå¸¸æ–¹ä¾¿è€Œä¸”ä¼˜é›…çš„æ–¹å¼ï¼Œä½ å¯ä»¥åˆ©ç”¨ç¼–è¯‘å™¨å¸®åŠ©ä½ é¿å…æ¯”å¦‚&lt;a href=&#34;https://en.wikipedia.org/wiki/Circular_dependency&#34;&gt;å¼•ç”¨å¾ªç¯&lt;/a&gt;ç­‰é—®é¢˜ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬ä¸º &lt;code&gt;DependencyContainer&lt;/code&gt; å®ç°æˆ‘ä»¬çš„å·¥å‚åè®®ï¼Œä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿå°†è¯¥å·¥å‚æ³¨å…¥å„ç§è§†å›¾æ§åˆ¶å™¨æˆ–å…¶ä»–å¯¹è±¡ä¸­ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;extension DependencyContainer: ViewControllerFactory {
    func makeMessageListViewController() -&amp;gt; MessageListViewController {
        return MessageListViewController(factory: self)
    }

    func makeMessageViewController(for message: Message) -&amp;gt; MessageViewController {
        return MessageViewController(message: message, sender: messageSender)
    }
}

extension DependencyContainer: MessageLoaderFactory {
    func makeMessageLoader() -&amp;gt; MessageLoader {
        return MessageLoader(networkManager: networkManager)
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;åˆ†å¸ƒå¼çš„æ‰€æœ‰æƒ&#34;&gt;åˆ†å¸ƒå¼çš„æ‰€æœ‰æƒ&lt;/h2&gt;

&lt;p&gt;æœ€åä¸€æ­¥äº†ï¼Œæˆ‘ä»¬åœ¨å“ªé‡Œå®é™…å‚¨å­˜ä¾èµ–å­˜å‚¨å™¨ï¼Œè°åº”è¯¥æ‹¥æœ‰å®ƒï¼Ÿå®ƒåº”è¯¥åœ¨å“ªé‡Œè®¾ç½®ï¼Ÿè¿™é‡Œæœ‰äº›æ¯”è¾ƒ cool çš„äº‹æƒ…å°±æ˜¯ï¼Œç”±äºæˆ‘ä»¬æŠŠä¾èµ–å®¹å™¨ä½œä¸ºå¯¹è±¡ä»¬æ‰€éœ€è¦çš„å·¥å‚çš„ä¸€ç§å®ç°ï¼Œè€Œå¯¹è±¡ä»¬å¼ºæŒæœ‰å…¶å·¥å‚ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å…¶å®æ— éœ€åœ¨ä»»ä½•åœ°æ–¹å‚¨å­˜è¯¥ä¾èµ–å®¹å™¨ã€‚&lt;/p&gt;

&lt;p&gt;ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœ &lt;code&gt;MessageListViewController&lt;/code&gt; æ˜¯æˆ‘ä»¬åº”ç”¨çš„åˆå§‹åŒ–è§†å›¾æ§åˆ¶å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•çš„åˆ›å»ºä¸€ä¸ª &lt;code&gt;DependencyContainer&lt;/code&gt; çš„å®ä¾‹ä¼ å…¥ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let container = DependencyContainer()
let listViewController = container.makeMessageListViewController()

window.rootViewController = UINavigationController(
    rootViewController: listViewController
)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ— éœ€ä¿ç•™ä»»ä½•å…¨å±€çš„å˜é‡æˆ–è€…åœ¨ app delegate ä¸­ä½¿ç”¨å¯é€‰å±æ€§ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;ä½¿ç”¨å·¥å‚åè®®å’Œå®¹å™¨é…ç½®ä¾èµ–æ³¨å…¥æ˜¯ä¸€ç§å¾ˆå¥½çš„æ–¹å¼ï¼Œå…¶å¯ä»¥é¿å…éœ€è¦ä¼ é€’å¤§é‡ä¾èµ–è€Œåˆ›å»ºå¾ˆå¤æ‚çš„åˆå§‹åŒ–æ–¹æ³•ã€‚å®ƒå¯ä»¥ä½¿å¾—ä¾èµ–æ³¨å…¥ä½¿ç”¨èµ·æ¥æ›´åŠ æ–¹ä¾¿ï¼Œä½¿å¾—ä½ èƒ½å¤Ÿå¯¹è‡ªå·±åˆ›å»ºçš„å¯¹è±¡å®é™…çš„ä¾èµ–å…³ç³»æœ‰å¾ˆæ˜æ™°çš„åˆ¤æ–­ï¼Œä¹Ÿä½¿å¾—æµ‹è¯•æ›´åŠ ç®€å•ã€‚&lt;/p&gt;

&lt;p&gt;å› ä¸ºæˆ‘ä»¬èƒ½å¤ŸæŠŠå·¥å‚å®šä¹‰ä¸ºåè®®ï¼Œå› æ­¤å¯ä»¥å¾ˆå®¹æ˜“çš„åœ¨æµ‹è¯•ä¸­é€šè¿‡ç»™å®šä¸åŒæµ‹è¯•æŒ‡å®šç‰ˆæœ¬çš„å…·ä½“å®ç°æ¥æ¨¡æ‹Ÿè¾“å‡ºã€‚æœªæ¥æˆ‘ä¼šå†™å¤§é‡å…³äºæ¨¡æ‹Ÿæ•°æ®ä»¥åŠå¦‚ä½•åœ¨æµ‹è¯•ä¸­å……åˆ†åˆ©ç”¨ä¾èµ–æ³¨å…¥çš„åšæ–‡ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>æ¨¡å—åŒ– Xcode å·¥ç¨‹</title>
      <link>https://hechen.xyz/post/modular-xcode-projects/</link>
      <pubDate>Sun, 19 Nov 2017 18:17:15 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/modular-xcode-projects/</guid>
      
        <description>

&lt;p&gt;ä½¿ç”¨ Xcode æ„å»ºæ¨¡å—åŒ–çš„å·¥ç¨‹å°±éœ€è¦å¯¹å·¥ç¨‹ç»“æ„ä»¥åŠå…¶åŸºç¡€æ¦‚å¿µæœ‰å¾ˆå¥½çš„ç†è§£æ‰è¡Œã€‚&lt;!-- more --&gt; æˆ‘ä»¬å¹³æ—¶ä¸æ€ä¹ˆå…³æ³¨å·¥ç¨‹ç»“æ„æœ¬èº«ï¼Œåªæœ‰åœ¨å·¥ç¨‹é€æ¸å˜å¤§ï¼Œè¦æ·»åŠ æ›´å¤šä¾èµ–çš„æ—¶å€™æ‰ä¼šæ³¨æ„çš„åˆ°ã€‚è€Œå³ä½¿åˆ°äº†è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¤§å¤šæ•°çš„å·¥ç¨‹éƒ½ä¼šä½¿ç”¨  &lt;a href=&#34;https://cocoapods.org/&#34;&gt;CocoaPods&lt;/a&gt; æ¥è®¾ç½®é‚£äº›ä¾èµ–é¡¹ï¼Œæˆ–è€… &lt;a href=&#34;https://github.com/carthage&#34;&gt;Carthage&lt;/a&gt;, åè€…è™½ç„¶æ²¡æœ‰å¸®æˆ‘ä»¬åšä¾èµ–æ€§çš„è®¾ç½®ï¼Œä½†æ˜¯ä½¿å¾—æˆ‘ä»¬ä¼šæ›´å®¹æ˜“çš„ï¼Œé€šè¿‡åœ¨å·¥ç¨‹çš„ build phase é€‰é¡¹ä¸­æ·»åŠ ä¸€äº›å†…å®¹ï¼Œè¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚å½“é…ç½®é¡¹è¶Šæ¥è¶Šå¤æ‚ï¼Œæˆ‘ä»¬å°±å¾ˆå®¹æ˜“äº§ç”Ÿå›°æƒ‘ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰å®Œå…¨æŒæ¡ Xcode å·¥ç¨‹ä¸­æ‰€æ¶‰åŠçš„æ‰€æœ‰å…ƒç´ ã€‚æˆ‘ç»å¸¸è¢«é—®åˆ°çš„é—®é¢˜å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æˆ‘èƒ½ä¸èƒ½åœ¨å·¥ç¨‹é‡ŒåŒæ—¶ä½¿ç”¨ Carthageï¼ŒCocoapods ä»¥åŠè‡ªå·±ä¸ªäººçš„ä¾èµ–è®¾ç½®ï¼Ÿ&lt;/li&gt;
&lt;li&gt;æˆ‘æ·»åŠ äº†ä¾èµ–ï¼Œä½†æ˜¯å½“æ¨¡æ‹Ÿå™¨æ‰“å¼€ App çš„æ—¶å€™ Crash äº†ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºä»€ä¹ˆæˆ‘éœ€è¦åªåœ¨æŸäº› targets é‡ŒåµŒå…¥ frameworkï¼Ÿ&lt;/li&gt;
&lt;li&gt;æˆ‘çš„ framework åº”è¯¥æ˜¯é™æ€çš„è¿˜æ˜¯åŠ¨æ€çš„ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åœ¨è¿™ç¯‡åšæ–‡ä¸­ï¼Œæˆ‘ä¼šå¼•å¯¼ä½ éå† Xcode Project ä¸­çš„å„ä¸ªå…ƒç´ ï¼ŒæŒ‡å¯¼ä½ å¦‚ä½•é€šè¿‡æ”¹å˜è¿™äº›å…ƒç´ æ¥æ¨¡å—åŒ–ä½ çš„è®¾ç½®é¡¹ã€‚æˆ‘å¸Œæœ›ä¸‹æ¬¡ä½ é‡åˆ°ä¸Šé¢è¿™äº›é—®é¢˜çš„æ—¶å€™ï¼Œä½ ä¸éœ€è¦å†èŠ±å¤§é‡æ—¶é—´å– Stack Overflow ä¸ŠæŸ¥è¿™äº›ç¡®å®šçš„ç­”æ¡ˆã€‚&lt;/p&gt;

&lt;h3 id=&#34;elements&#34;&gt;Elements âš’&lt;/h3&gt;

&lt;h4 id=&#34;target&#34;&gt;Target&lt;/h4&gt;

&lt;p&gt;å·¥ç¨‹ï¼ˆProjectsï¼‰éƒ½æ˜¯ç”±å¤šä¸ªæ›´å°çš„å«åš target çš„å•å…ƒç»„æˆçš„ã€‚è¿™äº› target åŒ…å«ç¼–è¯‘ç‰¹å®šå¹³å°äº§å“ï¼Œæ¯”å¦‚ frameworks, libraries, apps, testing bundles, extensions ç­‰æ‰€éœ€è¦çš„é…ç½®ã€‚ ä½ å¯ä»¥åœ¨&lt;a href=&#34;https://github.com/xcodeswift/xcproj/blob/master/Sources/xcproj/PBXProductType.swift&#34;&gt;è¿™é‡Œ&lt;/a&gt;çœ‹åˆ° target æ‰€æœ‰å¯ç”¨çš„ç±»å‹ã€‚ Target å¯ä»¥ç›¸äº’ä¾èµ–ï¼Œå½“ä¸€ä¸ª target A ä¾èµ–å¦å¤–ä¸€ä¸ª target B çš„æ—¶å€™ï¼Œtarget B å°±ä¼šè¢«å…ˆæ„å»ºå‡ºæ¥ä»¥ä¾¿ target A ä½¿ç”¨å…¶äº§å‡ºã€‚è€Œ target çš„é…ç½®é¡¹ä¼šæ¶‰åŠä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Info.plist æ–‡ä»¶&lt;/strong&gt;: è¯¥æ–‡ä»¶åŒ…å«äº§å‡ºç‰¹å®šçš„è®¾ç½®é¡¹ï¼Œæ¯”å¦‚ ç‰ˆæœ¬ã€App çš„åå­—æˆ–è€… App çš„ç±»å‹ï¼Œä½ å¯ä»¥åœ¨&lt;a href=&#34;https://developer.apple.com/library/content/documentation/General/Reference/InfoPlistKeyReference/Introduction/Introduction.html&#34;&gt;è¿™é‡Œ&lt;/a&gt;è¯¦ç»†äº†è§£è¿™ä¸ªæ–‡ä»¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Entitlements&lt;/strong&gt;: å…¶æŒ‡å®šäº†åº”ç”¨çš„èƒ½åŠ›ã€‚å¦‚æœåœ¨æˆæƒæ–‡ä»¶ä¸­æŒ‡å®šçš„èƒ½åŠ›å’Œå¼€å‘è€…å¹³å°ä¸Šè®¾ç½®çš„æ— æ³•åŒ¹é…ï¼Œç­¾åè¿‡ç¨‹å°±ä¼šå‡ºé”™ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Build settings&lt;/strong&gt;: å¦‚å…¶åå­—æ‰€æè¿°çš„é‚£æ ·ï¼Œè¿™äº›éƒ½æ˜¯æ„å»º target æ‰€å¿…è¦çš„è®¾ç½®é¡¹ã€‚æ„å»ºè®¾ç½®é¡¹è¦ä¹ˆåœ¨ target è‡ªèº«å®šä¹‰æˆ–è€…åœ¨ &lt;code&gt;xcconfig&lt;/code&gt; æ–‡ä»¶ä¸­å®šä¹‰ã€‚ä¸€ä¸ª target çš„é…ç½®é¡¹å¯ä»¥ç»§æ‰¿è€Œæ¥ï¼Œé¦–å…ˆæ˜¯é…ç½®æ–‡ä»¶æœ¬èº«ï¼Œå…¶æ¬¡æ˜¯ target çš„é…ç½®é¡¹ï¼Œæœ€åæ˜¯ project é…ç½®é¡¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Build phases&lt;/strong&gt;: æ„å»ºæµæ°´çº¿ç”± build phase å®šä¹‰ã€‚å½“ä¸€ä¸ª target è¢«åˆ›å»ºå‡ºæ¥ä¹‹åï¼Œå…¶åŒ…å«é»˜è®¤çš„æ„å»ºé˜¶æ®µï¼ˆåŒ…å« *æ„å»ºæºç ã€æ‹·è´èµ„æºç­‰*ï¼‰ï¼Œä½†æ˜¯ä½ å¯ä»¥è‡ªè¡Œæ·»åŠ ä½ éœ€è¦çš„ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œè¿™äº›é˜¶æ®µé‡Œï¼Œæœ‰ä¸ª shell script phase å…è®¸ä½ åœ¨æ„å»ºè¿‡ç¨‹ä¸­æ‰§è¡Œä¸€äº›è„šæœ¬ã€‚è¿™äº›è„šæœ¬å¯ä»¥è¯»å– Xcode æš´éœ²å‡ºæ¥çš„é‚£äº›&lt;a href=&#34;http://ppinera.es/2017/09/15/modular-xcode-projects.html&#34;&gt;æ„å»ºå‚æ•°&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;åŸºäº&lt;code&gt;.xcconfig&lt;/code&gt;æ–‡ä»¶çš„å¯ç»„åˆæ€§ä»¥åŠå…¶å¯é‡ç”¨æ€§çš„è€ƒè™‘ï¼Œå¼ºçƒˆå»ºè®®ä½ åœ¨è¿™äº›æ–‡ä»¶ä¸­å®šä¹‰ä½ é‚£äº›ç¼–è¯‘è®¾ç½®ã€‚Target çš„é…ç½®ï¼Œæ¯”å¦‚ build setting ã€build phase ç­‰çš„å˜æ›´éƒ½ä½“ç°åœ¨ &lt;code&gt;.pbxproj&lt;/code&gt; æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä¸€ç§ç‰¹æ®Šçš„plist æ–‡ä»¶ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨ Git ç®¡ç†æˆ‘ä»¬çš„å·¥ç¨‹çš„æ—¶å€™ï¼Œè¿™ä¸ªæ–‡ä»¶å¾ˆå®¹æ˜“å‡ºç°å†²çªã€‚å½“ç„¶ï¼Œæ›´æ–° &lt;code&gt;pbxproj&lt;/code&gt; æ–‡ä»¶ä¸­é…ç½®çš„æœ€ç®€å•æ–¹å¼å°±æ˜¯ä½¿ç”¨ Xcodeï¼Œå…¶äº†è§£å¦‚ä½•ä»è¿™äº›æ–‡ä»¶ä¸­è¯»å–é…ç½®å’Œå‘å…¶ä¸­å†™å…¥é…ç½®ã€‚å¦‚æœä½ å¯¹ä¸ä½¿ç”¨ Xcode æ›´æ–° &lt;code&gt;pbxproj&lt;/code&gt; æ–‡ä»¶æ„Ÿå…´è¶£çš„è¯ï¼Œä½ å¯ä»¥è¯•è¯• &lt;a href=&#34;https://github.com/cocoapods/xcodeproj&#34;&gt;Xcodeproj&lt;/a&gt; æˆ–è€… &lt;a href=&#34;https://github.com/swift-xcode/xcodeproj&#34;&gt;xcproj&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æ„å»ºè¿™äº› target çš„è¾“å‡ºè¦ä¹ˆæ˜¯æ¯”å¦‚ appï¼Œextension æˆ–è€…æµ‹è¯•æ–‡ä»¶ç­‰ &lt;strong&gt;bundles&lt;/strong&gt;ï¼Œè¦ä¹ˆå°±æ˜¯&lt;strong&gt;intermediate products&lt;/strong&gt; ï¼Œä¾‹å¦‚ library æˆ–è€…é‚£äº›å°è£…äº†ä»£ç å’Œèµ„æºæ–‡ä»¶ç”¨æ¥ç»™åˆ«çš„ target ä½¿ç”¨çš„ frameworkã€‚è¿™äº› Target çš„è¾“å‡ºå†…å®¹ä½ å¯ä»¥åœ¨å·¥ç¨‹æ–‡ä»¶ä¸­çš„ &lt;code&gt;Products&lt;/code&gt; çš„ Group ä¸‹æ‰¾åˆ°ï¼Œå¦‚æœæœ‰çº¢è‰²çš„æ–‡ä»¶å¼•ç”¨è¡¨ç¤ºæ²¡æœ‰ product è¾“å‡ºï¼Œå¾ˆå¤§å¯èƒ½æ˜¯ä½ è¿˜æ²¡æœ‰æ„å»ºè¿‡è¿™ä¸ª targetã€‚&lt;/p&gt;

&lt;h4 id=&#34;scheme&#34;&gt;Scheme&lt;/h4&gt;

&lt;p&gt;Xcode å·¥ç¨‹ä¸­å¦å¤–ä¸€ä¸ªè¦ç´ æ˜¯ schemeã€‚ ä¸€ä¸ªå·¥ç¨‹å¯ä»¥åŒ…å«å¤šä¸ª schemeï¼Œä»–ä»¬å¯ä»¥è¢«å…±äº«ï¼Œä½œä¸ºå·¥ç¨‹çš„ä¸€éƒ¨åˆ†è¢«äººä»¬ä½¿ç”¨ã€‚è¿™äº› scheme æŒ‡å®šäº† Xcode ä¸­æ¯ä¸ªå…·ä½“åŠ¨ä½œçš„é…ç½®ï¼Œè¿™äº›åŠ¨ä½œåŒ…æ‹¬ï¼š&lt;strong&gt;run&lt;/strong&gt;ï¼Œ&lt;strong&gt;test&lt;/strong&gt;ï¼Œ&lt;strong&gt;profile&lt;/strong&gt;ï¼Œ&lt;strong&gt;analyze&lt;/strong&gt; ä»¥åŠ &lt;strong&gt;archive&lt;/strong&gt;ã€‚ ç»†çš„æ¥è®²ï¼Œå¯ä»¥æŒ‡å®šå“ªäº› target éœ€è¦è¢«æ„å»ºï¼Œä»¥ä»€ä¹ˆé¡ºåºæ„å»ºç”šè‡³é’ˆå¯¹æ¯ä¸€ç§åŠ¨ä½œæŒ‡å®šä¸åŒçš„é…ç½®ã€‚&lt;/p&gt;

&lt;p&gt;å…³äº scheme çš„ç¼–è¯‘é…ç½®æœ‰ä¸€äº›ä¸œè¥¿è¦è®²ã€‚å½“æˆ‘ä»¬æŒ‡å®šé’ˆå¯¹å“ªäº›åŠ¨ä½œæ„å»ºå“ªäº› target çš„æ—¶å€™ï¼Œåœ¨ä¸‹é¢ä¸¤ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦æŒ‡å®šæ¯ä¸ª target çš„ä¾èµ–é¡¹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å¦‚æœä¾èµ–é¡¹æ˜¯æ˜¯ç›¸åŒ project ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¹¶ä¸”å·²ç»åœ¨ &lt;code&gt;Target dependencies&lt;/code&gt; çš„ &lt;code&gt;Build Phases&lt;/code&gt; ä¸­å®šä¹‰è¿‡ï¼›&lt;/li&gt;
&lt;li&gt;å¼€å¯äº† &lt;code&gt;Find implicit dependencies&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç¬¬ 2 ç‚¹ä¸­å¼€å¯çš„æ ‡è¯†ï¼Œæ„å»ºè¿‡ç¨‹å¿…é¡»æ‰¾åˆ° target çš„ä¾èµ–é¡¹ï¼Œå¹¶ä¸”å…ˆè¡Œæ„å»ºã€‚å¦å¤–ï¼Œå¦‚æœä½ å¼€å¯äº†&lt;code&gt;Parallelize build&lt;/code&gt; çš„è¯ï¼Œä¸€æ—¦ target ç›¸äº’ä¹‹é—´æ²¡æœ‰ä¾èµ–çš„è¯ï¼Œå°±èƒ½å¤Ÿå¹¶è¡Œæ„å»ºï¼Œå› è€Œä¼šèŠ‚çœä¸€éƒ¨åˆ†æ—¶é—´ã€‚&lt;/p&gt;

&lt;p&gt;ä¸€ä¸ªæœ‰é—®é¢˜çš„æ„å»ºé…ç½®ä¼šå¯¼è‡´ä½ ç¼–è¯‘ target çš„æ—¶å€™å‡ºç°é”™è¯¯ï¼Œæ¯”å¦‚ &lt;code&gt;Framework XXX not found&lt;/code&gt;ã€‚å¦‚æœä½ æ›¾ç»æˆ–è€…å½“å‰é‡åˆ°äº†ç±»ä¼¼çš„æŠ¥é”™ï¼Œæ£€æŸ¥ä¸€ä¸‹åœ¨æ„å»ºæ¯ä¸ª scheme çš„æ—¶å€™ï¼Œä½ çš„ target çš„æ‰€æœ‰ä¾èµ–æ˜¯å¦å·²ç»è¢«æ„å»ºã€‚&lt;/p&gt;

&lt;p&gt;scheme æ–‡ä»¶å®šä¹‰æ˜¯å­˜å‚¨åœ¨ &lt;code&gt;Project.xcodeproj/xcshareddata/xcodeproj.xcscheme&lt;/code&gt; è·¯å¾„ä¸‹çš„ä¸€ä¸ªæ ‡å‡†çš„ XML æ–‡æœ¬ï¼Œå› æ­¤ä½ å¯ä»¥å¾ˆå®¹æ˜“çš„ä½¿ç”¨ä»»æ„ XML ç¼–è¾‘å™¨æ¥ä¿®æ”¹å®ƒã€‚&lt;/p&gt;

&lt;h4 id=&#34;workspace&#34;&gt;Workspace&lt;/h4&gt;

&lt;p&gt;å¤šä¸ª project æ–‡ä»¶è¢«ç»„åˆæˆä¸€ä¸ª workspaceã€‚å½“ project è¢«æ·»åŠ åˆ°ä¸€ä¸ª workspace çš„æ—¶å€™ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å…¶ schemes ä¼šå‡ºç°åœ¨ workspace çš„ scheme åˆ—è¡¨ä¸­ï¼›&lt;/li&gt;
&lt;li&gt;project å½¼æ­¤å¯ä»¥äº§ç”Ÿä¾èµ–å…³ç³»ï¼Œåæ–‡ä¼šè®²åˆ°ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å’Œ scheme ç±»ä¼¼ï¼Œworkspace ä¹Ÿæ˜¯æ™®é€šçš„ XML æ–‡ä»¶ï¼Œä¿®æ”¹èµ·æ¥å¾ˆæ–¹ä¾¿ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/wGXI5fy.png&#34; alt=&#34;å·¥ç¨‹æ„å»ºç»„åˆä¸­çš„æ¯ä¸€ä¸ªåŸºç¡€å…ƒç´ ï¼š targetã€schemeã€project ä»¥åŠ workspace æ˜¯å¦‚ä½•è¢«ç»„ç»‡èµ·æ¥çš„&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;dependencies&#34;&gt;Dependencies ğŸŒ±&lt;/h4&gt;

&lt;p&gt;æ¯ä¸ª target éƒ½å¯ä»¥æœ‰ä¾èµ–ï¼Œè¿™äº›ä¾èµ–æ˜¯ target éœ€è¦é“¾æ¥çš„é‚£äº› framework ä»¥åŠ libraryç­‰ï¼Œå…¶åŒ…å«äº†èƒ½å¤Ÿè¢« target å…±äº«çš„æºä»£ç ä»¥åŠèµ„æºã€‚è¿™äº›ä¾èµ–é¡¹å¯ä»¥è¢«é™æ€æˆ–è€…åŠ¨æ€çš„é“¾æ¥ã€‚&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;é™æ€é“¾æ¥ï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å‘ç”Ÿåœ¨ç¼–è¯‘é˜¶æ®µï¼›&lt;/li&gt;
&lt;li&gt;åº“ï¼ˆLibraryï¼‰ä¸­çš„ä»£ç æ–‡ä»¶ä¼šè¢«åŒ…å«åˆ°åº”ç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ï¼ˆä¼šå¢å¤§åº”ç”¨çš„äºŒè¿›åˆ¶å¤§å°ï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;åº“ä½¿ç”¨ .a ä½œä¸ºæ–‡ä»¶åç¼€ï¼Œå…¶æ¥è‡ª (ar)chive file3 typeï¼›&lt;/li&gt;
&lt;li&gt;å¦‚æœç›¸åŒçš„åº“è¢«å¤šæ¬¡é“¾æ¥ï¼Œç¼–è¯‘å™¨ä¼šç”±äº duplicated symbols ç¼–è¯‘å¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;åŠ¨æ€é“¾æ¥ï¼š&lt;/strong&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;æ¨¡å—åœ¨åº”ç”¨å¯åŠ¨æˆ–è€…è¿è¡Œè¿‡ç¨‹ä¸­è¢«åŠ è½½ï¼›&lt;/li&gt;
&lt;li&gt;åº”ç”¨æˆ–è€…æ‰©å±•çš„ target éƒ½å¯ä»¥å…±äº«ç›¸åŒçš„åŠ¨æ€åº“ï¼ˆä»…è¢«å¤åˆ¶ä¸€ä»½ï¼‰&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;å…³äº framework å’Œ libraryï¼ˆæ— è®ºæ˜¯é™æ€é“¾æ¥è¿˜æ˜¯åŠ¨æ€é“¾æ¥ï¼‰çš„åŒºåˆ«åœ¨äºå‰è€…å¯ä»¥åœ¨ç›¸åŒçš„ bundle ä¸­åŒ…å«å¤šä¸ªç‰ˆæœ¬ï¼Œè¿˜å¯ä»¥åŒ…å«é¢å¤–çš„èµ„æºæ–‡ä»¶ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;ä¸€ä¸ª Library æ˜¯ä¸€ä¸ª .a æ–‡ä»¶ï¼Œå…¶æ¥æºäº å½’æ¡£ï¼ˆarchiveï¼‰æ–‡ä»¶ç±»å‹ã€‚ä¸€ä¸ªå•ä¸€çš„å½’æ¡£æ–‡ä»¶ä»…æ”¯æŒå•ä¸€çš„æ¶æ„ã€‚å¦‚æœéœ€è¦æ‰“åŒ…å¤šä¸ªæ¶æ„ï¼Œåˆ™éœ€è¦å°†å…¶æ‰“åŒ…æˆèƒ–Match-OäºŒè¿›åˆ¶ï¼ˆ&lt;strong&gt;fat Match-O binary&lt;/strong&gt;ï¼‰ï¼Œè¯¥äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯ä¸€ç§å®¹å™¨æ ¼å¼ï¼Œå…¶å°†æ”¯æŒä¸åŒæ¶æ„çš„Mach-Oæ‰“åŒ…åœ¨ä¸€èµ·ã€‚å¦‚æœæˆ‘ä»¬æƒ³ç”Ÿæˆã€ä¿®æ”¹ä¸€ä¸ªèƒ–äºŒè¿›åˆ¶æ–‡ä»¶æˆ–è€…ä»å…¶ä¸­æå–æŸä¸ªç‰¹å®šæ¶æ„çš„åº“çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·&lt;code&gt;lipo&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä½ å¯ä»¥åœ¨&lt;a href=&#34;https://pewpewthespells.com/blog/static_and_dynamic_libraries.html&#34;&gt;è¿™é‡Œ&lt;/a&gt;äº†è§£æ›´å¤šå…³äº frameworks/libraries ä»¥åŠ static/dynamic çš„å†…å®¹ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/qKHdwhp.png&#34; alt=&#34;åŠ¨æ€é“¾æ¥å’Œé™æ€é“¾æ¥çš„åŒºåˆ«&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åº”ç”¨çš„ä¾èµ–é¡¹åˆ†ä¸ºé¢„ç¼–è¯‘è¿‡çš„ï¼ˆ&lt;strong&gt;precompiled&lt;/strong&gt;ï¼‰å’Œæœªç»ç¼–è¯‘è¿‡ï¼ˆ&lt;strong&gt;not-compiled&lt;/strong&gt;ï¼‰ä¸¤ç±»ã€‚&lt;/p&gt;

&lt;h5 id=&#34;precompiled-dependencies&#34;&gt;Precompiled dependencies&lt;/h5&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/carthage&#34;&gt;Carthage&lt;/a&gt; æ˜¯è¿™ç±»å‹ä¾èµ–çš„å…¸å‹ä»£è¡¨ã€‚æŸäº› SDKï¼Œæ¯”å¦‚ &lt;a href=&#34;https://github.com/CocoaPods/Specs/blob/master/Specs/0/3/5/Firebase/4.2.0/Firebase.podspec.json#L23&#34;&gt;Firebase&lt;/a&gt; å°±æ˜¯ä½œä¸ºç¼–è¯‘è¿‡çš„ä¾èµ–æ¥å‘å¸ƒçš„ã€‚å½“é¢„ç¼–è¯‘è¿‡çš„ä¾èµ–æ˜¯åº“ï¼ˆlibraryï¼‰çš„æ—¶å€™ï¼Œè¿™äº›ä¾èµ–å°±åŒ…å« &lt;code&gt;.a&lt;/code&gt; çš„åº“åŠä¸€ä¸ªå…¬å…±å¤´æ–‡ä»¶ï¼ŒåŒ…å«äº†è¯¥åº“æ‰€æš´éœ²å‡ºçš„å…¬å…±æ¥å£ã€‚å½“è¿™äº›ä¾èµ–æ˜¯ framework çš„æ—¶å€™ï¼Œè¿™äº›ä¾èµ–å°±ä»¥åŒ…å«äº†åº“å’Œèµ„æºæ–‡ä»¶çš„ &lt;code&gt;.framework&lt;/code&gt; æ–‡ä»¶å‘å¸ƒã€‚&lt;/p&gt;

&lt;p&gt;å½“æˆ‘ä»¬çš„ app ä¾èµ–çš„æ˜¯é¢„ç¼–è¯‘ä¾èµ–çš„æ—¶å€™ï¼Œå¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™äº›ä¾èµ–ä¹Ÿæ˜¯ä¾ç…§æˆ‘ä»¬ app æ‰€æ„å»ºæ¶æ„æ¥æ„å»ºå‡ºæ¥çš„ã€‚ä¸€æ—¦å…¶ä¸­ç¼ºå¤±æŸä¸ªæ¶æ„çš„ä»£ç ï¼Œæˆ‘ä»¬å°±ä¼šåœ¨ç¼–è¯‘ app çš„æ—¶å€™æ”¶åˆ°ç¼–è¯‘é”™è¯¯ã€‚ä¸€ä¼šå„¿åæ–‡ä¼šçœ‹åˆ°ï¼ŒCarthage ä½¿ç”¨ lipo å·¥å…·ç”Ÿæˆé‚£äº›åŒ…å«æ¨¡æ‹Ÿå™¨æˆ–è€…çœŸæœºæ‰€å¿…é¡»çš„æ¶æ„çš„ framework çš„ï¼ŒåŒæ—¶æ ¹æ®æ„å»ºé…ç½®æ¥å‰”é™¤æ‰é‚£äº›ä¸éœ€è¦çš„ frameworkã€‚&lt;/p&gt;

&lt;h5 id=&#34;non-compiled-dependencies&#34;&gt;Non-compiled dependencies&lt;/h5&gt;

&lt;p&gt;&lt;a href=&#34;https://cocoapods.org/&#34;&gt;CocoaPods&lt;/a&gt; æ˜¯è¯¥ç§ç±»å‹çš„å…¸å‹ä»£è¡¨ã€‚ä¾èµ–é¡¹è¢«å®šä¹‰åœ¨æˆ‘ä»¬è¦é“¾æ¥çš„ frameworks/libraries çš„ target ä¸­ã€‚è¿™é‡Œæœ‰å¤šç§æ–¹å¼åœ¨ Xcode ä¸­æŒ‡å®šæˆ‘ä»¬çš„ target ä¾èµ–å…¶ä»– target çš„è¾“å‡ºã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœè¿™äº› target åˆ†å¸ƒåœ¨åŒä¸€ä¸ª project ä¸­&lt;/strong&gt;ï¼Œä½ å¯ä»¥åœ¨ Build Phase çš„&lt;em&gt;Target dependencies&lt;/em&gt; ä¸­æŒ‡å®šä¾èµ–ã€‚ Xcode ä¼šåœ¨ç¼–è¯‘è¯¥ target çš„æ—¶å€™é¦–å…ˆç¼–è¯‘è¿™äº›æŒ‡å®šçš„ä¾èµ–é¡¹ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;å¦‚æœè¿™äº› target åˆ†å¸ƒåœ¨ä¸åŒçš„ project ä¸­&lt;/strong&gt;ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨*Scheme*æ¥å®šä¹‰è¿™äº› target ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚åœ¨ scheme çš„ Build éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰è¦è¢«æ„å»ºçš„ target ä»¥åŠä»¥ä»€ä¹ˆé¡ºåºæ„å»ºï¼ˆåŸºäºä»–ä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼‰ã€‚å¦‚æœä½ å¼€å¯äº†*Find implicit dependencies*æ ‡è¯†ï¼ŒXcode èƒ½å¤Ÿæ ¹æ®æ¯ä¸ª target çš„è¾“å…¥è¾“å‡ºæ¥çŒœæµ‹ä¾èµ–ã€‚å¦‚æœ scheme ä¸­æœ‰é”™è¯¯é…ç½®ï¼Œä½ å°±ä¼šå¾—åˆ°ç±»ä¼¼&lt;code&gt;xxxx.framework not found&lt;/code&gt;çš„é”™è¯¯ã€‚å¦‚æœåœ¨ framework ä¹‹é—´å‡ºç°äº†å¾ªç¯ä¾èµ–ä¹Ÿä¼šæŠ¥ç±»ä¼¼çš„é”™è¯¯ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
&lt;p&gt;å…³äºä¾èµ–é¡¹å’Œé…ç½®é¡¹æœ‰ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼šæ‰€æœ‰ä¾èµ–é¡¹çš„é…ç½®ä¸€å®šè¦å®Œå…¨åŒ¹é…ã€‚å¦‚æœä½ åœ¨ä½¿ç”¨ Alpha é…ç½®é¡¹æ„å»ºä½ çš„ appï¼Œä½†æ˜¯å…¶ä¾èµ–é¡¹ä¸­ä½†å‡¡å‡ºç°äº†ä¸åŒ…å«è¿™ç§é…ç½®ï¼Œç¼–è¯‘è¿‡ç¨‹éƒ½ä¼šå› ä¸ºæ‰¾ä¸åˆ°æŸä¸ª framework è€Œå¤±è´¥ã€‚å½“è¿™ç§æƒ…å†µå‘ç”Ÿçš„æ—¶å€™ï¼ŒXcode ä¸ä¼šç¼–è¯‘è¯¥ framework ä½†æ˜¯ä¸æŠ¥ä»»ä½•é”™è¯¯ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/TrXKUTJ.png&#34; alt=&#34;å„ä¸ªä¾èµ–é¡¹æ˜¯å¦‚ä½•åŸºäº project çš„é…ç½®å¾—åˆ°ç¼–è¯‘çš„&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;linking-with-xcode&#34;&gt;Linking withÂ Xcode&lt;/h3&gt;

&lt;p&gt;Target æœ¬èº«å¯ä»¥é“¾æ¥å…¶ä»– target çš„è¾“å‡ºï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Xcode ä¸­çš„å·¥å…·ï¼Œæ¯”å¦‚ scheme æˆ–è€… target dependencies æ¥æŒ‡å®šä¾èµ–ï¼Œä½†æ˜¯ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡å®šä¹‰è¿™äº›ä¾èµ–çš„é“¾æ¥å…³ç³»æ¥å°†å®ƒä»¬èä¸ºä¸€ä½“çš„ï¼Ÿ&lt;/p&gt;

&lt;h4 id=&#34;1-åŠ¨æ€æˆ–è€…é™æ€é“¾æ¥-libraries-å’Œ-frameworks&#34;&gt;1. åŠ¨æ€æˆ–è€…é™æ€é“¾æ¥ libraries å’Œ frameworks&lt;/h4&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹çš„æ–¹å¼å®šä¹‰é“¾æ¥ï¼š&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;ä¸€ä¸ªæ„å»ºé˜¶æ®µï¼ˆbuild phaseï¼‰ï¼š&lt;/strong&gt;ï¼Œåœ¨æ‰€æœ‰å¯ç”¨çš„ build phase ä¸­ï¼Œæœ‰ä¸€ä¸ªæ˜¯å®šä¹‰é“¾æ¥çš„ï¼Œ*Link Binary With Libraries*ã€‚ä½ å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ æŸä¸ª target çš„ä¾èµ–é¡¹ï¼Œè¿™äº›ä¾èµ–é¡¹å¯ä»¥æ¥è‡ªäºåŒä¸€ä¸ª projectï¼Œä¹Ÿå¯ä»¥æ¥è‡ªåŒä¸€ä¸ª workspace ä¸­çš„å…¶ä»– projectã€‚è¿™ä¸ª build phase è¢« Xcode ç”¨æ¥è¯†åˆ« target è¢«æ„å»ºæ—¶æ‰€éœ€çš„ä¾èµ–é¡¹ï¼›&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¼–è¯‘å™¨æ„å»ºè®¾ç½®ï¼š&lt;/strong&gt;ä¸€ä¸ª build phase ä¸­æ‰€å®šä¹‰çš„å†…å®¹ä¼šè¢«è½¬æ¢æˆç¼–è¯‘å™¨å‚æ•°ã€‚å…¶ä¸­æŸäº›å†…å®¹ä½ ä¹Ÿå¯ä»¥é€šè¿‡å®šä¹‰ç¼–è¯‘è®¾ç½®é¡¹åšåˆ°ï¼š&lt;/li&gt;
&lt;li&gt;&lt;code&gt;FRAMEWORK_SEARCH_PATHS&lt;/code&gt;ï¼šå®šä¹‰ç¼–è¯‘å™¨æ‰€é“¾æ¥çš„ framework æ‰€åœ¨è·¯å¾„&lt;/li&gt;
&lt;li&gt;&lt;code&gt;LIBRARY_SEARCH_PATHS&lt;/code&gt;ï¼šå®šä¹‰ç¼–è¯‘å™¨æ‰€é“¾æ¥çš„ library æ‰€åœ¨è·¯å¾„&lt;/li&gt;
&lt;li&gt;&lt;code&gt;OTHER_LDFLAGS&lt;/code&gt; *(Other Linker Flags)*ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨&lt;code&gt;-l&lt;/code&gt;å‚æ•°æŒ‡å®šé“¾æ¥çš„ libraryï¼Œæ¯”å¦‚&lt;code&gt;-l&amp;quot;1PasswordExtension&amp;quot; -l&amp;quot;Adjust&amp;quot;&lt;/code&gt;ã€‚å¦‚æœéœ€è¦é“¾æ¥ä¸€ä¸ª frameworkï¼Œå°±éœ€è¦ä½¿ç”¨&lt;code&gt;-framework&lt;/code&gt;å‚æ•°ï¼Œæ¯”å¦‚ï¼š&lt;code&gt;-framework &amp;quot;GoogleSignIn&amp;quot; -framework &amp;quot;HockeySDK&amp;quot;&lt;/code&gt;ã€‚å¦‚æœæˆ‘ä»¬å°è¯•é“¾æ¥ä¸€ä¸ªæ— æ³•åœ¨ä¸Šæ–¹æŒ‡å®šè·¯å¾„ä¸­æ‰¾åˆ°çš„ framework æˆ–è€… library çš„è¯ï¼Œç¼–è¯‘è¿‡ç¨‹å°±ä¼šå¤±è´¥ã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;2-æš´éœ²åº“çš„å¤´æ–‡ä»¶&#34;&gt;2. æš´éœ²åº“çš„å¤´æ–‡ä»¶&lt;/h4&gt;

&lt;p&gt;Library çš„å¤´æ–‡ä»¶éœ€è¦æš´éœ²ç»™ä¾èµ–è¯¥åº“çš„ targeã€‚ä¸ºäº†åšåˆ°è¿™ä¸ªï¼Œæœ‰ä¸€ä¸ªç¼–è¯‘è®¾ç½®é¡¹ï¼š&lt;code&gt;HEADER_SEARCH_PATHS&lt;/code&gt;ç”¨æ¥æŒ‡å®šå¤´æ–‡ä»¶æ‰€åœ¨è·¯å¾„ã€‚å¦‚æœæˆ‘ä»¬é“¾æ¥æŸä¸ªåº“ï¼Œä½†æ˜¯å¿˜è®°æš´éœ²è¯¥åº“çš„å¤´æ–‡ä»¶ï¼Œç¼–è¯‘è¿‡ç¨‹å°±ä¼šå› ä¸ºæ‰¾ä¸åˆ°å…¶å¤´æ–‡ä»¶è€Œå¤±è´¥ã€‚&lt;/p&gt;

&lt;h4 id=&#34;3-å°†-framework-åµŒå…¥åˆ°åº”ç”¨ä¸­&#34;&gt;3. å°† Framework åµŒå…¥åˆ°åº”ç”¨ä¸­&lt;/h4&gt;

&lt;p&gt;App çš„ target é“¾æ¥åŠ¨æ€ frameworkï¼Œéœ€è¦æŠŠè¿™äº›ä¾èµ–é¡¹å¤åˆ¶åˆ°åº”ç”¨çš„ bundle ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä½œ &lt;strong&gt;framework embedding&lt;/strong&gt;ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ Xcode çš„&lt;strong&gt;Copy Files Phase&lt;/strong&gt;ï¼Œå…¶æ‹·è´ è¿™äº› framework åˆ° &lt;code&gt;Frameworks&lt;/code&gt;ç›®å½•ä¸­ã€‚ä¸ä»…ä»…éœ€è¦æŠŠè¿™äº›ç›´æ¥ä¾èµ–é¡¹åµŒå…¥åº”ç”¨ä¸­ï¼Œè¿˜åŒ…æ‹¬ç›´æ¥ä¾èµ–æ‰€ä¾èµ–çš„é¡¹ç›®ã€‚å¦‚æœç¼ºå°‘ä»»æ„çš„ frameworkï¼Œå½“æˆ‘ä»¬å°è¯•æ‰“å¼€ app çš„æ—¶å€™éƒ½ä¼šæŠ›å‡ºé”™è¯¯ã€‚&lt;/p&gt;

&lt;hr /&gt;

&lt;h3 id=&#34;æ¡ˆä¾‹å­¦ä¹ &#34;&gt;æ¡ˆä¾‹å­¦ä¹ Â ğŸ‘¨â€ğŸ’»&lt;/h3&gt;

&lt;p&gt;åœ¨è¿™ä¸ªéƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šåˆ†æä»¥ä¸‹ Cocopods å’Œ Carthage æ˜¯å¦‚ä½•è´¯å½»ä¸Šé¢è¿™äº›æ¦‚å¿µæ¥ç®¡ç†ä½ çš„å·¥ç¨‹ä¾èµ–çš„ã€‚&lt;/p&gt;

&lt;h4 id=&#34;cocoapods&#34;&gt;CocoaPods&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/yYLLsbQ.png&#34; alt=&#34;CocoaPods&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Cocoapods è§£æä½ çš„å·¥ç¨‹ä¾èµ–ï¼Œå¹¶å°†å®ƒä»¬èåˆåˆ°ä½ çš„å·¥ç¨‹ä¸­ã€‚è™½ç„¶ç›´æ¥ä¿®æ”¹ä½ çš„å·¥ç¨‹é…ç½®æ˜¯ä¸å¤ªæ¨èçš„ï¼Œä½†æ˜¯å®ƒä»æœ€åˆçš„ç‰ˆæœ¬å·²ç»æœ‰äº†å¾ˆå¤§çš„æå‡ï¼Œç”¨è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å‡ ä¹ä¸éœ€è¦å¯¹ project åšå¾ˆå¤šæ”¹å˜ã€‚é‚£ä¹ˆå®ƒåº•å±‚åˆ°åº•æ˜¯æ€ä¹ˆåšåˆ°çš„ï¼Ÿ&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å®ƒåˆ›å»ºä¸€ä¸ªå·¥ç¨‹ï¼ˆprojectï¼‰&lt;em&gt;(&lt;/em&gt;&lt;code&gt;*Pods.xcodeproj*&lt;/code&gt;&lt;em&gt;)&lt;/em&gt; ï¼Œå…¶åŒ…å«äº†æ‰€æœ‰çš„ä¾èµ–é¡¹ï¼Œæ¯ä¸ªä¾èµ–é¡¹ä»¥ target çš„å½¢å¼å­˜åœ¨ã€‚æ¯ä¸ª target å„è‡ªç¼–è¯‘éœ€è¦è¢«é“¾æ¥åˆ° app ä¸­çš„ä¾èµ–é¡¹ï¼›&lt;/li&gt;
&lt;li&gt;å®ƒåˆ›å»ºä¸€ä¸ªé¢å¤–çš„ targetï¼Œå…¶ä¾èµ–äºå…¶ä»–æ‰€æœ‰çš„ä¾èµ–é¡¹ã€‚è¯¥ target æ˜¯ä¸€ä¸ª umbrella targetï¼Œç”¨æ¥è§¦å‘å…¶ä»– target çš„ç¼–è¯‘ã€‚è¿™æ ·åšä¹Ÿæœ€å°ç¨‹åº¦çš„å‡å°‘äº†ä½ çš„ project ä¸­æ‰€éœ€è¦çš„æ”¹å˜ã€‚é€šè¿‡é“¾æ¥è¿™ä¸ª targetï¼ŒXcode ä¼šå…ˆç¼–è¯‘å…¶æ‰€æœ‰ä¾èµ–é¡¹ï¼Œç„¶åæ˜¯ä½ çš„ appï¼›&lt;/li&gt;
&lt;li&gt;å®ƒåˆ›å»ºäº†ä¸€ä¸ª workspaceï¼ŒåŒ…å«äº†ä½ çš„ project ä»¥åŠ Pods projectï¼›&lt;/li&gt;
&lt;li&gt;Frameworks å’Œ libraries ä½¿ç”¨&lt;code&gt;.xcconfig&lt;/code&gt;æ–‡ä»¶é“¾æ¥ã€‚è¿™äº›æ–‡ä»¶è¢«åŠ åˆ°äº†ä½ çš„ project ç¾¤ç»„ä¸­ï¼Œå¹¶ä¸”è¢«è®¾ç½®ä¸ºä½  project ä¸­ target çš„é…ç½®é¡¹ï¼›&lt;/li&gt;
&lt;li&gt;åµŒå…¥è¿‡ç¨‹æ˜¯é€šè¿‡ä¸€ä¸ªæ„å»ºé˜¶æ®µè„šæœ¬ï¼ˆbuild phase scriptï¼‰æ¥åšåˆ°çš„ã€‚ç±»ä¼¼çš„ï¼Œæ‰€æœ‰çš„ framework æ‰€éœ€è¦çš„èµ„æºä¹Ÿé€šè¿‡ä¸€ä¸ªæ„å»ºé˜¶æ®µï¼ˆbuild phaseï¼‰æ¥å®Œæˆã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;ä¸‹é¢è¿™å¼ å›¾å±•ç¤ºäº†æ•´ä¸ªè®¾ç½®è¿‡ç¨‹ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/UARMUhl.png&#34; alt=&#34;CocoaPods å¦‚ä½•å°†ä¾èµ–é¡¹èåˆåˆ°æ•´ä¸ª Project ä¸­&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;carthage&#34;&gt;Carthage&lt;/h4&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/IUXCxhQ.png&#34; alt=&#34;Carthage&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Carthage çš„æ–¹å¼å’Œ CocoaPods æ¯”èµ·æ¥å¤§ä¸åŒã€‚é™¤äº†ä¾èµ–é¡¹çš„è§£æï¼Œè¯¥å·¥å…·æ˜¯è¿˜ä¸€ç§å»ä¸­å¿ƒåŒ–çš„æ¨¡å¼ï¼Œå…¶ç”Ÿæˆé‚£äº›éœ€è¦è¢«é“¾æ¥æˆ–è€…åµŒå…¥åˆ° app çš„ä¾èµ–é¡¹çš„é¢„ç¼–è¯‘ç‰ˆæœ¬ã€‚&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Carthage è§£æä¾èµ–é¡¹ï¼Œå¹¶ä¸”ç¼–è¯‘å®ƒä»¬ç”Ÿæˆä½ èƒ½å¤Ÿé“¾æ¥åˆ° app ä¸­çš„åŠ¨æ€ frameworkï¼Œæˆ–è€…ä¸ºäº†è°ƒè¯•æ‰€éœ€è¦çš„ç¬¦å·ã€‚è¿™äº› framework æ˜¯ fat frameworkï¼Œæ”¯æŒæ¨¡æ‹Ÿå™¨å’ŒçœŸæœºçš„æ¶æ„ï¼›&lt;/li&gt;
&lt;li&gt;è¿™äº› framework è¢«ç”¨æˆ·ä½¿ç”¨ &lt;em&gt;Link Binary With Libraries&lt;/em&gt; çš„æ„å»ºé˜¶æ®µï¼ˆbuild phaseï¼‰æ‰‹åŠ¨çš„é“¾æ¥ï¼›&lt;/li&gt;
&lt;li&gt;åµŒå…¥è¿‡ç¨‹ä½¿ç”¨ Carthage æä¾›çš„è„šæœ¬å®Œæˆã€‚è¿™ä¸ªè„šæœ¬ä¼šå‰”é™¤é‚£äº›æˆ‘ä»¬æ­£åœ¨æ„å»ºç›®æ ‡æ‰€ä¸å¿…è¦çš„æ¶æ„ç‰ˆæœ¬ï¼›&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨åŒæ ·çš„è„šæœ¬ï¼Œå¤åˆ¶ç¬¦å·åˆ°åˆé€‚çš„æ–‡ä»¶å¤¹ï¼Œä½¿å¾—è°ƒè¯•èƒ½å¤Ÿæ­£å¸¸è¿›è¡Œã€‚&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;img src=&#34;https://i.imgur.com/HXqtoDl.png&#34; alt=&#34;Carthage æ˜¯å¦‚ä½•ç”Ÿæˆä¾èµ–é¡¹çš„ framework å’Œ symbol&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;references&#34;&gt;References&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.knowstack.com/framework-vs-library-cocoa-ios/&#34;&gt;Framework vs Library&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://pewpewthespells.com/blog/static_and_dynamic_libraries.html&#34;&gt;Static and dynamic libraries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://pewpewthespells.com/blog/buildsettings.html&#34;&gt;Xcode Build Settings Reference&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/library/content/technotes/tn2435/_index.html&#34;&gt;Embedding Frameworks in an App&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPFrameworks/Frameworks.html&#34;&gt;Introduction to Framework Programming Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.cocoanetics.com/2015/04/skipping-copy-phase-strip/&#34;&gt;Skippy Copy Phase Strip&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
      
    </item>
    
    <item>
      <title>Initializer in Swift</title>
      <link>https://hechen.xyz/post/initializer-in-swift/</link>
      <pubDate>Wed, 15 Nov 2017 13:09:27 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/initializer-in-swift/</guid>
      
        <description>

&lt;p&gt;æˆ‘æƒ³ &lt;code&gt;[[xxx alloc] init]&lt;/code&gt; åº”è¯¥æ˜¯è‡ªå·±æ¥è§¦ iOS å¼€å‘ä»¥æ¥å†™çš„æœ€å¤šçš„è¯­å¥äº†å§ã€‚ä¸€ä¸ªå¯¹è±¡åˆå§‹åŒ–æ˜¯å…¶å¾—ä»¥å­˜åœ¨çš„å‰æï¼Œæ— è®ºä½ æ˜¯ä½¿ç”¨ new å…³é”®å­—ä¸å¦ï¼Œæ ¹æœ¬ä¸Šéƒ½ä¼šæ‰§è¡Œåˆ° init æ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;è½¬å…¥ swift è¯­è¨€ä¹‹åï¼Œåœ¨åˆšæ¥è§¦çš„æ—¶å€™ç»å¸¸ä¼šå› ä¸ºè‡ªå»ºåˆå§‹åŒ–æ–¹æ³•ä¸åˆé€‚ï¼Œç¼–è¯‘å™¨æŠ¥ä¸€å †é”™è¯¯ï¼Œå¾ˆæ˜¯ç—›è‹¦ï¼Œä½†æ˜¯å½“ç†è§£ Swift è¯­è¨€ä¸ºäº†ä¿éšœå®‰å…¨çš„åˆå§‹åŒ–è¡Œä¸ºæ‰€åšçš„å·¥ä½œä¹‹åï¼Œä½ å°±ä¼šæ˜ç™½ï¼ŒSwift åˆå§‹åŒ–æ–¹æ³•æ˜¯æœ‰ä¸€å®šçš„è§„èŒƒè¦æ±‚çš„ã€‚&lt;/p&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« æ˜¯æƒ³åšä¸ªè®°å½•ã€‚&lt;/p&gt;

&lt;h3 id=&#34;åˆå§‹åŒ–æ–¹æ³•&#34;&gt;åˆå§‹åŒ–æ–¹æ³•&lt;/h3&gt;

&lt;p&gt;é¡ºåºå¾ˆé‡è¦ï¼&lt;/p&gt;

&lt;p&gt;ä¸ &lt;code&gt;Objective-C&lt;/code&gt; ä¸­ä¸åŒï¼ŒSwift è¯­è¨€ä¼šä¿è¯æŸä¸ªç±»çš„æ‰€æœ‰å±æ€§å‡è¢«åˆå§‹åŒ–æ‰è¡Œã€‚å› æ­¤åˆå§‹åŒ–æ–¹æ³•ä¼šéå¸¸ä¸¥æ ¼ï¼Œé‚£ç¬¬ä¸€ç‚¹éœ€è¦ä¿éšœçš„å°±æ˜¯&lt;strong&gt;é¡ºåº&lt;/strong&gt;ã€‚&lt;/p&gt;

&lt;p&gt;é¦–å…ˆï¼Œç¥­å‡ºè¿™å¼ å®˜æ–¹é•‡å®…å›¾ï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;media/initializerDelegation02_2x.png&#34; alt=&#34;initializerDelegation02_2x&#34; /&gt;&lt;/p&gt;

&lt;p&gt;åœ¨æŸä¸ªç±»çš„å­ç±»ä¸­ï¼Œåˆå§‹åŒ–æ–¹æ³•è¯­å¥çš„é¡ºåºå¹¶ä¸æ˜¯éšæ„çš„ï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯åœ¨å½“å‰å­ç±»å®ä¾‹çš„æˆå‘˜åˆå§‹åŒ–å®Œæˆåæ‰èƒ½è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>å¤„ç† Swift ä¸­éå¯é€‰çš„å¯é€‰å€¼ç±»å‹</title>
      <link>https://hechen.xyz/post/handling-non-optional-optionals-in-swift/</link>
      <pubDate>Tue, 14 Nov 2017 21:53:52 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/handling-non-optional-optionals-in-swift/</guid>
      
        <description>

&lt;p&gt;å¯é€‰å€¼ï¼ˆoptionalsï¼‰æ— å¯äº‰è®®çš„æ˜¯ &lt;code&gt;swift&lt;/code&gt; è¯­è¨€ä¸­æœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œä¹Ÿæ˜¯å’Œå…¶ä»–è¯­è¨€ï¼Œä¾‹å¦‚ &lt;code&gt;Objective-C&lt;/code&gt; çš„æœ€å¤§åŒºåˆ«ã€‚é€šè¿‡å¼ºåˆ¶å¤„ç†é‚£äº›æœ‰å¯èƒ½å‡ºç° &lt;code&gt;nil&lt;/code&gt; çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å°±èƒ½å†™å‡ºæ›´æœ‰é¢„æµ‹æ€§çš„ä»¥åŠæ›´å¥å£®çš„ä»£ç ã€‚&lt;/p&gt;

&lt;p&gt;ç„¶è€Œï¼Œæœ‰äº›æ—¶å€™å¯é€‰å€¼å¯èƒ½ä¼šè‡´ä½ äºå°´å°¬çš„å¢ƒåœ°ï¼Œå°¤å…¶æ˜¯ä½ ä½œä¸ºå¼€å‘è€…äº†è§£ï¼ˆç”šè‡³æ˜¯æœ‰äº›çŒœæµ‹çš„æˆåˆ†åœ¨ï¼‰ï¼Œæœ‰çš„ç‰¹å®šå˜é‡å§‹ç»ˆæ˜¯éç©ºï¼ˆnon-nilï¼‰çš„ï¼Œå³ä½¿å®ƒæ˜¯ä¸€ä¸ªå¯é€‰ç±»å‹ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨ä¸­å¤„ç†è§†å›¾çš„æ—¶å€™ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class TableViewController: UIViewController {
    var tableView: UITableView?

    override func viewDidLoad() {
        super.viewDidLoad()
        tableView = UITableView(frame: view.bounds)
        view.addSubview(tableView!)
    }

    func viewModelDidUpdate(_ viewModel: ViewModel) {
        tableView?.reloadData()
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™ä¹Ÿæ˜¯å¯¹äºå¾ˆå¤š Swift ç¨‹åºå‘˜äº‰è®ºæ¯”è¾ƒæ¿€çƒˆçš„åœ°æ–¹ï¼Œç¨‹åº¦ä¸äºšäºè®¨è®º tabs å’Œ spaces çš„ç”¨æ³•ã€‚æœ‰çš„äººä¼šè¯´ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;æ—¢ç„¶å®ƒæ˜¯ä¸€ä¸ªå¯é€‰å€¼ï¼Œä½ å°±åº”è¯¥æ—¶åˆ»ä½¿ç”¨ &lt;code&gt;if let&lt;/code&gt; æˆ–è€… &lt;code&gt;guard let&lt;/code&gt; çš„æ–¹å¼è¿›è¡Œè§£åŒ…ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç„¶è€Œå¦å¤–ä¸€äº›äººåˆ™é‡‡ç”¨å®Œå…¨ç›¸åï¼Œè¯´ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;æ—¢ç„¶ä½ çŸ¥é“è¿™ä¸ªå˜é‡åœ¨ä½¿ç”¨çš„æ—¶å€™ä¸ä¼šä¸º &lt;code&gt;nil&lt;/code&gt;ï¼Œä½¿ç”¨ &lt;code&gt;!&lt;/code&gt; å¼ºåˆ¶è§£åŒ…å¤šå¥½ã€‚å´©æºƒä¹Ÿè¦æ¯”è®©ä½ çš„ç¨‹åºå¤„äºä¸€ä¸ªæœªçŸ¥çŠ¶æ€è¦å¥½å§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;æœ¬è´¨ä¸Šæ¥è®²ï¼Œæˆ‘ä»¬è¿™é‡Œè®¨è®ºçš„æ˜¯è¦ä¸è¦é‡‡ç”¨é˜²å¾¡æ€§ç¼–ç¨‹ï¼ˆ&lt;a href=&#34;https://en.wikipedia.org/wiki/Defensive_programming&#34;&gt;defensive programming&lt;/a&gt;ï¼‰çš„é—®é¢˜ã€‚æˆ‘ä»¬æ˜¯è¯•å›¾è®©ç¨‹åºä»ä¸€ä¸ªæœªçŸ¥çŠ¶æ€æ¢å¤è¿˜æ˜¯ç®€å•çš„æ”¾å¼ƒï¼Œç„¶åè®©å®ƒå´©æºƒæ‰ï¼Ÿ&lt;/p&gt;

&lt;p&gt;å¦‚æœéå¾—è®©æˆ‘å¯¹è¿™ä¸ªé—®é¢˜ç»™å‡ºä¸€ä¸ªç­”æ¡ˆçš„è¯ï¼Œæˆ‘æ›´å€¾å‘äºåè€…ã€‚æœªçŸ¥çŠ¶æ€çœŸçš„å¾ˆéš¾è¿½è¸ª bugï¼Œä¼šå¯¼è‡´æ‰§è¡Œå¾ˆå¤šä¸æƒ³æ‰§è¡Œçš„é€»è¾‘ï¼Œé‡‡ç”¨é˜²å¾¡æ€§ç¼–ç¨‹å°±ä¼šä½¿å¾—ä½ çš„ä»£ç å¾ˆéš¾è¿½è¸ªï¼Œå‡ºç°é—®é¢˜å¾ˆéš¾è¿½è¸ªã€‚&lt;/p&gt;

&lt;p&gt;ä½†æ˜¯ï¼Œæˆ‘ä¸å¤ªå–œæ¬¢ç»™å‡ºä¸€ä¸ªäºŒé€‰ä¸€çš„ç­”æ¡ˆã€‚ç›¸åï¼Œæˆ‘ä»¬å¯ä»¥å¯»æ‰¾ä¸€äº›æŠ€æœ¯æ‰‹æ³•ï¼Œç”¨æ›´ç²¾å¦™çš„æ–¹å¼çš„è§£å†³ä¸Šé¢æåˆ°çš„é—®é¢˜ã€‚&lt;/p&gt;

&lt;h2 id=&#34;å®ƒçœŸçš„å¯é€‰çš„å—&#34;&gt;å®ƒçœŸçš„å¯é€‰çš„å—ï¼Ÿ&lt;/h2&gt;

&lt;p&gt;é‚£äº›å¯é€‰ç±»å‹çš„ï¼Œä½†æ˜¯è¢«ä»£ç é€»è¾‘çœŸå®éœ€è¦çš„å˜é‡å’Œå±æ€§ï¼Œå®é™…ä¸Šæ˜¯æ¶æ„ç‘•ç–µçš„ä¸€ä¸ªä½“ç°ã€‚å¦‚æœåœ¨æŸäº›åœ°æ–¹ç¡®å®éœ€è¦å®ƒï¼Œä½†æ˜¯å®ƒåˆä¸åœ¨ï¼Œå°±ä¼šä½¿å¾—ä½ çš„ä»£ç é€»è¾‘å¤„äºæœªçŸ¥çŠ¶æ€ï¼Œé‚£ä¹ˆå®ƒå°±ä¸åº”è¯¥æ˜¯å¯é€‰ç±»å‹çš„ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œåœ¨æŸäº›ç‰¹å®šåœºæ™¯ä¸‹ï¼Œå¯é€‰å€¼ç¡®å®å¾ˆéš¾é¿å…ï¼ˆå°¤å…¶æ˜¯å’Œç‰¹å®šçš„ç³»ç»Ÿ API äº¤äº’çš„æ—¶å€™ï¼‰ï¼Œé‚£å¯¹äºå¤§éƒ¨åˆ†è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬æœ‰ä¸€äº›æŠ€æœ¯æ¥å¤„ç†ä»è€Œé¿å…å¯é€‰å€¼ã€‚&lt;/p&gt;

&lt;h3 id=&#34;lazy-è¦æ¯”éå¯é€‰çš„å¯é€‰å€¼æ›´å¥½&#34;&gt;lazy è¦æ¯”éå¯é€‰çš„å¯é€‰å€¼æ›´å¥½&lt;/h3&gt;

&lt;p&gt;æŸäº›å±æ€§çš„å€¼éœ€è¦åœ¨å…¶çˆ¶ç±»åˆ›å»ºä¹‹åå†ç”Ÿæˆï¼ˆæ¯”å¦‚è§†å›¾æ§åˆ¶å™¨ä¸­çš„é‚£äº›è§†å›¾ï¼Œåº”è¯¥åœ¨ &lt;code&gt;loadView()&lt;/code&gt;æˆ–è€… &lt;code&gt;viewDidLoad()&lt;/code&gt;æ–¹æ³•ä¸­è¢«åˆ›å»ºï¼‰ï¼Œå¯¹äºè¿™ç§å±æ€§è¦é¿å…å…¶å¯é€‰ç±»å‹çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ &lt;code&gt;lazy&lt;/code&gt; å±æ€§ã€‚ä¸€ä¸ª&lt;code&gt;lazy&lt;/code&gt;å±æ€§æ˜¯å¯ä»¥æ˜¯éå¯é€‰ç±»å‹çš„ï¼ŒåŒæ—¶ä¹Ÿä¸åœ¨å…¶çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•é‡Œè¢«éœ€è¦ï¼Œå®ƒä¼šåœ¨å…¶ç¬¬ä¸€æ¬¡è¢«è·å–çš„æ—¶å€™åˆ›å»ºå‡ºæ¥ã€‚&lt;/p&gt;

&lt;p&gt;è®©æˆ‘ä»¬æ”¹ä¸€ä¸‹ä¸Šé¢çš„ä»£ç ï¼Œä½¿ç”¨ lazy æ¥æ”¹é€  tableView å±æ€§ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class TableViewController: UIViewController {
    lazy var tableView = UITableView()

    override func viewDidLoad() {
        super.viewDidLoad()
        tableView.frame = view.bounds
        view.addSubview(tableView)
    }

    func viewModelDidUpdate(_ viewModel: ViewModel) {
        tableView.reloadData()
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·ï¼Œæ²¡æœ‰å¯é€‰å€¼äº†ï¼Œä¹Ÿä¸ä¼šæœ‰æœªçŸ¥çŠ¶æ€å’¯ğŸ‰&lt;/p&gt;

&lt;h3 id=&#34;é€‚å½“çš„ä¾èµ–ç®¡ç†è¦æ¯”éå¯é€‰çš„å¯é€‰å€¼è¦å¥½&#34;&gt;é€‚å½“çš„ä¾èµ–ç®¡ç†è¦æ¯”éå¯é€‰çš„å¯é€‰å€¼è¦å¥½&lt;/h3&gt;

&lt;p&gt;å¯é€‰å€¼ç±»å‹å¦å¤–ä¸€ç§å¸¸ç”¨çš„åœºæ™¯å°±æ˜¯ç”¨æ¥æ‰“ç ´å¾ªç¯ä¾èµ–ï¼ˆ&lt;a href=&#34;https://en.wikipedia.org/wiki/Circular_dependency&#34;&gt;circular dependencies&lt;/a&gt;ï¼‰ã€‚æœ‰çš„æ—¶å€™ï¼Œä½ å°±é™·å…¥ A ä¾èµ– Bï¼ŒB åˆä¾èµ– A çš„æƒ…å†µï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class UserManager {
    private weak var commentManager: CommentManager?

    func userDidPostComment(_ comment: Comment) {
        user.totalNumberOfComments += 1
    }

    func logOutCurrentUser() {
        user.logOut()
        commentManager?.clearCache()
    }
}

class CommentManager {
    private weak var userManager: UserManager?

    func composer(_ composer: CommentComposer
                  didPostComment comment: Comment) {
        userManager?.userDidPostComment(comment)
        handle(comment)
    }

    func clearCache() {
        cache.clear()
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä»ä¸Šé¢çš„ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œ&lt;code&gt;UserManager&lt;/code&gt; å’Œ &lt;code&gt;CommentManager&lt;/code&gt; ä¹‹é—´æœ‰ä¸€ä¸ªå¾ªç¯ä¾èµ–çš„é—®é¢˜ï¼Œå®ƒä»¬äºŒè€…éƒ½æ²¡æ³•å‡è®¾è‡ªå·±æ‹¥æœ‰å¯¹æ–¹ï¼Œä½†æ˜¯å®ƒä»¬éƒ½åœ¨å„è‡ªçš„ä»£ç é€»è¾‘é‡Œä¾èµ–å½¼æ­¤ã€‚è¿™é‡Œå°±å¾ˆå®¹æ˜“äº§ç”Ÿ bugã€‚&lt;/p&gt;

&lt;p&gt;é‚£è¦è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œæˆ‘ä»¬åˆ›å»ºä¸€ä¸ª &lt;code&gt;CommentComposer&lt;/code&gt; æ¥åšä¸€ä¸ªåè°ƒè€…ï¼Œè´Ÿè´£é€šçŸ¥&lt;code&gt;UserManager&lt;/code&gt; å’Œ &lt;code&gt;CommentManager&lt;/code&gt;äºŒäººä¸€ä¸ªè¯„è®ºäº§ç”Ÿäº†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class CommentComposer {
    private let commentManager: CommentManager
    private let userManager: UserManager
    private lazy var textView = UITextView()

    init(commentManager: CommentManager,
         userManager: UserManager) {
        self.commentManager = commentManager
        self.userManager = userManager
    }

    func postComment() {
        let comment = Comment(text: textView.text)
        commentManager.handle(comment)
        userManager.userDidPostComment(comment)
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é€šè¿‡è¿™ç§å½¢å¼ï¼ŒUserManager å¯ä»¥å¼ºæŒæœ‰ CommentManager ä¹Ÿä¸äº§ç”Ÿä»»ä½•ä¾èµ–å¾ªç¯ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class UserManager {
    private let commentManager: CommentManager

    init(commentManager: CommentManager) {
        self.commentManager = commentManager
    }

    func userDidPostComment(_ comment: Comment) {
        user.totalNumberOfComments += 1
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬åˆä¸€æ¬¡çš„ç§»é™¤äº†æ‰€æœ‰çš„å¯é€‰ç±»å‹ï¼Œä»£ç ä¹Ÿæ›´å¥½é¢„æµ‹äº†ğŸ‰ã€‚&lt;/p&gt;

&lt;h3 id=&#34;ä¼˜é›…çš„å´©æºƒ-crashing-gracefully&#34;&gt;ä¼˜é›…çš„å´©æºƒï¼ˆCrashing gracefullyï¼‰&lt;/h3&gt;

&lt;p&gt;é€šè¿‡ä¸Šé¢å‡ ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬é€šè¿‡å¯¹ä»£ç åšä¸€äº›è°ƒæ•´ï¼Œç§»é™¤äº†å¯é€‰ç±»å‹ä»è€Œæ’é™¤äº†ä¸ç¡®å®šæ€§ã€‚ç„¶è€Œï¼Œæœ‰çš„æ—¶å€™ï¼Œç§»é™¤å¯é€‰ç±»å‹æ˜¯ä¸å¯èƒ½çš„ã€‚è®©æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼Œæ¯”å¦‚ä½ åœ¨åŠ è½½ä¸€ä¸ªæœ¬åœ°çš„åŒ…å«é’ˆå¯¹ä½  App çš„é…ç½®é¡¹çš„ JSON æ–‡ä»¶ï¼Œè¿™ä¸ªæ“ä½œæœ¬èº«ä¸€å®šä¼šå­˜åœ¨å¤±è´¥çš„æƒ…å†µï¼Œæˆ‘ä»¬å°±éœ€è¦æ·»åŠ é”™è¯¯å¤„ç†ã€‚&lt;/p&gt;

&lt;p&gt;ç»§ç»­ä¸Šé¢è¿™ä¸ªåœºæ™¯ï¼ŒåŠ è½½é…ç½®æ–‡ä»¶å¤±è´¥çš„æ—¶å€™ç»§ç»­æ‰§è¡Œä»£ç å°±ä¼šä½¿å¾—ä½ çš„ app è¿›å…¥ä¸€ä¸ªæœªçŸ¥çŠ¶æ€ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæœ€å¥½çš„æ–¹å¼è®©å®ƒå´©æºƒã€‚è¿™æ ·ï¼Œæˆ‘ä»¬ä¼šå¾—åˆ°ä¸€ä¸ªå´©æºƒæ—¥å¿—ï¼Œå¸Œæœ›è¿™ä¸ªé—®é¢˜èƒ½å¤Ÿåœ¨ç”¨æˆ·æ„ŸçŸ¥ä¹‹å‰æ—©æ—©çš„è¢«æˆ‘ä»¬çš„æµ‹è¯•äººå‘˜ä»¥åŠ QA å¤„ç†æ‰ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬å¦‚ä½•å´©æºƒã€‚ã€‚ã€‚æœ€ç®€å•çš„æ–¹å¼å°±æ˜¯æ·»åŠ  &lt;code&gt;!&lt;/code&gt; æ“ä½œç¬¦ï¼Œé’ˆå¯¹è¿™ä¸ªå¯é€‰å€¼å¼ºåˆ¶è§£åŒ…ï¼Œå°±ä¼šåœ¨å…¶æ˜¯ nil çš„æ—¶å€™å‘ç”Ÿå´©æºƒï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let configuration = loadConfiguration()!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è™½ç„¶è¿™ä¸ªæ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œä½†æ˜¯å®ƒæœ‰ä¸ªæ¯”è¾ƒå¤§çš„é—®é¢˜ï¼Œå°±æ˜¯ä¸€æ—¦è¿™æ®µä»£ç å´©æºƒï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°çš„åªæœ‰ä¸€ä¸ªé”™è¯¯ä¿¡æ¯ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;fatal error: unexpectedly found nil while unwrapping an Optional value&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¿™ä¸ªé”™è¯¯ä¿¡æ¯å¹¶ä¸å‘Šè¯‰æˆ‘ä»¬ä¸ºä»€ä¹ˆå‘ç”Ÿè¿™ä¸ªé”™è¯¯ï¼Œåœ¨å“ªé‡Œå‘ç”Ÿçš„ï¼Œç»™ä¸äº†æˆ‘ä»¬ä»€ä¹ˆçº¿ç´¢æ¥è§£å†³å®ƒã€‚è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ guard å…³é”®å­—ï¼Œç»“åˆ &lt;code&gt;preconditionFailure()&lt;/code&gt; å‡½æ•°ï¼Œåœ¨ç¨‹åºé€€å‡ºçš„æ—¶å€™ç»™å‡ºå®šåˆ¶æ¶ˆæ¯ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;guard let configuration = loadConfiguration() else {
    preconditionFailure(&amp;quot;Configuration couldn&#39;t be loaded. &amp;quot; +
                        &amp;quot;Verify that Config.JSON is valid.&amp;quot;)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä¸Šé¢è¿™æ®µä»£ç å‘ç”Ÿå´©æºƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±èƒ½è·å¾—æ›´å¤šæ›´æœ‰æ•ˆçš„é”™è¯¯ä¿¡æ¯ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;fatal error: Configuration couldnâ€™t be loaded. Verify that Config.JSON is valid.: file /Users/John/AmazingApp/Sources/AppDelegate.swift, line 17&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;è¿™æ ·ï¼Œæˆ‘ä»¬ç°åœ¨æœ‰äº†ä¸€ä¸ªæ›´æ¸…æ™°çš„è§£å†³é—®é¢˜çš„åŠæ³•ï¼Œèƒ½å¤Ÿå‡†ç¡®çš„çŸ¥é“è¿™ä¸ªé—®é¢˜åœ¨æˆ‘ä»¬ä»£ç é‡Œçš„å“ªä¸ªæœªçŸ¥å‘ç”Ÿçš„ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å¼•å…¥-require-åº“&#34;&gt;å¼•å…¥ Require åº“&lt;/h3&gt;

&lt;p&gt;ä½¿ç”¨ä¸Šé¢çš„ guard-let-preconditionFailure çš„æ–¹æ¡ˆè¿˜æ˜¯æœ‰ä¸€äº›å†—é•¿ï¼Œç¡®å®è®©æˆ‘ä»¬å‘ƒä»£ç æ›´éš¾é©¾é©­ã€‚æˆ‘ä»¬ä¹Ÿç¡®å®ä¸å¸Œæœ›åœ¨æˆ‘ä»¬çš„ä»£ç é‡Œå å¾ˆå¤šç¯‡å¹…å»äº›è¿™ç§ä»£ç ï¼Œæˆ‘ä»¬æƒ³æ›´ä¸“æ³¨äºæˆ‘ä»¬çš„ä»£ç é€»è¾‘ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ä½¿ç”¨ &lt;code&gt;Require&lt;/code&gt;ã€‚å®ƒåªæ˜¯ç®€å•çš„åœ¨å¯é€‰å€¼æ·»åŠ ç®€å•çš„ &lt;code&gt;require()&lt;/code&gt; æ–¹æ³•ï¼Œä½†èƒ½å¤Ÿä½¿å¾—è°ƒç”¨çš„åœ°æ–¹æ›´ç®€æ´ã€‚ç”¨è¿™ç§æ–¹æ³•æ¥å¤„ç†ä¸Šé¢åŠ è½½ &lt;code&gt;JSON&lt;/code&gt; æ–‡ä»¶çš„ä»£ç å°±å¯ä»¥è¿™æ ·å†™ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let configuration = loadConfiguration().require(hint: &amp;quot;Verify that Config.JSON is valid&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“å‡ºç°å¼‚å¸¸çš„æ—¶å€™ï¼Œä¼šç»™å‡ºä¸‹é¢çš„é”™è¯¯ä¿¡æ¯ï¼š&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;fatal error: Required value was nil. Debugging hint: Verify that Config.JSON is valid: file /Users/John/AmazingApp/Sources/AppDelegate.swift, line 17&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;code&gt;Require&lt;/code&gt; çš„å¦ä¸€ä¸ªä¼˜åŠ¿å°±æ˜¯å®ƒå’Œè°ƒç”¨ &lt;code&gt;preconditionFailure()&lt;/code&gt; æ–¹æ³•ä¸€æ ·ä¹Ÿä¼šæŠ›å¼‚å¸¸ &lt;code&gt;NSException&lt;/code&gt;ï¼Œå°±èƒ½ä½¿å¾—é‚£äº›å¼‚å¸¸ä¸ŠæŠ¥å·¥å…·èƒ½å¤Ÿæ•è·å¼‚å¸¸å‘ç”Ÿæ—¶å€™çš„å…ƒæ•°æ®ã€‚&lt;/p&gt;

&lt;p&gt;ä½ å¦‚æœæƒ³åœ¨è‡ªå·±ä»£ç ä¸­ä½¿ç”¨çš„è¯ï¼Œ&lt;a href=&#34;https://github.com/JohnSundell/Require.git&#34;&gt;Require ç°åœ¨åœ¨ Github ä¸Šå¼€æºäº†&lt;/a&gt;&lt;/p&gt;

&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œæ€»ç»“æ¥çœ‹ï¼Œåœ¨ &lt;code&gt;Swift&lt;/code&gt; è¯­è¨€é‡Œå¤„ç†é‚£äº›éå¯é€‰çš„å¯é€‰å€¼ï¼Œæˆ‘æœ‰å‡ ç‚¹è‡ªå·±çš„è´´å¿ƒå°æç¤ºç»™å¤§å®¶ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;code&gt;lazy&lt;/code&gt; å±æ€§è¦æ¯”éå¯é€‰çš„å¯é€‰å€¼è¦æ›´å¥½&lt;/li&gt;
&lt;li&gt;é€‚å½“çš„ä¾èµ–ç®¡ç†è¦æ¯”éå¯é€‰çš„å¯é€‰å€¼è¦å¥½&lt;/li&gt;
&lt;li&gt;å½“ä½ ä½¿ç”¨éå¯é€‰çš„å¯é€‰å€¼çš„æ—¶å€™ï¼Œä¼˜é›…çš„å´©æºƒ&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å¦‚æœæœ‰ä»»ä½•é—®é¢˜ã€å»ºè®®æˆ–è€…åé¦ˆï¼Œéƒ½æ¬¢è¿éšæ—¶åœ¨ &lt;a href=&#34;https://twitter.com/johnsundell&#34;&gt;Twitter&lt;/a&gt; ä¸Šè”ç³»æˆ‘ï¼Œæˆ‘éå¸¸ä¹æ„å¬åˆ°ä½ ä»¬å¸Œæœ›æˆ‘åœ¨æ¥ä¸‹æ¥çš„æ–‡ç« é‡Œè°ˆè®ºå“ªäº›ä¸»é¢˜å“¦ã€‚&lt;/p&gt;

&lt;p&gt;è°¢è°¢é˜…è¯»ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>ç†è§£å“åº”è€…å’Œå“åº”é“¾</title>
      <link>https://hechen.xyz/post/understanding-responders-and-the-responder-chain/</link>
      <pubDate>Mon, 13 Nov 2017 21:22:44 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/understanding-responders-and-the-responder-chain/</guid>
      
        <description>

&lt;p&gt;Apps æ˜¯é€šè¿‡å“åº”è€…ï¼ˆresponderï¼‰å¯¹è±¡æ¥æ¥æ”¶å’Œå¤„ç†äº‹ä»¶çš„ã€‚ä¸€ä¸ªå“åº”è€…å¯¹è±¡æ˜¯ UIResponder ç±»çš„ä¸€ä¸ªå®ä¾‹ï¼Œæˆ‘ä»¬å¸¸è§çš„ UIViewï¼ŒUIViewController ä»¥åŠ UIApplication éƒ½æ˜¯ UIResponder çš„å­ç±»ã€‚ UIKit è‡ªåŠ¨å¸®ä½ ç®¡ç†ç€è¿™äº› responder ç›¸å…³çš„è¡Œä¸ºï¼ŒåŒ…æ‹¬äº‹ä»¶æ˜¯å¦‚ä½•ä»ä¸€ä¸ª responder ä¼ é€’ç»™å¦ä¸€ä¸ª responder çš„ç­‰ç­‰ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥ä¿®æ”¹ä½ çš„ app ä¸­äº‹ä»¶ä¼ é€’çš„é»˜è®¤è¡Œä¸ºã€‚&lt;/p&gt;

&lt;p&gt;UIKit ä¼šæŠŠå¤§éƒ¨åˆ†çš„äº‹ä»¶éƒ½ä¼ é€’ç»™æœ€é€‚åˆçš„ responder å¯¹è±¡æ¥å¤„ç†ã€‚å¦‚æœè¯¥ responder æ— æ³•å¤„ç†è¯¥äº‹ä»¶ï¼ŒUIKit å°±ä¼šç»§ç»­æŠŠè¯¥äº‹ä»¶æ²¿ç€å½“å‰çš„å“åº”è€…é“¾ä¼ é€’åˆ°ä¸‹ä¸€ä¸ª responderã€‚å“åº”è€…é“¾å°±æ˜¯ä½ çš„ App ä¸­æ‰€æœ‰å“åº”è€…çš„åŠ¨æ€é…ç½®ï¼Œä¹Ÿå› ä¸ºå…¶æ˜¯åŠ¨æ€çš„ï¼Œä½ çš„ App ä¸­ä¸å¯èƒ½åªå­˜åœ¨å•ä¸€çš„å“åº”è€…é“¾ã€‚ç”±äºäº‹ä»¶æ€»æ˜¯ä»ç‰¹å®šçš„å“åº”è€…é‚£é‡Œæµè½¬åˆ°æ›´é€šç”¨çš„å“åº”è€…é‚£é‡Œï¼Œå› æ­¤å¾ˆå®¹æ˜“ç¡®å®šæŸå“åº”è€…é“¾ä¸­ä¸‹ä¸€ä¸ªå“åº”è€…æ˜¯è°ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸€ä¸ª view çš„ä¸‹ä¸€ä¸ªå“åº”è€…æ˜¯å…¶ superview æˆ–è€…è´Ÿè´£ç®¡ç†å®ƒçš„ view controllerã€‚äº‹ä»¶å°±æ˜¯è¿™æ ·åœ¨å“åº”è€…é“¾ä¸­ä¼ é€’ç›´åˆ°å…¶è¢«å¤„ç†æ‰ã€‚&lt;/p&gt;

&lt;p&gt;ä¸‹å›¾1 è¡¨æ˜ä¸€ä¸ªç•Œé¢ä¸­åŒ…å«äº† ä¸€ä¸ª Labelï¼Œä¸€ä¸ª text fieldï¼Œä¸€ä¸ª button ä»¥åŠä¸¤ä¸ª background view çš„ App ä¸­å“åº”é“¾æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚å¦‚æœ text field ä¸å¤„ç†æŸä¸ªäº‹ä»¶ï¼ŒUIKit å°±ä¼šæŠŠè¯¥äº‹ä»¶å‘é€ç»™ text field çš„çˆ¶çº§ UIView å¯¹è±¡ï¼ŒåŒæ ·çš„ï¼Œå¦‚æœè¯¥å¯¹è±¡ä¾ç„¶å¤„ç†ä¸äº†ï¼Œå°±ä¼šä¼ é€’ç»™è¯¥ view å¯¹è±¡çš„ windowã€‚å¦‚æœ window å¯¹è±¡ä¹Ÿä¾ç„¶æ— æ³•å¤„ç†è¯¥äº‹ä»¶ï¼ŒUIKit æœ€ç»ˆä¼šæŠŠè¯¥äº‹ä»¶ä¼ é€’ç»™ UIApplication å¯¹è±¡ï¼Œä¸€èˆ¬ä¸Šè¯¥ UIApplication å¯¹è±¡æ˜¯ App çš„ delegate å¯¹è±¡å¹¶ä¸”æ˜¯ UIResponder å®ä¾‹ï¼Œå½“ç„¶è¿™ä¸ªæ—¶å€™å·²ç»è„±ç¦»äº†å“åº”è€…é“¾äº†ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://ws4.sinaimg.cn/large/006tKfTcly1flgs9djns2j30zp0lyac6.jpg&#34; alt=&#34;å›¾1 - ä¸€ä¸ªå“åº”è€…é“¾çš„ä¾‹å­&#34; /&gt;&lt;/p&gt;

&lt;p&gt;é’ˆå¯¹æ¯ä¸€ä¸ªäº‹ä»¶ï¼ŒUIKit éƒ½ä¼šæŒ‡å®šä¸€ä¸ªç¬¬ä¸€å“åº”è€…ï¼ˆfirst responderï¼‰ï¼Œç„¶åæŠŠè¯¥äº‹ä»¶é¦–å…ˆå‘é€ç»™å¯¹è±¡å¤„ç†ã€‚è¿™ä¸ªç¬¬ä¸€å“åº”è€…åŸºäºäº‹ä»¶ç±»å‹è€Œä¸åŒã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Touch events.&lt;/strong&gt; ç¬¬ä¸€å“åº”è€…æ˜¯ Touch å‘ç”Ÿæ‰€åœ¨çš„ viewã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Press events.&lt;/strong&gt; ç¬¬ä¸€å“åº”è€…æ˜¯å½“å‰ç„¦ç‚¹æ‰€åœ¨çš„å“åº”è€…ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Motion event.&lt;/strong&gt; ç¬¬ä¸€å“åº”è€…æ˜¯ä½ æ˜¾å¼æŒ‡å®šç”¨ä»¥å¤„ç†äº‹ä»¶çš„å¯¹è±¡ã€‚ Core Motion å¤„ç†æ‰€æœ‰çš„å’ŒåŠ é€Ÿå™¨ã€æ°”å‹ä»ªä»¥åŠç£åŠ›è®¡ç›¸å…³çš„äº‹ä»¶ã€‚Motion events ä¸éšå“åº”è€…é“¾æµåŠ¨ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Shake-motion events.&lt;/strong&gt; ç¬¬ä¸€å“åº”è€…æ˜¯ä½ æˆ–è€… UIKit æ¡†æ¶æŒ‡å®šçš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Remote-control events.&lt;/strong&gt; ç¬¬ä¸€å“åº”è€…æ˜¯ä½ æˆ–è€… UIKit æ¡†æ¶æŒ‡å®šçš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Editing-menu messages.&lt;/strong&gt; ç¬¬ä¸€å“åº”è€…æ˜¯ä½ æˆ–è€… UIKit æ¡†æ¶æŒ‡å®šçš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Controls å‘å…¶å…³è”çš„å¯¹è±¡å‘é€åŠ¨ä½œæ¶ˆæ¯æœ¬èº«ä¸æ˜¯äº‹ä»¶ï¼Œä½†æ˜¯ä¾ç„¶èƒ½å¤Ÿäº«å—åˆ°å“åº”è€…é“¾çš„å¥½å¤„ã€‚å½“ä¸€ä¸ª Control çš„ target object æ˜¯ nil çš„æ—¶å€™ï¼ŒUIKit å°±ä¼šåœ¨è¯¥ target object çš„å“åº”è€…é“¾ä¸Šå¯»æ‰¾åˆé€‚çš„å¯¹è±¡ç”¨ä»¥å¦¥å–„å¤„ç†åŠ¨ä½œæ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼ŒUIKit ç¼–è¾‘æŒ‰é’®ä½¿ç”¨è¿™ç§è¡Œä¸ºæ¥å¯»æ‰¾å“åº”è€…å¯¹è±¡æ¥æ‰§è¡Œ&lt;code&gt;cut:&lt;/code&gt;, &lt;code&gt;copy:&lt;/code&gt; æˆ–è€… &lt;code&gt;paste:&lt;/code&gt; ç­‰æ–¹æ³•ã€‚&lt;/p&gt;

&lt;p&gt;å¦‚æœä¸€ä¸ª view è‡ªèº«è¿˜æœ‰é™„åŠ çš„æ‰‹åŠ¿è¯†åˆ«å™¨çš„è¯ï¼Œè¯¥æ‰‹åŠ¿è¯†åˆ«å™¨ä¼šå»¶è¿Ÿé’ˆå¯¹è¯¥ view çš„ touch å’Œ press äº‹ä»¶çš„ä¼ é€’ã€‚&lt;code&gt;delaysTouchesBegan&lt;/code&gt;, &lt;code&gt;delaysTouchesEnded&lt;/code&gt; ä»¥åŠ &lt;code&gt;UIGestureRecognizer&lt;/code&gt; çš„ &lt;code&gt;cancelsTouchesInView&lt;/code&gt; å±æ€§éƒ½æ˜¯ç”¨æ¥å†³å®šè¿™äº› touches ä»€ä¹ˆæ—¶é—´ä»¥åŠä»¥ä»€ä¹ˆæ–¹å¼è¢«å»¶è¿Ÿå¤„ç†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;è¯†åˆ«åŒ…å«-touch-äº‹ä»¶çš„å“åº”è€…&#34;&gt;è¯†åˆ«åŒ…å« Touch äº‹ä»¶çš„å“åº”è€…&lt;/h3&gt;

&lt;p&gt;UIKit ä½¿ç”¨åŸºäºè§†å›¾çš„ç¢°æ’æ£€æµ‹ï¼ˆhit-testingï¼‰æ¥å†³å®š touch äº‹ä»¶å‘ç”Ÿçš„åœ°ç‚¹ã€‚å…·ä½“è€Œè¨€ï¼ŒUIKit  æ‹¿è¯¥ touch çš„ä½ç½®å’Œè§†å›¾å±‚çº§ä¸­æ‰€æœ‰çš„è§†å›¾å¯¹è±¡çš„ bounds è¿›è¡Œæ¯”è¾ƒã€‚UIView çš„ &lt;code&gt;hitTest:withEvent:&lt;/code&gt; æ–¹æ³•ä¼šæ¸¸å†æ•´ä¸ªè§†å›¾å±‚çº§ï¼Œæ‰¾åˆ°è¯¥ touch äº‹ä»¶å‘ç”Ÿæ‰€åœ¨çš„è§†å›¾æ ‘æœ€åº•ç«¯çš„è§†å›¾ï¼Œå…¶ä¹Ÿå°±æ˜¯å¤„ç†è¯¥ touch äº‹ä»¶çš„ç¬¬ä¸€å“åº”è€…ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ª touch çš„ä½ç½®å‘ç”Ÿåœ¨æŸä¸ªè§†å›¾çš„å¤–å›´ï¼Œ&lt;code&gt;hitTest:withEvent:&lt;/code&gt;æ–¹æ³•å°±ä¼šå¿½ç•¥è¯¥è§†å›¾å’Œå…¶æ‰€æœ‰å­è§†å›¾ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ å°† view çš„&lt;code&gt;clipsToBounds&lt;/code&gt;å±æ€§è®¾ç½®ä¸º NO çš„åŒ–ï¼Œå³ä½¿å…¶å­è§†å›¾å°†è¯¥ touch åŒ…å«åœ¨è‡ªå·±é¢†åŸŸä¹Ÿæ˜¯æ— æ•ˆçš„ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;å°±è¿™æ ·ï¼ŒUIKit æŒç»­ä¸æ–­çš„æŠŠæ¯ä¸ª touch æŒ‡æ´¾ç»™åŒ…å«è¯¥ touch çš„è§†å›¾ã€‚å½“ touch å‘ç”Ÿçš„æ—¶å€™ï¼ŒUIKit åˆ›å»ºä¸€ä¸ª &lt;code&gt;UITouch&lt;/code&gt; å¯¹è±¡ï¼Œç›´åˆ° touch ç»“æŸè¯¥å¯¹è±¡æ‰ä¼šè¢«é‡Šæ”¾ã€‚å½“ touch ä½ç½®æˆ–è€…å…¶ä»–å‚æ•°å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒUIKit å°±æ›´æ–°è¿™ä¸ª UITouch å¯¹è±¡çš„ä¿¡æ¯ã€‚å½“ç„¶ï¼Œå…¶ä¸­æœ‰çš„å±æ€§å½“ç„¶æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œæ¯”å¦‚è¯¥ touch é™„å±çš„ viewï¼Œç”šè‡³å½“ touch ä½ç½®å·²ç»è¶…å‡ºåŸå§‹ view çš„å¤–å›´çš„æ—¶å€™ï¼ŒUITouch å¯¹è±¡ä¸­çš„ view å±æ€§ä¾ç„¶ä¿æŒå’Œä¹‹å‰ä¸€æ ·ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å˜æ›´å“åº”è€…é“¾&#34;&gt;å˜æ›´å“åº”è€…é“¾&lt;/h3&gt;

&lt;p&gt;ä½ å¯ä»¥é€šè¿‡è¦†å†™å“åº”è€…çš„ nextResponder å±æ€§æ¥æ”¹å˜å“åº”è€…é“¾ã€‚è®¸å¤š UIKit çš„ç±»å·²ç»è¦†å†™äº†è¯¥æ–¹æ³•å¹¶ä¸”è¿”å›äº†ç‰¹å®šçš„å¯¹è±¡ã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å¦‚æœä½ è¦†å†™äº†ä»»æ„ç±»çš„ &lt;code&gt;nextResponder&lt;/code&gt; å±æ€§ï¼Œé‚£è¯¥å¯¹è±¡çš„ä¸‹ä¸€ä¸ªå“åº”è€…å°±æ˜¯ä½ è¿”å›çš„é‚£ä¸ªï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UIView&lt;/code&gt;
2.1 å¦‚æœè¯¥è§†å›¾æ˜¯æŸä¸ªè§†å›¾æ§åˆ¶å™¨çš„æ ¹è§†å›¾ï¼ˆroot viewï¼‰ï¼Œå…¶ä¸‹ä¸€ä¸ªå“åº”è€…å°±æ˜¯è¯¥è§†å›¾æ§åˆ¶å™¨ï¼›
2.2 å¦‚æœè¯¥è§†å›¾ä¸æ˜¯æŸä¸ªè§†å›¾æ§åˆ¶å™¨çš„æ ¹è§†å›¾ï¼Œå…¶ä¸‹ä¸€ä¸ªå“åº”è€…å°±æ˜¯è¯¥è§†å›¾çš„çˆ¶è§†å›¾ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UIViewController&lt;/code&gt;
3.1 å¦‚æœè¯¥è§†å›¾æ§åˆ¶å™¨çš„è§†å›¾æ˜¯æŸä¸ª window çš„æ ¹è§†å›¾ï¼ˆroot viewï¼‰ï¼Œå…¶ä¸‹ä¸€ä¸ªå“åº”è€…å°±æ˜¯ windowï¼›
3.2 å¦‚æœè¯¥è§†å›¾æ§åˆ¶å™¨æ˜¯ç”±å¦ä¸€ä¸ªè§†å›¾æ§åˆ¶å™¨å±•ç¤ºå‡ºæ¥çš„ï¼Œå…¶ä¸‹ä¸€ä¸ªå“åº”è€…å°±æ˜¯é‚£ä¸ªè§†å›¾æ§åˆ¶å™¨ï¼ˆpresenting view controllerï¼‰ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UIWindow&lt;/code&gt;  window çš„ä¸‹ä¸€ä¸ªå“åº”è€…å°±æ˜¯ &lt;code&gt;UIApplication&lt;/code&gt; å¯¹è±¡&lt;/li&gt;
&lt;li&gt;&lt;code&gt;UIApplication&lt;/code&gt;  UIApplication å¯¹è±¡çš„ä¸‹ä¸€ä¸ªå“åº”è€…æ˜¯ App delegateï¼Œè€Œä¸”è¦æ±‚è¯¥ delegate å¿…é¡»æ˜¯ &lt;code&gt;UIRepsponder&lt;/code&gt; çš„å®ä¾‹å¹¶ä¸”ä¸èƒ½æ˜¯ä¸€ä¸ªè§†å›¾ã€è§†å›¾æ§åˆ¶å™¨æˆ–è€… &lt;code&gt;UIApplication&lt;/code&gt; å¯¹è±¡è‡ªå·±ã€‚&lt;/li&gt;
&lt;/ol&gt;
</description>
      
    </item>
    
    <item>
      <title>Capturing objects in Swift closures</title>
      <link>https://hechen.xyz/post/capturing-objects-in-swift-closures/</link>
      <pubDate>Sun, 12 Nov 2017 20:56:50 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/capturing-objects-in-swift-closures/</guid>
      
        <description>

&lt;p&gt;è‡ªä» Block åœ¨ iOS4 è¢«å¼•å…¥ Objective-C çš„ä¸–ç•Œä¹‹åå°±æˆä¸ºäº† Apple å„å¹³å°ä¸Šæœ€æ—¶é«¦çš„ API çš„é‡è¦ç»„æˆéƒ¨åˆ†äº†ã€‚å½“ Swift è¯­è¨€å‡ºç°çš„æ—¶å€™ï¼Œblocks çš„æ¦‚å¿µå°±æ‘‡èº«ä¸€å˜é€šè¿‡ closure çš„å½¢å¼å¼•å…¥ï¼Œæˆä¸ºäº†ç›®å‰æˆ‘ä»¬å¯èƒ½æ¯ä¸€å¤©éƒ½åœ¨ç”¨çš„è¯­è¨€ç‰¹æ€§ä¹‹ä¸€äº†ã€‚&lt;/p&gt;

&lt;p&gt;Closure ç›®å‰å·²ç»è¢«æˆ‘ä»¬å¹¿æ³›çš„ä½¿ç”¨äº†ï¼Œå³ä½¿å¦‚æ­¤ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨å®ƒçš„æ—¶å€™è¿˜æ˜¯éœ€è¦æœ‰å¾ˆå¤šéœ€è¦æ³¨æ„çš„ç‚¹ï¼Œå¹¶ä¸”éœ€è¦åšå¾ˆå¤šé¢å¤–çš„æ“ä½œã€‚è¿™ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬æ¥è¿‘è·ç¦»çš„äº†è§£ closureï¼Œä¸»è¦æ˜¯äº†è§£å…¶æ•è·å˜é‡çš„æœºåˆ¶ä»¥åŠé‚£äº›èƒ½å¤Ÿæ›´å¥½çš„è®©æˆ‘ä»¬æ¥å¤„ç†å˜é‡æ•è·çš„æŠ€æœ¯ã€‚&lt;/p&gt;

&lt;h2 id=&#34;ä¼Ÿå¤§çš„-escape&#34;&gt;ä¼Ÿå¤§çš„ escape&lt;/h2&gt;

&lt;p&gt;Closure æœ‰ä¸¤ç§ç±»å‹ï¼šescaping å’Œ non-escapingã€‚å½“ä¸€ä¸ª closure æ˜¯ escapingï¼ˆä½¿ç”¨ &lt;code&gt;@escaping&lt;/code&gt; ä¿®é¥°é—­åŒ…å‚æ•°ï¼‰çš„ï¼Œä¹Ÿå°±æ„å‘³ç€å…¶ä¼šè¢«ä»¥å„ç§å½¢å¼å­˜å‚¨ä¸‹æ¥ï¼ˆæ— è®ºæ˜¯é€šè¿‡ property è¿˜æ˜¯è¢«å…¶ä»– closure æ•è·ï¼‰ã€‚ç›¸åï¼ŒNon-Escaping çš„ã€€closure æ„å‘³ç€å…¶ä¸èƒ½è¢«å­˜å‚¨ï¼Œè€Œä¸”åœ¨ä½¿ç”¨å®ƒçš„åœ°æ–¹å°±å¿…é¡»ç›´æ¥è¢«æ‰§è¡Œã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼š å¯ä»¥å‚è§ &lt;a href=&#34;http://hechen.info/2017/11/12/autoclosure-escape/&#34;&gt;ã€Š@autoclosure &amp;amp;&amp;amp; @escapeã€‹&lt;/a&gt; ä¸€æ–‡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ä¸€ä¸ªæ˜¾è€Œæ˜“è§çš„ä¾‹å­å°±æ˜¯å½“ä½ åœ¨ä¸€ä¸ªé›†åˆç±»å‹ä¸Šä½¿ç”¨å‡½æ•°å¼æ“ä½œçš„æ—¶å€™ï¼Œä¾‹å¦‚ &lt;code&gt;forEach&lt;/code&gt;ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[1, 2, 3].forEach { number in
    ...
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œclosure éƒ½ç›´æ¥ä½œç”¨äºé›†åˆçš„æ¯ä¸€ä¸ªå…ƒç´ ä¸Šï¼Œä¹Ÿå°±æ— éœ€æŠŠè¯¥é—­åŒ…å˜ä¸º escaping çš„ã€‚&lt;/p&gt;

&lt;p&gt;è€Œ escaping çš„ closures æœ€å¸¸è§çš„å°±æ˜¯åœ¨é‚£äº›å¼‚æ­¥ API ä¸­ï¼Œä¾‹å¦‚ &lt;code&gt;DispatchQueue&lt;/code&gt;ã€‚ä¾‹å¦‚ï¼Œå½“ä½ å¼‚æ­¥æ‰§è¡ŒæŸ closure çš„æ—¶å€™ï¼Œè¿™ä¸ª closure å°±ä¼š escapeã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;DispatchQueue.main.async {
    ...
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œè¿™ä¸¤ç§çš„åŒºåˆ«åœ¨å“ªé‡Œå‘¢ï¼Ÿ ç”±äº escaping çš„ closure ä¼šè¢«ä»¥æŸç§å½¢å¼å­˜å‚¨ä¸‹æ¥ï¼Œå› æ­¤ï¼Œè¿™äº› closure ä¼šåŒæ—¶å­˜å‚¨å½“å‰å…¶æ‰€å¤„çš„ä¸Šä¸‹æ–‡ï¼ŒåŒæ—¶å°±ä¼šæŠŠä¸Šä¸‹æ–‡ä¸­ç”¨åˆ°çš„å€¼æˆ–è€…å¯¹è±¡éƒ½æ•è·ï¼ˆcaptureï¼‰åˆ°ï¼Œä»¥è‡³äºå½“è¯¥ closure è¢«æ‰§è¡Œçš„æ—¶å€™ï¼Œæ‰€éœ€ç”¨åˆ°çš„å†…å®¹æ²¡æœ‰ä¸¢å¤±ã€‚å®è·µä¸­æœ€å¸¸è§çš„å°±æ˜¯åœ¨ closure ä¸­ä½¿ç”¨ self çš„ APIï¼Œæ­¤æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦æŸç§åŠæ³•æ˜¾å¼çš„æ•è· selfã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ•è·-å¼•ç”¨å¾ªç¯&#34;&gt;æ•è· &amp;amp; å¼•ç”¨å¾ªç¯&lt;/h2&gt;

&lt;p&gt;å› ä¸º escaping çš„ closures ä¼šè‡ªåŠ©æ•è·åœ¨å…¶å†…éƒ¨ä½¿ç”¨çš„ä»»ä½•å€¼å’Œå¯¹è±¡ï¼Œå› æ­¤å¾ˆå®¹æ˜“å‘ç”Ÿå¼•ç”¨å¾ªç¯ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä¸‹é¢æè¿°çš„æ˜¯ä¸€ä¸ª view controller è¢«å…¶å­˜å‚¨çš„ viewModel çš„ closure æ•è·çš„æƒ…å†µï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class ListViewController: UITableViewController {
    private let viewModel: ListViewModel

    init(viewModel: ListViewModel) {
        self.viewModel = viewModel

        super.init(nibName: nil, bundle: nil)

        viewModel.observeNumberOfItemsChanged {
            // This will cause a retain cycle, since our view controller
            // retains its view model, which in turn retains the view
            // controller by capturing it in an escaping closure.
            self.tableView.reloadData()
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æœ€å¸¸è§çš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä½ ä»¬å¤§éƒ¨åˆ†äººä¹Ÿéƒ½ä¼šç”¨çš„è§£å†³æ–¹å¼ï¼Œé€šè¿‡å¼±å¼•ç”¨çš„æ–¹å¼æ‰“ç ´è¿™ä¸ªå¾ªç¯å¼•ç”¨ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;viewModel.observeNumberOfItemsChanged { [weak self] in
    self?.tableView.reloadData()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;æ•è·-context-è€Œä¸æ˜¯æ•è·-self&#34;&gt;æ•è· context è€Œä¸æ˜¯æ•è· self&lt;/h2&gt;

&lt;p&gt;ä¸Šé¢æåˆ°çš„ [weak self] çš„è§£å†³æ–¹æ¡ˆå·²ç»æ˜¯ä½ å¸Œæœ›é¿å…å¼•ç”¨å¾ªç¯çš„æœ€å¸¸ç”¨ï¼Œä¹Ÿå¸¸å¸¸æ˜¯æœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆäº†ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¹Ÿæœ‰ä¸€äº›é—®é¢˜ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;å¾ˆå®¹æ˜“å¿˜æ‰å†™ï¼Œå°¤å…¶æ˜¯ç¼–è¯‘å™¨åˆæ²¡æ£€æŸ¥å‡ºæ¥æ½œåœ¨çš„å¼•ç”¨å¾ªç¯çš„æ—¶å€™ï¼›&lt;/li&gt;

&lt;li&gt;&lt;p&gt;å½“ä½ å¸Œæœ›ä» weak self ä¸­å¼ºæŒæœ‰ self çš„æ—¶å€™è¿˜éœ€è¦å†™ä¸€å †ä»£ç ï¼ˆweak strong danceï¼‰ï¼Œä¾‹å¦‚ä¸‹é¢è¿™æ®µä»£ç æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dataLoader.loadData(from: url) { [weak self] data in
guard let strongSelf = self else {
    return
}

let model = try strongSelf.parser.parse(data, using: strongSelf.schema)
strongSelf.titleLabel.text = model.title
strongSelf.textLabel.text = model.text
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;è¿™é‡Œå…¶å®æœ‰ä¸€ä¸ªå¯é€‰çš„è§£å†³æ–¹æ¡ˆï¼Œä¹Ÿå°±æ˜¯ä¸è¦æ•è· selfï¼Œè€Œå»æ•è·é‚£äº›é—­åŒ…ä¸­æ‰€éœ€è¦çš„å¯¹è±¡å³å¯ã€‚ä¾‹å¦‚ä¸Šé¢ä¾‹å­ä¸­çš„ labels å’Œ schema ç­‰ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ•è·å®ƒä»¬è€Œä¸è‡³äºå¼•å‘å¼•ç”¨å¾ªç¯ï¼ˆå› ä¸ºå…¶ä¹Ÿå¹¶ä¸æŒæœ‰ closure æœ¬èº«ï¼‰ï¼Œä¸‹é¢æ˜¯ä¸ªè§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡ä½¿ç”¨ context çš„ tuple æ¥è§£å†³ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// We define a context tuple that contains all of our closure&#39;s dependencies
let context = (
    parser: parser,
    schema: schema,
    titleLabel: titleLabel,
    textLabel: textLabel
)

dataLoader.loadData(from: url) { data in
    // We can now use the context instead of having to capture &#39;self&#39;
    let model = try context.parser.parse(data, using: context.schema)
    context.titleLabel.text = model.title
    context.textLabel.text = model.text
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;é€šè¿‡æ˜¾å¼ä¼ é€’å‚æ•°è€Œä¸æ˜¯éšå¼çš„æ•è·&#34;&gt;é€šè¿‡æ˜¾å¼ä¼ é€’å‚æ•°è€Œä¸æ˜¯éšå¼çš„æ•è·&lt;/h2&gt;

&lt;p&gt;è¿™é‡Œï¼Œè¿˜æœ‰å¦å¤–ä¸€ç§æ•è·å¯¹è±¡çš„æ–¹å¼ï¼Œå°±æ˜¯æ˜¾å¼çš„æŠŠè¿™äº›å¯¹è±¡é€šè¿‡å‚æ•°ä¼ å…¥ã€‚è¿™ç§æ‰‹æ³•æˆ‘åœ¨è®¾è®¡æˆ‘çš„ [Image Engine]() é¡¹ç›®ä¸­çš„ Event API çš„æ—¶å€™ç”¨åˆ°äº†ï¼Œè¿™ä¸ª API å°±æ˜¯å½“ä½¿ç”¨ closure æ¥ç›‘å¬ event çš„æ—¶å€™ï¼Œéœ€è¦ä½ ä¼ é€’ä¸€ä¸ª observer ç»™å®ƒã€‚å¦‚ä¸‹æ‰€ç¤ºï¼Œä½ æŠŠ self ä¼ å…¥è¿›æ¥çš„åŒæ—¶ä¹Ÿä½¿å¾—å…¶è¢«ä¼ é€’åˆ°äº† event çš„ closure ä¸­äº†ï¼Œè¿™ä¹Ÿä½¿å¾— self è¢«éšå¼çš„å¸¦å…¥ï¼Œä½ ä¹Ÿæ— éœ€æ‰‹åŠ¨çš„æ•è·å®ƒäº†ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;actor.events.moved.addObserver(self) { scene in
    ...
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;æˆ‘ä»¬å›åˆ°ä¹‹å‰çš„ ListViewController çš„ä¾‹å­ä¸­ï¼Œçœ‹ä¸€çœ‹å½“æˆ‘ä»¬è¦ç›‘å¬å…¶ viewModel çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•é€šè¿‡ä¸Šé¢è¿™ç§æ‰‹æ³•æ¥å®ç°åŒæ ·çš„ API çš„ã€‚è¿™ç§æ–¹å¼æ­£å¥½ä½¿å¾—æˆ‘ä»¬å¯ä»¥å°†è¦ reload çš„ tableView ä½œä¸ºè§‚æµ‹è€…ä¼ é€’ï¼Œå®ç°ä¸€ä¸ªå¾ˆä¼˜é›…çš„è°ƒç”¨ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;viewModel.numberOfItemsChanged.addObserver(tableView) { tableView in
    tableView.reloadData()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å½“ç„¶ï¼Œéœ€è¦å®ç°ä¸Šé¢è¿™æ®µä»£ç ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åšä¸€äº›äº‹æƒ…ï¼Œå°±åƒ Image Engine çš„äº‹ä»¶ç³»ç»Ÿå¦‚ä½•å·¥ä½œç±»ä¼¼ã€‚æˆ‘ä»¬é¦–å…ˆå®šä¹‰ä¸€ä¸ªç®€å•çš„ Event ç±»å‹ï¼Œå…¶å¯ä»¥è®°å½•é‚£äº›è§‚æµ‹é—­åŒ…ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class Event {
    private var observers = [() -&amp;gt; Void]()
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•ä¼šä¼ ä¸¤ä¸ªå‚æ•°è¿›æ¥ï¼Œä¸€ä¸ªæ˜¯å¼•ç”¨ç±»å‹çš„è§‚æµ‹è€…ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå½“è§‚å¯ŸåŠ¨ä½œä¸€æ—¦è§¦å‘ï¼Œè¯¥é—­åŒ…å°±ä¼šè¢«è°ƒç”¨ã€‚æ ¸å¿ƒå°±åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬ä¼šå°è£…è¯¥é—­åŒ…ï¼Œå¹¶ä¸”åœ¨å†…éƒ¨é—­åŒ…ä¸­å¼±æ•è·è¯¥è§‚æµ‹è€…ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;func addObserver&amp;lt;T: AnyObject&amp;gt;(_ observer: T, using closure: @escaping (T) -&amp;gt; Void) {
    observers.append { [weak observer] in
        observer.map(closure)
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™æ ·å°±ä½¿å¾—æˆ‘ä»¬åªéœ€è¦åšè¿™ä¹ˆä¸€æ¬¡ weak/string çš„æ“ä½œï¼Œä¹Ÿä¸å½±å“å…¶è°ƒç”¨çš„åœ°æ–¹ã€‚&lt;/p&gt;

&lt;p&gt;æœ€åï¼Œæˆ‘ä»¬æ·»åŠ ä¸€ä¸ª trigger æ–¹æ³•æ¥ä½¿å¾—æˆ‘ä»¬èƒ½å¤Ÿè§¦å‘äº‹ä»¶æœ¬èº«ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;func trigger() {
    for observer in observers {
        observer()
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åå›åˆ° &lt;code&gt;ListViewModel&lt;/code&gt;ï¼Œä¸º &lt;code&gt;numberOfItemsChanged&lt;/code&gt; æ–¹æ³•æ·»åŠ äº‹ä»¶ï¼Œå½“æŸä¸ªæ¡ä»¶æ»¡è¶³çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘è¯¥äº‹ä»¶ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;class ListViewModel {
    let numberOfItemsChanged = Event()
    var items: [Item] { didSet { itemsDidChange(from: oldValue) } }

    private func itemsDidChange(from previousItems: [Item]) {
        if previousItems.count != items.count {
            numberOfItemsChanged.trigger()
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚ä¸Šé¢æ‰€çœ‹åˆ°çš„ï¼ŒåŸºäº event çš„ API çš„æœ€å¤§ä¼˜åŠ¿å°±æ˜¯æœ€å¤§ç¨‹åº¦ä¸Šé¿å…äº†å¼•ç”¨å¾ªç¯çš„å‘ç”Ÿã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æˆ‘ä»¬çš„ä»£ç ä¸­ä¸ºä»»æ„ç±»å‹çš„è§‚å¯Ÿäº‹ä»¶é‡ç”¨ç›¸åŒçš„æ‰§è¡Œä»£ç ã€‚å½“ç„¶ï¼Œä¸Šé¢çš„ demo ä¸­ Event å®ç°éå¸¸ç®€å•ï¼Œç¼ºä¹ä¸€äº›é«˜çº§ç‰¹æ€§ï¼Œæ¯”å¦‚é’ˆå¯¹è§‚å¯Ÿè€…çš„ç§»é™¤ç­‰ç­‰ï¼Œä½†æ˜¯å¯¹äºç®€å•ä½¿ç”¨å·²ç»è¶³å¤Ÿäº†ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ä¼šåœ¨ä¹‹åçš„åšæ–‡ä¸­è¯¦ç»†çš„è®²è¿°äº‹ä»¶é©±åŠ¨çš„ç¼–ç¨‹èŒƒå¼ï¼Œä½ ä¹Ÿå¯ä»¥è¯¦ç»†çœ‹ä¸‹åœ¨ Image Engine é¡¹ç›®ä¸­çš„ &lt;a href=&#34;https://github.com/JohnSundell/ImagineEngine/blob/master/Sources/Core/API/Event.swift&#34;&gt;Event ç±»å‹çš„å®Œæ•´å®ç°&lt;/a&gt;ã€‚&lt;/p&gt;

&lt;h2 id=&#34;æ€»ç»“&#34;&gt;æ€»ç»“&lt;/h2&gt;

&lt;p&gt;Closure è‡ªåŠ¨æ•è·å…¶å†…éƒ¨æ‰€ä½¿ç”¨çš„å¯¹è±¡å’Œå€¼æœ¬èº«æ˜¯ä¸€ä¸ªéå¸¸æ£’çš„ç‰¹è‰²ï¼Œå®ƒä½¿å¾— closure æœ¬èº«å˜å¾—éå¸¸å¥½ç”¨ã€‚ä½†æ˜¯ï¼Œæ•è·åŒæ—¶ä¹Ÿå¼•å…¥äº†ä¸€äº› bug å’Œå¼•ç”¨å¾ªç¯çš„é—®é¢˜ï¼Œç”šè‡³æœ€åä½¿å¾—ä»£ç å˜å¾—å¤æ‚å’Œéš¾ä»¥ç†è§£ã€‚&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œæˆ‘å¹¶ä¸æ˜¯å»ºè®®å¤§å®¶åœ¨æ‰€æœ‰çš„åœºæ™¯ä¸‹å»é¿å…æ•è·å‘ç”Ÿï¼Œè€Œæ˜¯æƒ³é€šè¿‡è¿™ç¯‡æ–‡ç« æä¾›ç»™å¤§å®¶ä¸€äº›æ•è· self çš„é€‰æ‹©ã€‚åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œä½¿ç”¨ç»å…¸çš„ [weak self] æ˜¯æœ€æœ‰æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼Œå¦å¤–ä¸€äº›åœºæ™¯åˆ™å¯ä»¥ä½¿ç”¨æŸäº›æ‰‹æ³•æ¥å¸®åŠ©ä½ æŠŠè‡ªå·±çš„é—­åŒ…ä»£ç å†™çš„æ›´å®¹æ˜“ä½¿ç”¨ï¼Œä¹Ÿæ›´å®¹æ˜“ç†è§£å§ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>@autoclosure &amp;&amp; @escape</title>
      <link>https://hechen.xyz/post/autoclosure-escape/</link>
      <pubDate>Sun, 12 Nov 2017 20:01:54 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/autoclosure-escape/</guid>
      
        <description>

&lt;p&gt;æˆ‘ä»¬çŸ¥é“åœ¨ &lt;code&gt;swift&lt;/code&gt; ä¸­ï¼Œé—­åŒ…ï¼ˆclosureï¼‰æ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå› æ­¤å¯ä»¥è¢«å½“ä½œå‚æ•°ä¼ é€’ï¼Œåœ¨å­¦ä¹  swift çš„è¿‡ç¨‹ä¸­ç»å¸¸ä¼šçœ‹åˆ°æŸäº›å…³é”®å­—ä¿®é¥°è¯¥é—­åŒ…ï¼Œ&lt;code&gt;@autoclosure&lt;/code&gt;ï¼Œ &lt;code&gt;@escape&lt;/code&gt; å°±æ˜¯å…¶ä¸­æ¯”è¾ƒå¸¸è§çš„ä¸¤ç§å…³é”®å­—ã€‚&lt;/p&gt;

&lt;h3 id=&#34;escape-å’Œ-nonescape&#34;&gt;@escape å’Œ @nonescape&lt;/h3&gt;

&lt;p&gt;å½“ä¸€ä¸ªé—­åŒ…è¢«å½“ä½œå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°ï¼Œä½†æ˜¯å½“è¯¥å‡½æ•°å†…å®¹æ‰§è¡Œå®Œæ¯•è¿”å›ä¹‹åï¼Œè¯¥é—­åŒ…æ‰ä¼šè¢«æ‰§è¡Œï¼Œæˆ‘ä»¬å°±ç§°è¯¥é—­åŒ…è¦ escape æŸä¸ªå‡½æ•°ï¼Œé‚£ &lt;code&gt;@escape&lt;/code&gt; å…³é”®å­—å°±æ˜¯ç”¨æ¥è¡¨ç¤ºè¯¥é—­åŒ…æ˜¯å…è®¸åœ¨å‡½æ•°è¿”å›ä¹‹åè¢«è°ƒç”¨çš„ã€‚&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬ç”¨ swift å®˜æ–¹æ–‡æ¡£çš„ä¾‹å­æ¥çœ‹ï¼Œå¦‚ä¸‹æ‰€ç¤º&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;var completionHandlers: [() -&amp;gt; Void] = []

func someFunctionWithEscapingClosure(completionHandler: @escaping () -&amp;gt; Void) {
    completionHandlers.append(completionHandler)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;someFunctionWithEscapingClosure(_:)&lt;/code&gt; çš„å‚æ•°æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå‡½æ•°å†…éƒ¨ä¼šæŠŠä¼ å…¥çš„é—­åŒ…å­˜åˆ°ä¹‹å‰å£°æ˜çš„æ•°ç»„é‡Œä»¥ä¾¿ä¹‹åè¿›è¡Œè°ƒç”¨ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨å‡½æ•°å‚æ•°çš„å£°æ˜éƒ¨åˆ†æ·»åŠ äº† &lt;code&gt;@escaping&lt;/code&gt; å…³é”®å­—ï¼Œå¦‚æœè¿™é‡Œä¸æ·»åŠ çš„è¯ï¼Œå°±ä¼šåœ¨ç¼–è¯‘çš„æ—¶å€™æŠ¥é”™ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;error: passing non-escaping parameter &#39;completionHandler&#39; to function expecting an @escaping closure
    completionHandlers.append(completionHandler)    
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;é’ˆå¯¹æ ‡è®°äº† @escaping å…³é”®å­—å«ä¹‰ä»£è¡¨ä½ å¿…é¡»åœ¨è¯¥é—­åŒ…å†…éƒ¨æ˜¾å¼çš„ä½¿ç”¨ self å…³é”®å­—ï¼Œå®˜æ–¹æ–‡æ¡£ä¸­åˆåˆ—ä¸¾äº†å¦å¤–ä¸€ä¸ªä¾‹å­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;func someFunctionWithNonescapingClosure(closure: () -&amp;gt; Void) {
    closure()
}
 
class SomeClass {
    var x = 10
    func doSomething() {
        someFunctionWithEscapingClosure { self.x = 100 }
        someFunctionWithNonescapingClosure { x = 200 }
    }
}
 
let instance = SomeClass()
instance.doSomething()
print(instance.x)
// Prints &amp;quot;200&amp;quot;
 
completionHandlers.first?()
print(instance.x)
// Prints &amp;quot;100â€
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;code&gt;someFunctionWithEscapingClosure(_:)&lt;/code&gt; æ˜¯ä¸€ä¸ªå¯é€ƒé€¸çš„é—­åŒ…ï¼Œæ„å‘³ç€ä½ éœ€è¦æ˜¾ç¤ºçš„è°ƒç”¨ self å…³é”®å­—ï¼Œ è€Œ &lt;code&gt;someFunctionWithNonescapingClosure(_:)&lt;/code&gt; æ˜¯éé€ƒé€¸çš„é—­åŒ…ï¼Œæ„å‘³ç€ä½ å¯ä»¥éšå¼çš„è°ƒç”¨ selfã€‚&lt;/p&gt;

&lt;h3 id=&#34;autoclosure&#34;&gt;@autoclosure&lt;/h3&gt;

&lt;h4 id=&#34;ä¾‹å­è®²è§£&#34;&gt;ä¾‹å­è®²è§£&lt;/h4&gt;

&lt;p&gt;é€šè¿‡ä¸€ä¸ªğŸŒ°æ¥è¯´æ˜ &lt;code&gt;@autoclosure&lt;/code&gt; å…³é”®å­—åˆ°åº•èµ·åˆ°ä»€ä¹ˆä½œç”¨ã€‚&lt;/p&gt;

&lt;p&gt;è€ƒè™‘ä¸‹é¢è¿™ä¸ªå‡½æ•° fï¼Œå…¶éœ€ä¼ å…¥ä¸€ä¸ªå‚æ•°ï¼Œç±»å‹æ˜¯ &lt;code&gt;()-&amp;gt; Bool&lt;/code&gt; çš„é—­åŒ…ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;func f(predicate: () -&amp;gt; Bool) {
    if predicate() {
        print(&amp;quot;It&#39;s true&amp;quot;)
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç„¶åé€šè¿‡ä¼ å…¥ç¬¦åˆæ­¤ç±»å‹çš„é—­åŒ…è¿›è¡Œè°ƒç”¨&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;f(predicate: {2 &amp;gt; 1})
// &amp;quot;It&#39;s true&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¿½ç•¥ä¼ å…¥é—­åŒ…çš„ &lt;code&gt;{&lt;/code&gt; å’Œ &lt;code&gt;}&lt;/code&gt; ï¼Œç¼–è¯‘å°±ä¼šé”™è¯¯ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;f(predicate: 2 &amp;gt; 1)
// error: &#39;&amp;gt;&#39; produces &#39;Bool&#39;, not the expected contextual result type &#39;() -&amp;gt; Bool&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æ–‡æ¡£ä¸­æ‰€è¯´ï¼Œä¸€ä¸ª autoclosure (è‡ªä¸»é—­åŒ…ï¼Ÿ)æ˜¯è¿™æ ·ä¸€ç§é—­åŒ…: å½“æŸä¸ªè¡¨è¾¾å¼è¢«å½“åšå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªå‡½æ•°çš„æ—¶å€™ä¼šè¢« wrap æˆä¸€ä¸ªé—­åŒ…ï¼Œè¯¥é—­åŒ…æ²¡æœ‰ä»»ä½•å‚æ•°ï¼Œå…¶è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œè¿”å›çš„æ˜¯å…¶ wrap çš„è¡¨è¾¾å¼çš„å€¼ã€‚swift æä¾›è¿™ç§è¯­æ³•ç³–å°±èƒ½å¤Ÿè®©ä½ çœç•¥ {} è€Œç›´æ¥å†™ä¸€ä¸ªè¡¨è¾¾å¼ã€‚&lt;/p&gt;

&lt;p&gt;ç»“åˆä¸Šé¢çš„ä¾‹å­æ¥çœ‹ï¼Œå½“ä½ å†™ä¸ªè¡¨è¾¾å¼ç±»ä¼¼ 2 &amp;gt; 1 ä¼ ç»™å‡½æ•° f çš„æ—¶å€™ï¼Œè¯¥è¡¨è¾¾å¼ä¼šè¢«è‡ªåŠ¨åŒ…è£¹åˆ°ä¸€ä¸ªé—­åŒ…ä¸­ï¼Œä¼šè‡ªåŠ¨å¤„ç†ä¸º { 2 &amp;gt; 1 } è€Œä¼ é€’ç»™å‡½æ•° fã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;func f(predicate: @autoclosure () -&amp;gt; Bool) {
    if predicate() {
        print(&amp;quot;It&#39;s true&amp;quot;)
    }
}

f(predicate: 2 &amp;gt; 1)
// It&#39;s true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;âš ï¸ @autoclosure å¹¶ä¸æ”¯æŒå¸¦æœ‰è¾“å…¥å‚æ•°çš„å†™æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´åªæœ‰å½¢å¦‚ () -&amp;gt; T çš„å‚æ•°æ‰èƒ½ç®€åŒ–&lt;/p&gt;

&lt;h4 id=&#34;delay-evaluation&#34;&gt;Delay Evaluation&lt;/h4&gt;

&lt;p&gt;swift æä¾›äº† ?? æ“ä½œç¬¦ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;let nickName: String? = nil
let fullName: String = &amp;quot;John Appleseed&amp;quot;
let informalGreeting = &amp;quot;Hi \(nickName ?? fullName)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å¦‚æœæŸ Optional å­˜åœ¨å°±ä¼šè¿”å›å…¶å€¼ï¼Œå¦‚æœæ²¡æœ‰å°±ä¼šè¿”å›åé¢çš„é»˜è®¤å€¼ï¼Œå½“æˆ‘ä»¬å»çœ‹ ?? çš„å®ç°çš„æ—¶å€™èƒ½çœ‹åˆ°å¦‚ä¸‹å®šä¹‰ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;func ??&amp;lt;T&amp;gt;(optional: T?, defaultValue: @autoclosure () -&amp;gt; T?) -&amp;gt; T?

func ??&amp;lt;T&amp;gt;(optional: T?, defaultValue: @autoclosure () -&amp;gt; T) -&amp;gt; T
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;çœ‹å¾—å‡ºæ¥ &lt;code&gt;??&lt;/code&gt; æ˜¯ä¸€ä¸ªäºŒå…ƒæ“ä½œç¬¦ï¼Œoptional æŒ‡ä»£ ?? å‰é¢çš„è¾“å…¥ï¼ŒdefaultValue æŒ‡ä»£ &lt;code&gt;??&lt;/code&gt; åé¢çš„å‚æ•°ï¼Œé‚£æˆ‘ä»¬å°±ä¼šæƒ³ï¼Œæˆ‘ä»¬ä¸Šé¢çš„ä¾‹å­ä¸­ &lt;code&gt;fullName&lt;/code&gt; åªæ˜¯ä¸€ä¸ª &lt;code&gt;String&lt;/code&gt;ï¼Œæ€ä¹ˆå˜æˆ &lt;code&gt;() -&amp;gt; T&lt;/code&gt; ç±»å‹çš„å‘¢ï¼Ÿ è¿™ä¸ªå°±çœ‹å‰é¢çš„ &lt;code&gt;@autoclosure&lt;/code&gt; çš„å¨åŠ›äº†ï¼Œå‰é¢è®²è¿‡äº†ï¼Œè¯¥å…³é”®å­—æŠŠè¡¨è¾¾å¼çš„å€¼å°è£…æˆé—­åŒ…å¹¶ä¸”è¿”å›è¯¥è¡¨è¾¾å¼çš„å€¼äº†ã€‚ å…¶å®ä¼ å…¥è¯¥æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯ &lt;code&gt;{ fullName }&lt;/code&gt;ã€‚&lt;/p&gt;

&lt;p&gt;æ‰€ä»¥å¯ä»¥æƒ³åˆ°è¯¥æ–¹æ³•çš„å®ç°åº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼Œï¼ˆå½“ç„¶ fullName ä¸º String ç±»å‹ï¼Œåº”è¯¥ä¼šé‡è½½ç¬¬äºŒä¸ªå‡½æ•°å®ç°ï¼‰&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;func ??&amp;lt;T&amp;gt;(optional: T?, defaultValue: @autoclosure () -&amp;gt; T) -&amp;gt; T {
    switch optional {
        case .Some(let value):
            return value
        case .None:
            return defaultValue()
        }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;è¿™é‡Œæˆ‘ä»¬è¿˜éœ€è¦æ³¨æ„ä¸€ç‚¹çš„æ˜¯ï¼Œä½¿ç”¨ &lt;code&gt;@autoclosure&lt;/code&gt; æ¥ä¿®é¥°çš„è¡¨è¾¾å¼å¯ä»¥å®ç°å»¶è¿Ÿè®¡ç®—ï¼Œä¹Ÿå°±æ˜¯è¯´ç›´åˆ°è¯¥é—­åŒ…è¢«è°ƒç”¨ä¹‹å‰ï¼Œé—­åŒ…é‡Œæ‰€è¢«åŒ…è£¹çš„è¡¨è¾¾å¼éƒ½ä¸ä¼šè¿›è¡Œå–å€¼è®¡ç®—ï¼Œä¹Ÿå°±é¿å…äº†ä¸€å®šçš„å¼€é”€ï¼Œå°¤å…¶æ˜¯ä¸Šé¢é»˜è®¤å€¼æ˜¯å¤æ‚è®¡ç®—å¾—åˆ°çš„è¯ã€‚&lt;/p&gt;
</description>
      
    </item>
    
    <item>
      <title>å…³äº iOS10 Notification çš„é‚£äº›äº‹å„¿</title>
      <link>https://hechen.xyz/post/ios-notification/</link>
      <pubDate>Sat, 20 May 2017 10:10:54 +0000</pubDate>
      
      <guid>https://hechen.xyz/post/ios-notification/</guid>
      
        <description>

&lt;h3 id=&#34;æ¦‚è§ˆ&#34;&gt;æ¦‚è§ˆ&lt;/h3&gt;

&lt;p&gt;æ¨é€é€šçŸ¥æˆ‘ä»¬å¤§å®¶éƒ½ä¸é™Œç”Ÿï¼Œå¯ä»¥è¯´å‡ ä¹æ¯ä¸ªä½¿ç”¨æ™ºèƒ½æ‰‹æœºçš„äººæ¯å¤©éƒ½ä¼šè¢«ä¸åŒçš„é€šçŸ¥ &lt;em&gt;æ‰“æ‰°&lt;/em&gt; åˆ°ï¼Œæ­£å¼å› ä¸ºåˆé€‚çš„æ¨é€æ˜¯å¸å¼•ç”¨æˆ·æ³¨æ„åŠ›çš„åˆ©å™¨ï¼Œå…¶æˆä¸ºäº†å„ App å¸å¼•ç”¨æˆ·ï¼Œå°†ç”¨æˆ·å¸¦å›åˆ° App æœ¬èº«ï¼Œæå‡ç”¨æˆ·çš„æ´»è·ƒåº¦çš„ä¸€ç§å¿…è¦çš„æ–¹å¼ã€‚å½“ç„¶è¦æ³¨æ„çš„æ˜¯ï¼Œæ¨é€æœ¬èº«æ˜¯ä¸€ä»¶å¯¹ç”¨æˆ·å½±å“ç‰¹åˆ«å¤§çš„äº‹æƒ…ï¼Œæ¯•ç«Ÿæ³¨æ„åŠ›è¢«æ‰“æ–­ï¼Œå› æ­¤åˆé€‚çš„æ¨é€æ—¶æœºä¹Ÿæ˜¯å„ä¸ª App å¼€å‘è€…æ‰€è¦æ³¨æ„çš„ï¼Œå¦åˆ™å°±ä¼šæˆä¸ºç”¨æˆ·å‹¿æ‰°åå•é‡Œçš„ä¸€å‘˜äº†ã€‚&lt;/p&gt;

&lt;p&gt;ä¹‹å‰åˆšå¼€å§‹å­¦ä¹  iOS å¼€å‘çš„æ—¶å€™è¿˜æ•´ç†äº†ä¸‹å½“æ—¶éƒ¨ç½² iOS è¿œç¨‹æ¨é€çš„æµç¨‹ï¼Œè¯¦è§ï¼š&lt;a href=&#34;http://hechen.info/2015/07/30/iOS-Push-Notification/&#34;&gt;iOS è¿œç«¯æ¨é€éƒ¨ç½²è¯¦è§£&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¤§è‡´å›é¡¾ä¸€ä¸‹ iOS å¹³å°å…³äºæ¨é€éƒ½æœ‰å“ªäº›å†ç¨‹ï¼Ÿ&lt;/p&gt;

&lt;!-- more --&gt;

&lt;h3 id=&#34;å†å²&#34;&gt;å†å²&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&amp;lt;= iOS 6&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;è¿œç¨‹æ¨é€é€šçŸ¥ ï¼ˆiOS 3ï¼‰&lt;/li&gt;
&lt;li&gt;æœ¬åœ°é€šçŸ¥ ï¼ˆiOS 4ï¼‰&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;iOS 7  å‚è€ƒ&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¼•å…¥ Silent Remote Notifications&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;iOS 8  å‚è€ƒ &lt;a href=&#34;https://developer.apple.com/videos/play/wwdc2014/713/&#34;&gt;WWDC 2014 Session 713&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¼•å…¥ Actionable Notifications&lt;/li&gt;
&lt;li&gt;ä¿®æ”¹ Notification çš„æƒé™è¯·æ±‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;iOS 9  å‚è€ƒ &lt;a href=&#34;https://developer.apple.com/videos/play/wwdc2015/720/&#34;&gt;WWDC 2015 Session 720&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;å¼•å…¥ Text Input Action&lt;/li&gt;
&lt;li&gt;UIUserNotificationActionBehavior&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;iOS 10 å‚è€ƒ &lt;a href=&#34;https://developer.apple.com/videos/play/wwdc2016/707&#34;&gt;WWDC 707 Introduction to Notifications&lt;/a&gt; &amp;amp;&amp;amp; &lt;a href=&#34;https://developer.apple.com/videos/play/wwdc2016/708&#34;&gt;WWDC 708 Advanced Notifications&lt;/a&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;UserNotification Framework&lt;/li&gt;
&lt;li&gt;Extensions&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;WWDC 2016 å¤§ä¼šä¸Šï¼ŒApple åœ¨ iOS 10 ä¸Šå¼•å…¥äº† &lt;strong&gt;UserNotification&lt;/strong&gt; æ¡†æ¶ï¼Œå¯ä»¥è¯´æ˜¯å¯¹ä¹‹å‰çš„å„ç§ä»£ç åšäº†ä¸€æ¬¡é‡æ„ã€‚è¯¥æ¡†æ¶ç»Ÿä¸€äº†é€šçŸ¥çš„è¡Œä¸ºï¼Œå°¤å…¶æ˜¯é’ˆå¯¹è¿œç¨‹æ¨é€å’Œæœ¬åœ°æ¨é€ä¸å†æœ‰ä¸¤å¥—å®Œå…¨ä¸åŒçš„ä½¿ç”¨æ–¹å¼äº†ã€‚&lt;/p&gt;

&lt;h3 id=&#34;å˜åŒ–&#34;&gt;å˜åŒ–&lt;/h3&gt;

&lt;p&gt;å…³äº iOS 10 ä¸Š UserNotification æ¡†æ¶çš„å˜åŒ–ï¼Œä¸»è¦ä»å‡ ä¸ªæ–¹é¢æ¥è®²è¿°ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;æƒé™ç”³è¯·&lt;/li&gt;
&lt;li&gt;æ¨é€å†…å®¹å˜æ›´&lt;/li&gt;
&lt;li&gt;æ¨é€ç®¡ç†&lt;/li&gt;
&lt;li&gt;Extensions&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;æƒé™ç”³è¯·&#34;&gt;æƒé™ç”³è¯·&lt;/h4&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;UNUserNotificationCenter.current().requestAuthorization(options: [.alert, .sound, .badge]) {
    granted, error in
    if granted {
        // ç”¨æˆ·å…è®¸è¿›è¡Œé€šçŸ¥
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;è¿œç¨‹æ¨é€&#34;&gt;è¿œç¨‹æ¨é€&lt;/h4&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;// å‘ APNs è¯·æ±‚ tokenï¼š

// iOS 10 support
if #available(iOS 10, *) {  
    UNUserNotificationCenter.current().requestAuthorization(options:[.badge, .alert, .sound]){ (granted, error) in }
    application.registerForRemoteNotifications()
}
// iOS 9 support
else if #available(iOS 9, *) {  

UIApplication.shared.registerUserNotificationSettings(UIUserNotificationSettings(types: [.badge, .sound, .alert], categories: nil))
    UIApplication.shared.registerForRemoteNotifications()
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…³äºæ³¨å†Œè¿œç¨‹é€šçŸ¥çš„å›è°ƒæ–¹æ³•ä¸€è‡´ï¼Œ&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;
// AppDelegate.swift
 func application(_ application: UIApplication, didRegisterForRemoteNotificationsWithDeviceToken deviceToken: Data) {
    let tokenString = deviceToken.hexString
    print(&amp;quot;Get Push token: \(tokenString)&amp;quot;)
}
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;payloads&#34;&gt;Payloads&lt;/h4&gt;

&lt;p&gt;&amp;lt;  iOS 10&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-JSON&#34;&gt; {
   &amp;quot;aps&amp;quot;:{
     &amp;quot;alert&amp;quot;:&amp;quot;Test&amp;quot;,
     &amp;quot;sound&amp;quot;:&amp;quot;default&amp;quot;,
     &amp;quot;badge&amp;quot;:1
   }
 }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;iOS 10 ç³»ç»Ÿæä¾›äº†æ›´ä¸ºä¸°å¯Œçš„ç»“æ„ï¼Œæ¯”å¦‚å¯ä»¥æŒ‡å®š Titleï¼ŒSubtitle ç­‰&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-JSON&#34;&gt;{
   &amp;quot;aps&amp;quot;:{
     &amp;quot;alert&amp;quot;:{
       &amp;quot;title&amp;quot;:&amp;quot;This is a title&amp;quot;,
       &amp;quot;subtitle&amp;quot;:&amp;quot;This is a subtitle&amp;quot;,
       &amp;quot;body&amp;quot;:&amp;quot;This is body&amp;quot;
     },
     &amp;quot;sound&amp;quot;:&amp;quot;default&amp;quot;,
     &amp;quot;badge&amp;quot;:1
   }
 }
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ç”šè‡³ï¼Œç°åœ¨å¯ä»¥æ”¯æŒå¤šåª’ä½“çš„å±•ç¤ºäº†ï¼Œåœ¨ payload ä¸Šä¹Ÿæœ‰ç›¸åº”çš„ä½“ç°ï¼Œä¾‹å¦‚ä¸‹é¢å‡ ä¾‹ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æ”¯æŒå›¾ç‰‡&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-JSON&#34;&gt;{
    &amp;quot;aps&amp;quot;:{
        &amp;quot;alert&amp;quot;: {
            &amp;quot;title&amp;quot;: &amp;quot;Title: Notification Demo&amp;quot;, 
            &amp;quot;subtitle&amp;quot;: &amp;quot;Subtitle: show iOS 10 support!&amp;quot;,
            &amp;quot;body&amp;quot;: &amp;quot;The Main Body For Notification!&amp;quot;
            },
            &amp;quot;mutable-content&amp;quot;: 1
        },
    &amp;quot;image&amp;quot; : &amp;quot;https://pic1.zhimg.com/v2-0314056e4f13141b6ca2277078ec067c.jpg&amp;quot;,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;æ”¯æŒéŸ³é¢‘&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-JSON&#34;&gt;    
{
    &amp;quot;aps&amp;quot;:{
        &amp;quot;alert&amp;quot;: {
        &amp;quot;title&amp;quot;: &amp;quot;Title: Notification Demo&amp;quot;, 
        &amp;quot;subtitle&amp;quot;: &amp;quot;Subtitle: show iOS 10 support!&amp;quot;, 
        &amp;quot;body&amp;quot;: &amp;quot;The Main Body For Notification!&amp;quot;
        },
        &amp;quot;mutable-content&amp;quot;: 1,
    },
    &amp;quot;audio&amp;quot; : &amp;quot;http://hao.1015600.com/upload/ring/000/982/d9924a7f4e4ab06e52a11dfdd32ffae1.mp3&amp;quot;,
}
    
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å…·ä½“æ‰€æœ‰çš„ Key å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ &lt;a href=&#34;https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/PayloadKeyReference.html&#34;&gt;Payload Key Reference&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;æ³¨æ„åˆ°æœ‰ä¸ª key:  launch-image ï¼Œå¯ä»¥æŒ‡å®šç”¨æˆ·ç‚¹å‡»é€šçŸ¥å¯åŠ¨ App çš„æ—¶å€™çš„ Launch Image&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h4 id=&#34;å¯ä»¥æ’¤é”€å’Œæ›´æ–°é€šçŸ¥äº†&#34;&gt;å¯ä»¥æ’¤é”€å’Œæ›´æ–°é€šçŸ¥äº†ï¼&lt;/h4&gt;

&lt;p&gt;UserNotification æ¡†æ¶ API æä¾›äº†é€šçŸ¥çš„æ›´æ–°å’Œæ’¤é”€çš„æ¥å£ã€‚å…·ä½“åŠŸèƒ½ä¸»è¦åŒ…å«å‡ ä¸ªéƒ¨åˆ†ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;åˆ é™¤æœªå±•ç¤ºçš„é€šçŸ¥&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;        let trigger = UNTimeIntervalNotificationTrigger(timeInterval: 3, repeats: false)
        let identifier = Constants.pendingRemoveNotificationIdentifier
        let request = UNNotificationRequest(identifier: identifier, content: title1Content, trigger: trigger)
            
        UNUserNotificationCenter.current().add(request) { error in
            if let error = error {
                print(&amp;quot;remove pending notification error: \(error)&amp;quot;)
            } else {
                print(&amp;quot;Notification request added: \(identifier)&amp;quot;)
            }
        }
            
        delay(2) {
            print(&amp;quot;Notification request removed: \(identifier)&amp;quot;)
            UNUserNotificationCenter.current().removePendingNotificationRequests(withIdentifiers: [identifier])
        }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;æ›´æ–°æœªå±•ç¤ºçš„é€šçŸ¥&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;        let trigger = UNTimeIntervalNotificationTrigger(timeInterval: 3, repeats: false)
        let identifier = Constants.pendingUpdateNotificationIdentifier
        let request = UNNotificationRequest(identifier: identifier, content: title1Content, trigger: trigger)
            
        UNUserNotificationCenter.current().add(request) { error in
            if let error = error {
                print(&amp;quot;update pending notification error: \(error)&amp;quot;)
            } else {
                print(&amp;quot;Notification request added: \(identifier) with title1&amp;quot;)
            }
        }
            
        delay(2) {
            let newTrigger = UNTimeIntervalNotificationTrigger(timeInterval: 1, repeats: false)
                
            // Add new request with the same identifier to update a notification.
            let newRequest = UNNotificationRequest(identifier: identifier, content: self.title2Content, trigger: newTrigger)
            UNUserNotificationCenter.current().add(newRequest) { error in
                if let error = error {
                    print(&amp;quot;update delivered notification error: \(error)&amp;quot;)
                } else {
                    print(&amp;quot;Notification request updated: \(identifier) with title2&amp;quot;)
                }
            }
        }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;åˆ é™¤å·²ç»å±•ç¤ºçš„é€šçŸ¥&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;        let trigger = UNTimeIntervalNotificationTrigger(timeInterval: 3, repeats: false)
        let identifier = Constants.pendingUpdateNotificationIdentifier
        let request = UNNotificationRequest(identifier: identifier, content: title1Content, trigger: trigger)
            
        UNUserNotificationCenter.current().add(request) { error in
            if let error = error {
                print(&amp;quot;update pending notification error: \(error)&amp;quot;)
            } else {
                print(&amp;quot;Notification request added: \(identifier) with title1&amp;quot;)
            }
        }
            
        delay(2) {
            let newTrigger = UNTimeIntervalNotificationTrigger(timeInterval: 1, repeats: false)
                
            // Add new request with the same identifier to update a notification.
            let newRequest = UNNotificationRequest(identifier: identifier, content: self.title2Content, trigger: newTrigger)
            UNUserNotificationCenter.current().add(newRequest) { error in
                if let error = error {
                    print(&amp;quot;update delivered notification error: \(error)&amp;quot;)
                } else {
                    print(&amp;quot;Notification request updated: \(identifier) with title2&amp;quot;)
                }
            }
        }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;æ›´æ–°å·²ç»å±•ç¤ºçš„é€šçŸ¥&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;    let trigger = UNTimeIntervalNotificationTrigger(timeInterval: 3, repeats: false)
        let identifier = Constants.deliveredUpdateNotificationIdentifier
        let request = UNNotificationRequest(identifier: identifier, content: title1Content, trigger: trigger)
            
        UNUserNotificationCenter.current().add(request) { error in
            if let error = error {
                    
            } else {
                print(&amp;quot;Notification request added: \(identifier) with title1&amp;quot;)
            }
        }
            
        delay(4) {
            let newTrigger = UNTimeIntervalNotificationTrigger(timeInterval: 1, repeats: false)
                
            // Add new request with the same identifier to update a notification.
            let newRequest = UNNotificationRequest(identifier: identifier, content: self.title2Content, trigger: newTrigger)
            UNUserNotificationCenter.current().add(newRequest) { error in
                if let error = error {
                        
                } else {
                    print(&amp;quot;Notification request updated: \(identifier) with title2&amp;quot;)
                }
            }
        }
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å½“ç„¶ï¼Œä¸Šè¿°å‡æ˜¯é’ˆå¯¹æœ¬åœ°é€šçŸ¥çš„æ“ä½œï¼Œå…³äºè¿œç¨‹æ¨é€é€šçŸ¥ï¼Œç›®å‰åªæ”¯æŒæ›´æ–°é€šçŸ¥ï¼Œè¿œç¨‹æ¨é€å¯ä»¥è¿›è¡Œé€šçŸ¥çš„æ›´æ–°ï¼Œåœ¨ä½¿ç”¨ Provider API å‘ APNs æäº¤è¯·æ±‚æ—¶ï¼Œåœ¨ HTTP/2 çš„ header ä¸­ apns-collapse-id key çš„å†…å®¹å°†è¢«ä½œä¸ºè¯¥æ¨é€çš„æ ‡è¯†ç¬¦è¿›è¡Œä½¿ç”¨ã€‚å¤šæ¬¡æ¨é€åŒä¸€æ ‡è¯†ç¬¦çš„é€šçŸ¥å³å¯è¿›è¡Œæ›´æ–°ã€‚&lt;/p&gt;

&lt;h4 id=&#34;notification-extension&#34;&gt;Notification Extension&lt;/h4&gt;

&lt;p&gt;iOS 10 ä¸­æœ€é‡è¦çš„ä¸€ä¸ªå˜åŒ–å°±æ˜¯ Extensionï¼Œä» iMessage Extension åˆ° SiriKit ä¸­æä¾›çš„  Intent Extension ç­‰ï¼Œé‚£å¯¹äº UserNotification æ¥è®²å°±æ˜¯ä¸‹é¢è¿™ä¸¤ç§ Extensionï¼š&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/18D62919-DA73-4D3D-9B05-6071E6945764-1.png&#34; alt=&#34;18D62919-DA73-4D3D-9B05-6071E6945764&#34; /&gt;&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Service Extension&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;å…·ä½“è€Œè¨€ï¼Œå°±æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨æ”¶åˆ°é€šçŸ¥ä¹‹åï¼Œåœ¨å±•ç¤ºç»™ç”¨æˆ·ä¹‹å‰ ï¼Œä¹Ÿå°±æ˜¯ä»¥Banner æˆ–è€… Alert çš„å½¢å¼ æˆ–è€… è¿›å…¥é€šçŸ¥ä¸­å¿ƒä¹‹å‰ï¼Œç»™æˆ‘ä»¬ä¸€æ¬¡æˆªå–å¹¶å¤„ç†çš„æœºä¼šï¼Œè¿™æ ·å°±ç»™å¼€å‘è€…æä¾›äº†é’ˆå¯¹æ¨é€é€šçŸ¥å†åŠ å·¥çš„æ‰‹æ®µï¼Œå¹¶ä¸”è¿œç¨‹æ¨é€å¤šåª’ä½“ä¹Ÿæ˜¯é€šè¿‡ Service Extension æ¥å®ç°çš„ã€‚&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;ä½¿ç”¨åœ¨æœ¬æœºæˆªå–æ¨é€å¹¶æ›¿æ¢å†…å®¹çš„æ–¹å¼ï¼Œå¯ä»¥å®Œæˆç«¯åˆ°ç«¯ (end-to-end) çš„æ¨é€åŠ å¯†ã€‚ä½ åœ¨æœåŠ¡å™¨æ¨é€ payload ä¸­åŠ å…¥åŠ å¯†è¿‡çš„æ–‡æœ¬ï¼Œåœ¨å®¢æˆ·ç«¯æ¥åˆ°é€šçŸ¥åä½¿ç”¨é¢„å…ˆå®šä¹‰æˆ–è€…è·å–è¿‡çš„å¯†é’¥è¿›è¡Œè§£å¯†ä¹‹åå†æ˜¾ç¤ºã€‚è¿™æ ·ä¸€æ¥ï¼Œå³ä½¿æ¨é€ä¿¡é“è¢«ç¬¬ä¸‰æ–¹æˆªå–ï¼Œå…¶ä¸­æ‰€ä¼ é€’çš„å†…å®¹ä¹Ÿè¿˜æ˜¯å®‰å…¨çš„ã€‚ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å‘é€å¯†ç æˆ–è€…æ•æ„Ÿä¿¡æ¯ï¼Œå¯¹äºä¸€äº›é‡‘èä¸šåŠ¡åº”ç”¨å’ŒèŠå¤©åº”ç”¨æ¥è¯´ï¼Œåº”è¯¥æ˜¯å¿…å¤‡çš„ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;ç”Ÿæˆ Extension ä¹‹åï¼Œç³»ç»Ÿå·²ç»ä¸ºæˆ‘ä»¬æä¾›äº†æ¨¡æ¿ï¼Œä»£ç å¦‚ä¸‹ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;class NotificationService: UNNotificationServiceExtension {

    var contentHandler: ((UNNotificationContent) -&amp;gt; Void)?
    var bestAttemptContent: UNMutableNotificationContent?
    
    // 1
    override func didReceive(_ request: UNNotificationRequest, withContentHandler contentHandler: @escaping (UNNotificationContent) -&amp;gt; Void) {
        self.contentHandler = contentHandler
        bestAttemptContent = (request.content.mutableCopy() as? UNMutableNotificationContent)
        
        if let bestAttemptContent = bestAttemptContent {
            contentHandler(bestAttemptContent)
        }
    }
    
    // 2
    override func serviceExtensionTimeWillExpire() {
        // Called just before the extension will be terminated by the system.
        // Use this as an opportunity to deliver your &amp;quot;best attempt&amp;quot; at modified content, otherwise the original push payload will be used.
        if let contentHandler = contentHandler, let bestAttemptContent =  bestAttemptContent {
            contentHandler(bestAttemptContent)
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;ol&gt;
&lt;li&gt;Content Extension
iOS 10 SDK æ–°åŠ çš„å¦ä¸€ä¸ª Content Extension å¯ä»¥ç”¨æ¥è‡ªå®šä¹‰é€šçŸ¥çš„è¯¦ç»†é¡µé¢çš„è§†å›¾ã€‚ ä¸‹å›¾ä¸­å°±æ˜¯å‡ æ¬¾å¸‚é¢ä¸Šç›®å‰å·²ç»å®ç°è¿‡è‡ªå®šä¹‰ Content Extension çš„ App æˆªå›¾ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼š&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;ç¬¬ä¸€ä¸ª PriceTag App çš„é€šçŸ¥æ ·å¼ï¼Œå®é™…ä¸Šæ˜¯é»˜è®¤çš„ç³»ç»Ÿæ˜¾ç¤ºè¡Œä¸ºã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/IMG_AD4882D0ECDE-1.jpeg&#34; alt=&#34;IMG_AD4882D0ECDE-1&#34; /&gt;&lt;/p&gt;

&lt;p&gt;å…¶ä¸­éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ã€‚å¦‚æœä¸æƒ³é»˜è®¤æ˜¾ç¤ºé€šçŸ¥å†…å®¹ï¼Œéœ€è¦åœ¨ Content Extension çš„ info.plist æ–‡ä»¶ä¸­æ·»åŠ  UNNotificationExtensionDefaultContentHidden  å¹¶è®¾ç½®ä¸º YES&lt;/p&gt;

&lt;h4 id=&#34;æ”¯æŒå¤šåª’ä½“èµ„æºåœ¨é€šçŸ¥ä¸­å¿ƒçš„å±•ç¤º&#34;&gt;æ”¯æŒå¤šåª’ä½“èµ„æºåœ¨é€šçŸ¥ä¸­å¿ƒçš„å±•ç¤º&lt;/h4&gt;

&lt;p&gt;iOS 10 ä¸­å¦ä¸€ä¸ªæ¯”è¾ƒæ˜¾è‘—çš„ç‰¹ç‚¹å°±æ˜¯æ”¯æŒäº†å¤šåª’ä½“çš„æ¨é€å’Œå±•ç¤ºã€‚å¼€å‘è€…ç°åœ¨å¯ä»¥åœ¨é€šçŸ¥ä¸­åµŒå…¥å›¾ç‰‡ã€éŸ³é¢‘ç”šè‡³è§†é¢‘ï¼Œè¿™æå¤§ä¸°å¯Œäº†æ¨é€å†…å®¹çš„å¯è¯»æ€§å’Œè¶£å‘³æ€§ã€‚&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;æœ¬åœ°æ¨é€æ”¯æŒ
æœ¬åœ°é€šçŸ¥æ·»åŠ å¤šåª’ä½“æ¯”è¾ƒç®€å•ä¸€äº›ï¼Œåªéœ€è¦é€šè¿‡æœ¬åœ°ç£ç›˜ä¸Šçš„æ–‡ä»¶ URL åˆ›å»ºä¸€ä¸ª UNNotificationAttachment å¯¹è±¡ï¼Œç„¶åå°†è¿™ä¸ªå¯¹è±¡æ”¾åˆ°æ•°ç»„ä¸­èµ‹å€¼ç»™ content çš„ attachments å±æ€§å°±è¡Œäº†ï¼š&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-Swift&#34;&gt;let content = UNMutableNotificationContent()
content.title = &amp;quot;Image Notification&amp;quot;
content.body = &amp;quot;Show me an image!&amp;quot;

if let imageURL = Bundle.main.url(forResource: &amp;quot;image&amp;quot;, withExtension: &amp;quot;jpg&amp;quot;),
let attachment = try? UNNotificationAttachment(identifier: &amp;quot;imageAttachment&amp;quot;, url: imageURL, options: nil) {
content.attachments = [attachment]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;è¿œç¨‹æ¨é€æ”¯æŒ&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;é¦–å…ˆéœ€è¦åœ¨ payloads ç»“æ„ä¸­æ·»åŠ å¯¹å¯Œåª’ä½“çš„æ”¯æŒï¼Œaps å­—å…¸ä¸­æ·»åŠ å­—æ®µ&lt;code&gt;mutable-content&lt;/code&gt;å¹¶ç½®ä¸º 1 æ¥æ ‡è¯†è¯¥è¿œç¨‹é€šçŸ¥æ˜¯éœ€è¦æ”¯æŒã€‚ ç„¶åå¯ä»¥åœ¨ payloads ä¸­æ·»åŠ èµ„æºåœ°å€ï¼Œå¯ä»¥æ˜¯æœ¬åœ°çš„èµ„æºï¼Œä¹Ÿå¯ä»¥æ˜¯éœ€è¦ App ä¸‹è½½çš„ã€‚&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-JSON&#34;&gt;{
  &amp;quot;aps&amp;quot;:{
    &amp;quot;alert&amp;quot;:{
      &amp;quot;title&amp;quot;:&amp;quot;Image Notification&amp;quot;,
      &amp;quot;body&amp;quot;:&amp;quot;Show me an image from web!&amp;quot;
    },
    &amp;quot;mutable-content&amp;quot;:1
  },
  &amp;quot;zh_image&amp;quot;: &amp;quot;https://pic1.zhimg.com/v2-0314056e4f13141b6ca2277078ec067c.jpg&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;å…·ä½“æ”¯æŒå¤šåª’ä½“æ–‡ä»¶çš„å¯Œåª’ä½“ç±»å‹ä»¥åŠæ¯ä¸€ç§ç±»å‹æ‰€æ”¯æŒçš„å¤§å°è¯¦å®˜æ–¹æ–‡æ¡£  &lt;a href=&#34;https://developer.apple.com/reference/usernotifications/unnotificationattachment&#34;&gt;UNNotificationAttachment&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ä¸€æ—¦è¿œç¨‹æ¨é€åœ¨ aps ä¸­æ·»åŠ  mutable-content çš„key å¹¶è®¾ç½®ä¸º 1 ä¹‹åï¼ŒiOS ç³»ç»Ÿæ¥æ”¶åˆ°è¯¥æ¨é€ä¹‹åå°±ä¼šå”¤èµ·æˆ‘ä»¬é…å¥—çš„ Service Extension æ¥åšè¿›ä¸€æ­¥å¤„ç†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å…¶ä¸­ä¸‹è½½å¯¹åº” zh_image é“¾æ¥çš„å›¾ç‰‡ï¼Œç„¶åç”Ÿæˆ Attachment å†ä¸¢ç»™ç³»ç»Ÿå¤„ç†å³å¯ã€‚ è¯¦ç»†åšæ³•å°±æ˜¯åœ¨ä¸Šä¸€èŠ‚è®² Service Extension ä¸­çš„ &lt;code&gt;didReceive&lt;/code&gt; ä¸­å†™ç›¸åº”é€»è¾‘å³å¯ï¼Œå…·ä½“ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š&lt;/p&gt;

&lt;p&gt;å½“ç„¶ï¼Œè¿™é‡Œçš„å¤„ç†æ—¶é—´æ˜¯å­˜åœ¨æ—¶é—´é™åˆ¶çš„ï¼Œå¦‚æœå¤„ç†è¶…æ—¶ç³»ç»Ÿå°±ä¼šå›æ”¶è¯¥ Extensionï¼Œå¹¶ä¸”è°ƒç”¨ &lt;code&gt;serviceExtensionTimeWillExpire&lt;/code&gt; æ–¹æ³•ï¼Œå› æ­¤æ¯ä¸ªäººæ”¶åˆ°å¸¦æœ‰é™„ä»¶çš„æ¨é€ä¹‹åä¸ä¸€å®šå±•ç¤ºç›¸åŒï¼Œä¾‹å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æƒ…å†µï¼Œç¬¬ä¸€å¼ å’Œç¬¬äºŒå¼ å°±å±äºæ­£å¸¸è®¾ç½®äº†é™„ä»¶çš„æƒ…å†µï¼Œè€Œç¬¬ä¸‰å¼ å°±æ˜¯æ²¡æœ‰åœ¨æœ‰é™æ—¶é—´å†…æ­£ç¡®è®¾ç½®é™„ä»¶çš„æƒ…å†µã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/14953507334611.png&#34; alt=&#34;æœªæˆåŠŸè®¾ç½®é™„ä»¶çš„æƒ…å†µ&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;æ¨é€è¯ä¹¦çš„é…ç½®&#34;&gt;æ¨é€è¯ä¹¦çš„é…ç½®&lt;/h4&gt;

&lt;p&gt;ä¸‹å›¾æ˜¯è·å–æ¨é€é€šçŸ¥è¯ä¹¦å¹¶å°†å…¶æ³¨å†Œåˆ° Leancloud çš„æµç¨‹ï¼Œæœ€å…³é”®çš„åœ°æ–¹å…¶å®å°±æ˜¯éœ€è¦åœ¨æœ¬æœºç”Ÿæˆ CSR æ–‡ä»¶æäº¤åˆ° Apple Developer Website ç”Ÿæˆ Push Certification æ–‡ä»¶ã€‚&lt;/p&gt;

&lt;p&gt;ä¸»è¦æœ‰å‡ ä¸ªæ­¥éª¤ï¼š&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;AppID å…³äº Remote Push çš„ æ³¨å†Œ&lt;/li&gt;
&lt;li&gt;ç”Ÿæˆæ¨é€è¯ä¹¦&lt;/li&gt;
&lt;li&gt;è½¬æ¢è¯ä¹¦ä¸º P12 æ–‡ä»¶ï¼Œå¹¶æä¾›ç»™ Leancloud&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/02.png&#34; alt=&#34;02&#34; /&gt;&lt;/p&gt;

&lt;p&gt;XCode 8 çš„ Auto Signing å·²ç»çœå»äº†éš¾ä»¥åçŠ¶çš„å¤æ‚ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€ç‚¹å°äº‹æƒ…æˆ‘ä»¬éœ€è¦åšã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/iOS App IDs - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.01.22.png&#34; alt=&#34;iOS App IDs - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.01.22&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/0CB09A98-0D9B-4E76-BA7C-9A1766CFEC42.png&#34; alt=&#34;0CB09A98-0D9B-4E76-BA7C-9A1766CFE&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/Add - iOS Certificates - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.07.47.png&#34; alt=&#34;Add - iOS Certificates - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.07.47&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æˆ‘ä»¬éœ€è¦ç”Ÿæˆ CSR æ–‡ä»¶ ï¼ŒæŒ‰ç…§æŒ‡å®šæ­¥éª¤æŒ‰éƒ¨å°±ç­æ¥å°±è¡Œï¼Œæœ€åä¼šç”Ÿæˆ é»˜è®¤æ–‡ä»¶ &lt;em&gt;CertificateSigningRequest.certSigningRequest&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/Finder Finder, ä»Šå¤© at ä¸‹åˆ4.59.55.png&#34; alt=&#34;Finder Finder, ä»Šå¤© at ä¸‹åˆ4.59.55&#34; /&gt;
&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/è¯ä¹¦åŠ©ç† è¯ä¹¦åŠ©ç†, ä»Šå¤© at ä¸‹åˆ5.05.42.png&#34; alt=&#34;è¯ä¹¦åŠ©ç† è¯ä¹¦åŠ©ç†, ä»Šå¤© at ä¸‹åˆ5.05.42&#34; /&gt;&lt;/p&gt;

&lt;p&gt;æ¥ç€ä¹‹å‰çš„æ­¥éª¤ï¼Œé€‰æ‹© CSR æ–‡ä»¶ä¸Šä¼ ã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/Add - iOS Certificates - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.09.07.png&#34; alt=&#34;Add - iOS Certificates - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.09.07&#34; /&gt;&lt;/p&gt;

&lt;p&gt;ä¸Šä¼ æˆåŠŸä¹‹åå°±ä¼šç”Ÿæˆ Push è¯ä¹¦ï¼Œä¸‹è½½åˆ°æœ¬æœºå®‰è£…ä¸Šã€‚&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://7xilk1.com1.z0.glb.clouddn.com/Add - iOS Certificates - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.09.58.png&#34; alt=&#34;Add - iOS Certificates - Apple Developer Google Chrome, ä»Šå¤© at ä¸‹åˆ5.09.58&#34; /&gt;&lt;/p&gt;

&lt;h4 id=&#34;demo-æ¼”ç¤º-knuff-https-github-com-knuffapp-knuff&#34;&gt;Demo æ¼”ç¤º  &lt;a href=&#34;https://github.com/KnuffApp/Knuff&#34;&gt;Knuff&lt;/a&gt;&lt;/h4&gt;

&lt;p&gt;å‚è€ƒèµ„æ–™&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/library/content/documentation/NetworkingInternet/Conceptual/RemoteNotificationsPG/index.html#//apple_ref/doc/uid/TP40008194-CH3-SW1&#34;&gt;Local and Remote Notification Programming Guide&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://developer.apple.com/reference/usernotifications&#34;&gt;UserNotifications å®˜æ–¹æ–‡æ¡£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://wereadteam.github.io/2017/03/13/Signature/&#34;&gt;iOS App ç­¾åçš„åŸç†&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://medium.com/@scomper/æ¢ç©¶-iphone-çš„åå°åˆ·æ–°-a7a96cb426d4&#34;&gt;iPhone çš„åå°åˆ·æ–°&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
      
    </item>
    
  </channel>
</rss>